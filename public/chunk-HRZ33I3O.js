import{d as jd}from"./chunk-IINB6WE4.js";import{$ as yt,A as Id,B as ga,Ca as kd,Cb as Vd,E as Fn,Eb as Ia,F as Bn,Fb as Ud,G as zr,Gb as Fd,Hb as Bd,I as ma,Ib as qd,J as qn,Jb as $d,K as wd,Kb as wa,Lb as Ea,M as os,N as Lt,O as _a,P as Ed,Q as Td,Sb as cs,U as Ad,V as et,W as bd,X as fe,Y as Me,Ya as Ue,Za as Nd,_ as oe,a as M,aa as Sd,ab as Od,b as xe,ba as Ie,bb as xd,ca as ya,cb as Md,d as xt,da as Vt,e as y,ea as U,f as pd,fa as pe,g as gd,h as ca,i as ua,ia as Rd,j as la,ja as vt,k as on,ka as Cd,l as We,la as Pd,lb as Ld,m as md,n as _d,o as Mt,oa as as,p as ha,pa as an,q as da,qa as Dd,r as fa,s as Je,t as F,ta as va,u as jr,v as yd,va as tt,w as vd,x as ee,y as pa,ya as Gr,z as He}from"./chunk-3QBVEAUN.js";var B="primary",oi=Symbol("RouteTitle"),Ra=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Wn(n){return new Ra(n)}function l_(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let a=r[s],u=n[s];if(a.startsWith(":"))i[a.substring(1)]=u;else if(a!==u.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function h_(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!nt(n[t],e[t]))return!1;return!0}function nt(n,e){let t=n?Ca(n):void 0,r=e?Ca(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!Qd(n[i],e[i]))return!1;return!0}function Ca(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function Qd(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function Jd(n){return n.length>0?n[n.length-1]:null}function Bt(n){return yd(n)?n:Bd(n)?Je(Promise.resolve(n)):F(n)}var d_={exact:Xd,subset:Zd},Yd={exact:f_,subset:p_,ignored:()=>!0};function zd(n,e,t){return d_[t.paths](n.root,e.root,t.matrixParams)&&Yd[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function f_(n,e){return nt(n,e)}function Xd(n,e,t){if(!un(n.segments,e.segments)||!hs(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!Xd(n.children[r],e.children[r],t))return!1;return!0}function p_(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Qd(n[t],e[t]))}function Zd(n,e,t){return ef(n,e,e.segments,t)}function ef(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!un(i,t)||e.hasChildren()||!hs(i,t,r))}else if(n.segments.length===t.length){if(!un(n.segments,t)||!hs(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!Zd(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!un(n.segments,i)||!hs(n.segments,i,r)||!n.children[B]?!1:ef(n.children[B],e,s,r)}}function hs(n,e,t){return e.every((r,i)=>Yd[t](n[i].parameters,r.parameters))}var Ut=class{constructor(e=new J([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Wn(this.queryParams),this._queryParamMap}toString(){return __.serialize(this)}},J=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ds(this)}},cn=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Wn(this.parameters),this._parameterMap}toString(){return nf(this)}};function g_(n,e){return un(n,e)&&n.every((t,r)=>nt(t.parameters,e[r].parameters))}function un(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function m_(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===B&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==B&&(t=t.concat(e(i,r)))}),t}var ec=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:()=>new ps,providedIn:"root"});let n=e;return n})(),ps=class{parse(e){let t=new Da(e);return new Ut(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Wr(e.root,!0)}`,r=I_(e.queryParams),i=typeof e.fragment=="string"?`#${y_(e.fragment)}`:"";return`${t}${r}${i}`}},__=new ps;function ds(n){return n.segments.map(e=>nf(e)).join("/")}function Wr(n,e){if(!n.hasChildren())return ds(n);if(e){let t=n.children[B]?Wr(n.children[B],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==B&&r.push(`${i}:${Wr(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=m_(n,(r,i)=>i===B?[Wr(n.children[B],!1)]:[`${i}:${Wr(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[B]!=null?`${ds(n)}/${t[0]}`:`${ds(n)}/(${t.join("//")})`}}function tf(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function us(n){return tf(n).replace(/%3B/gi,";")}function y_(n){return encodeURI(n)}function Pa(n){return tf(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function fs(n){return decodeURIComponent(n)}function Gd(n){return fs(n.replace(/\+/g,"%20"))}function nf(n){return`${Pa(n.path)}${v_(n.parameters)}`}function v_(n){return Object.entries(n).map(([e,t])=>`;${Pa(e)}=${Pa(t)}`).join("")}function I_(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${us(t)}=${us(i)}`).join("&"):`${us(t)}=${us(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var w_=/^[^\/()?;#]+/;function Ta(n){let e=n.match(w_);return e?e[0]:""}var E_=/^[^\/()?;=#]+/;function T_(n){let e=n.match(E_);return e?e[0]:""}var A_=/^[^=?&#]+/;function b_(n){let e=n.match(A_);return e?e[0]:""}var S_=/^[^&#]+/;function R_(n){let e=n.match(S_);return e?e[0]:""}var Da=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new J([],{}):new J([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[B]=new J(e,t)),r}parseSegment(){let e=Ta(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new Me(4009,!1);return this.capture(e),new cn(fs(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=T_(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=Ta(this.remaining);i&&(r=i,this.capture(r))}e[fs(t)]=fs(r)}parseQueryParam(e){let t=b_(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let a=R_(this.remaining);a&&(r=a,this.capture(r))}let i=Gd(t),s=Gd(r);if(e.hasOwnProperty(i)){let a=e[i];Array.isArray(a)||(a=[a],e[i]=a),a.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Ta(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new Me(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=B);let a=this.parseChildren();t[s]=Object.keys(a).length===1?a[B]:new J([],a),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new Me(4011,!1)}};function rf(n){return n.segments.length>0?new J([],{[B]:n}):n}function sf(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=sf(i);if(r===B&&s.segments.length===0&&s.hasChildren())for(let[a,u]of Object.entries(s.children))e[a]=u;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new J(n.segments,e);return C_(t)}function C_(n){if(n.numberOfChildren===1&&n.children[B]){let e=n.children[B];return new J(n.segments.concat(e.segments),e.children)}return n}function Hn(n){return n instanceof Ut}function P_(n,e,t=null,r=null){let i=of(n);return af(i,e,t,r)}function of(n){let e;function t(s){let a={};for(let h of s.children){let d=t(h);a[h.outlet]=d}let u=new J(s.url,a);return s===n&&(e=u),u}let r=t(n.root),i=rf(r);return e??i}function af(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return Aa(i,i,i,t,r);let s=D_(e);if(s.toRoot())return Aa(i,i,new J([],{}),t,r);let a=k_(s,i,n),u=a.processChildren?Qr(a.segmentGroup,a.index,s.commands):uf(a.segmentGroup,a.index,s.commands);return Aa(i,a.segmentGroup,u,t,r)}function gs(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Xr(n){return typeof n=="object"&&n!=null&&n.outlets}function Aa(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([h,d])=>{s[h]=Array.isArray(d)?d.map(p=>`${p}`):`${d}`});let a;n===e?a=t:a=cf(n,e,t);let u=rf(sf(a));return new Ut(u,s,i)}function cf(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=cf(s,e,t)}),new J(n.segments,r)}var ms=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&gs(r[0]))throw new Me(4003,!1);let i=r.find(Xr);if(i&&i!==Jd(r))throw new Me(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function D_(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new ms(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,a)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let u={};return Object.entries(s.outlets).forEach(([h,d])=>{u[h]=typeof d=="string"?d.split("/"):d}),[...i,{outlets:u}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:a===0?(s.split("/").forEach((u,h)=>{h==0&&u==="."||(h==0&&u===""?t=!0:u===".."?e++:u!=""&&i.push(u))}),i):[...i,s]},[]);return new ms(t,e,r)}var zn=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function k_(n,e,t){if(n.isAbsolute)return new zn(e,!0,0);if(!t)return new zn(e,!1,NaN);if(t.parent===null)return new zn(t,!0,0);let r=gs(n.commands[0])?0:1,i=t.segments.length-1+r;return N_(t,i,n.numberOfDoubleDots)}function N_(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new Me(4005,!1);i=r.segments.length}return new zn(r,!1,i-s)}function O_(n){return Xr(n[0])?n[0].outlets:{[B]:n}}function uf(n,e,t){if(n??=new J([],{}),n.segments.length===0&&n.hasChildren())return Qr(n,e,t);let r=x_(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new J(n.segments.slice(0,r.pathIndex),{});return s.children[B]=new J(n.segments.slice(r.pathIndex),n.children),Qr(s,0,i)}else return r.match&&i.length===0?new J(n.segments,{}):r.match&&!n.hasChildren()?ka(n,e,t):r.match?Qr(n,0,i):ka(n,e,t)}function Qr(n,e,t){if(t.length===0)return new J(n.segments,{});{let r=O_(t),i={};if(Object.keys(r).some(s=>s!==B)&&n.children[B]&&n.numberOfChildren===1&&n.children[B].segments.length===0){let s=Qr(n.children[B],e,t);return new J(n.segments,s.children)}return Object.entries(r).forEach(([s,a])=>{typeof a=="string"&&(a=[a]),a!==null&&(i[s]=uf(n.children[s],e,a))}),Object.entries(n.children).forEach(([s,a])=>{r[s]===void 0&&(i[s]=a)}),new J(n.segments,i)}}function x_(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let a=n.segments[i],u=t[r];if(Xr(u))break;let h=`${u}`,d=r<t.length-1?t[r+1]:null;if(i>0&&h===void 0)break;if(h&&d&&typeof d=="object"&&d.outlets===void 0){if(!Hd(h,d,a))return s;r+=2}else{if(!Hd(h,{},a))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function ka(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(Xr(s)){let h=M_(s.outlets);return new J(r,h)}if(i===0&&gs(t[0])){let h=n.segments[e];r.push(new cn(h.path,Wd(t[0]))),i++;continue}let a=Xr(s)?s.outlets[B]:`${s}`,u=i<t.length-1?t[i+1]:null;a&&u&&gs(u)?(r.push(new cn(a,Wd(u))),i+=2):(r.push(new cn(a,{})),i++)}return new J(r,{})}function M_(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=ka(new J([],{}),0,r))}),e}function Wd(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function Hd(n,e,t){return n==t.path&&nt(e,t.parameters)}var Jr="imperative",we=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(we||{}),Ke=class{constructor(e,t){this.id=e,this.url=t}},Zr=class extends Ke{constructor(e,t,r="imperative",i=null){super(e,t),this.type=we.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},ln=class extends Ke{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=we.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},je=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(je||{}),Na=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Na||{}),Ft=class extends Ke{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=we.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},hn=class extends Ke{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=we.NavigationSkipped}},ei=class extends Ke{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=we.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},_s=class extends Ke{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=we.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Oa=class extends Ke{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=we.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},xa=class extends Ke{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=we.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Ma=class extends Ke{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=we.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},La=class extends Ke{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=we.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Va=class{constructor(e){this.route=e,this.type=we.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Ua=class{constructor(e){this.route=e,this.type=we.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Fa=class{constructor(e){this.snapshot=e,this.type=we.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ba=class{constructor(e){this.snapshot=e,this.type=we.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},qa=class{constructor(e){this.snapshot=e,this.type=we.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},$a=class{constructor(e){this.snapshot=e,this.type=we.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var ti=class{},ni=class{constructor(e){this.url=e}};var ja=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Ts,this.attachRef=null}},Ts=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new ja,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),ys=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=za(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=za(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Ga(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Ga(e,this._root).map(t=>t.value)}};function za(n,e){if(n===e.value)return e;for(let t of e.children){let r=za(n,t);if(r)return r}return null}function Ga(n,e){if(n===e.value)return[e];for(let t of e.children){let r=Ga(n,t);if(r.length)return r.unshift(e),r}return[]}var $e=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function jn(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var vs=class extends ys{constructor(e,t){super(e),this.snapshot=t,nc(this,e)}toString(){return this.snapshot.toString()}};function lf(n){let e=L_(n),t=new We([new cn("",{})]),r=new We({}),i=new We({}),s=new We({}),a=new We(""),u=new Kn(t,r,s,a,i,B,n,e.root);return u.snapshot=e.root,new vs(new $e(u,[]),e)}function L_(n){let e={},t={},r={},i="",s=new ri([],e,r,i,t,B,n,null,{});return new Is("",new $e(s,[]))}var Kn=class{constructor(e,t,r,i,s,a,u,h){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=a,this.component=u,this._futureSnapshot=h,this.title=this.dataSubject?.pipe(ee(d=>d[oi]))??F(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(ee(e=>Wn(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(ee(e=>Wn(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function tc(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:M(M({},e.params),n.params),data:M(M({},e.data),n.data),resolve:M(M(M(M({},n.data),e.data),i?.data),n._resolvedData)}:r={params:M({},n.params),data:M({},n.data),resolve:M(M({},n.data),n._resolvedData??{})},i&&df(i)&&(r.resolve[oi]=i.title),r}var ri=class{get title(){return this.data?.[oi]}constructor(e,t,r,i,s,a,u,h,d){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=a,this.component=u,this.routeConfig=h,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Wn(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Wn(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Is=class extends ys{constructor(e,t){super(t),this.url=e,nc(this,t)}toString(){return hf(this._root)}};function nc(n,e){e.value._routerState=n,e.children.forEach(t=>nc(n,t))}function hf(n){let e=n.children.length>0?` { ${n.children.map(hf).join(", ")} } `:"";return`${n.value}${e}`}function ba(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,nt(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),nt(e.params,t.params)||n.paramsSubject.next(t.params),h_(e.url,t.url)||n.urlSubject.next(t.url),nt(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Wa(n,e){let t=nt(n.params,e.params)&&g_(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||Wa(n.parent,e.parent))}function df(n){return typeof n.title=="string"||n.title===null}var V_=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=B,this.activateEvents=new Gr,this.deactivateEvents=new Gr,this.attachEvents=new Gr,this.detachEvents=new Gr,this.parentContexts=U(Ts),this.location=U(Nd),this.changeDetector=U(Ea),this.environmentInjector=U(as),this.inputBinder=U(rc,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Me(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Me(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Me(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new Me(4013,!1);this._activatedRoute=r;let s=this.location,u=r.snapshot.component,h=this.parentContexts.getOrCreateContext(this.name).children,d=new Ha(r,h,s.injector);this.activated=s.createComponent(u,{index:s.length,injector:d,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Cd({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Dd]});let n=e;return n})(),Ha=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===Kn?this.route:e===Ts?this.childContexts:this.parent.get(e,t)}},rc=new Ie("");function U_(n,e,t){let r=ii(n,e._root,t?t._root:void 0);return new vs(r,e)}function ii(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=F_(n,e,t);return new $e(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let a=s.route;return a.value._futureSnapshot=e.value,a.children=e.children.map(u=>ii(n,u)),a}}let r=B_(e.value),i=e.children.map(s=>ii(n,s));return new $e(r,i)}}function F_(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return ii(n,r,i);return ii(n,r)})}function B_(n){return new Kn(new We(n.url),new We(n.params),new We(n.queryParams),new We(n.fragment),new We(n.data),n.outlet,n.component,n)}var ff="ngNavigationCancelingError";function pf(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Hn(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=gf(!1,je.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function gf(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[ff]=!0,t.cancellationCode=e,t}function q_(n){return mf(n)&&Hn(n.url)}function mf(n){return!!n&&n[ff]}var $_=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Rd({type:e,selectors:[["ng-component"]],standalone:!0,features:[Vd],decls:1,vars:0,template:function(i,s){i&1&&Ld(0,"router-outlet")},dependencies:[V_],encapsulation:2});let n=e;return n})();function j_(n,e){return n.providers&&!n._injector&&(n._injector=xd(n.providers,e,`Route: ${n.path}`)),n._injector??e}function ic(n){let e=n.children&&n.children.map(ic),t=e?xe(M({},n),{children:e}):M({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==B&&(t.component=$_),t}function rt(n){return n.outlet||B}function z_(n,e){let t=n.filter(r=>rt(r)===e);return t.push(...n.filter(r=>rt(r)!==e)),t}function ai(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var G_=(n,e,t,r)=>ee(i=>(new Ka(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),Ka=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),ba(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=jn(t);e.children.forEach(s=>{let a=s.value.outlet;this.deactivateRoutes(s,i[a],r),delete i[a]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let a=r.getContext(i.outlet);a&&this.deactivateChildRoutes(e,t,a.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=jn(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,i);if(r&&r.outlet){let a=r.outlet.detach(),u=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:a,route:e,contexts:u})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=jn(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=jn(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new $a(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Ba(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(ba(i),i===s)if(i.component){let a=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,a.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let a=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let u=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),a.children.onOutletReAttached(u.contexts),a.attachRef=u.componentRef,a.route=u.route.value,a.outlet&&a.outlet.attach(u.componentRef,u.route.value),ba(u.route.value),this.activateChildRoutes(e,null,a.children)}else{let u=ai(i.snapshot);a.attachRef=null,a.route=i,a.injector=u,a.outlet&&a.outlet.activateWith(i,a.injector),this.activateChildRoutes(e,null,a.children)}}else this.activateChildRoutes(e,null,r)}},ws=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Gn=class{constructor(e,t){this.component=e,this.route=t}};function W_(n,e,t){let r=n._root,i=e?e._root:null;return Hr(r,i,t,[r.value])}function H_(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Jn(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!Sd(n)?n:e.get(n):r}function Hr(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=jn(e);return n.children.forEach(a=>{K_(a,s[a.value.outlet],t,r.concat([a.value]),i),delete s[a.value.outlet]}),Object.entries(s).forEach(([a,u])=>Yr(u,t.getContext(a),i)),i}function K_(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,a=e?e.value:null,u=t?t.getContext(n.value.outlet):null;if(a&&s.routeConfig===a.routeConfig){let h=Q_(a,s,s.routeConfig.runGuardsAndResolvers);h?i.canActivateChecks.push(new ws(r)):(s.data=a.data,s._resolvedData=a._resolvedData),s.component?Hr(n,e,u?u.children:null,r,i):Hr(n,e,t,r,i),h&&u&&u.outlet&&u.outlet.isActivated&&i.canDeactivateChecks.push(new Gn(u.outlet.component,a))}else a&&Yr(e,u,i),i.canActivateChecks.push(new ws(r)),s.component?Hr(n,null,u?u.children:null,r,i):Hr(n,null,t,r,i);return i}function Q_(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!un(n.url,e.url);case"pathParamsOrQueryParamsChange":return!un(n.url,e.url)||!nt(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Wa(n,e)||!nt(n.queryParams,e.queryParams);case"paramsChange":default:return!Wa(n,e)}}function Yr(n,e,t){let r=jn(n),i=n.value;Object.entries(r).forEach(([s,a])=>{i.component?e?Yr(a,e.children.getContext(s),t):Yr(a,null,t):Yr(a,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Gn(e.outlet.component,i)):t.canDeactivateChecks.push(new Gn(null,i)):t.canDeactivateChecks.push(new Gn(null,i))}function ci(n){return typeof n=="function"}function J_(n){return typeof n=="boolean"}function Y_(n){return n&&ci(n.canLoad)}function X_(n){return n&&ci(n.canActivate)}function Z_(n){return n&&ci(n.canActivateChild)}function ey(n){return n&&ci(n.canDeactivate)}function ty(n){return n&&ci(n.canMatch)}function _f(n){return n instanceof vd||n?.name==="EmptyError"}var ls=Symbol("INITIAL_VALUE");function Qn(){return et(n=>pa(n.map(e=>e.pipe(qn(1),Ad(ls)))).pipe(ee(e=>{for(let t of e)if(t!==!0){if(t===ls)return ls;if(t===!1||t instanceof Ut)return t}return!0}),Fn(e=>e!==ls),qn(1)))}function ny(n,e){return He(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:a}}=t;return a.length===0&&s.length===0?F(xe(M({},t),{guardsResult:!0})):ry(a,r,i,n).pipe(He(u=>u&&J_(u)?iy(r,s,n,e):F(u)),ee(u=>xe(M({},t),{guardsResult:u})))})}function ry(n,e,t,r){return Je(n).pipe(He(i=>uy(i.component,i.route,t,e,r)),Lt(i=>i!==!0,!0))}function iy(n,e,t,r){return Je(e).pipe(zr(i=>Id(oy(i.route.parent,r),sy(i.route,r),cy(n,i.path,t),ay(n,i.route,t))),Lt(i=>i!==!0,!0))}function sy(n,e){return n!==null&&e&&e(new qa(n)),F(!0)}function oy(n,e){return n!==null&&e&&e(new Fa(n)),F(!0)}function ay(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return F(!0);let i=r.map(s=>ga(()=>{let a=ai(e)??t,u=Jn(s,a),h=X_(u)?u.canActivate(e,n):an(a,()=>u(e,n));return Bt(h).pipe(Lt())}));return F(i).pipe(Qn())}function cy(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(a=>H_(a)).filter(a=>a!==null).map(a=>ga(()=>{let u=a.guards.map(h=>{let d=ai(a.node)??t,p=Jn(h,d),E=Z_(p)?p.canActivateChild(r,n):an(d,()=>p(r,n));return Bt(E).pipe(Lt())});return F(u).pipe(Qn())}));return F(s).pipe(Qn())}function uy(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return F(!0);let a=s.map(u=>{let h=ai(e)??i,d=Jn(u,h),p=ey(d)?d.canDeactivate(n,e,t,r):an(h,()=>d(n,e,t,r));return Bt(p).pipe(Lt())});return F(a).pipe(Qn())}function ly(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return F(!0);let s=i.map(a=>{let u=Jn(a,n),h=Y_(u)?u.canLoad(e,t):an(n,()=>u(e,t));return Bt(h)});return F(s).pipe(Qn(),yf(r))}function yf(n){return gd(fe(e=>{if(Hn(e))throw pf(n,e)}),ee(e=>e===!0))}function hy(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return F(!0);let s=i.map(a=>{let u=Jn(a,n),h=ty(u)?u.canMatch(e,t):an(n,()=>u(e,t));return Bt(h)});return F(s).pipe(Qn(),yf(r))}var si=class{constructor(e){this.segmentGroup=e||null}},Es=class extends Error{constructor(e){super(),this.urlTree=e}};function $n(n){return jr(new si(n))}function dy(n){return jr(new Me(4e3,!1))}function fy(n){return jr(gf(!1,je.GuardRejected))}var Qa=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return F(r);if(i.numberOfChildren>1||!i.children[B])return dy(e.redirectTo);i=i.children[B]}}applyRedirectCommands(e,t,r){let i=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t.startsWith("/"))throw new Es(i);return i}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new Ut(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let u=s.substring(1);r[i]=t[u]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),a={};return Object.entries(t.children).forEach(([u,h])=>{a[u]=this.createSegmentGroup(e,h,r,i)}),new J(s,a)}createSegments(e,t,r,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new Me(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},Ja={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function py(n,e,t,r,i){let s=sc(n,e,t);return s.matched?(r=j_(e,r),hy(r,e,t,i).pipe(ee(a=>a===!0?s:M({},Ja)))):F(s)}function sc(n,e,t){if(e.path==="**")return gy(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?M({},Ja):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||l_)(t,n,e);if(!i)return M({},Ja);let s={};Object.entries(i.posParams??{}).forEach(([u,h])=>{s[u]=h.path});let a=i.consumed.length>0?M(M({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:a,positionalParamSegments:i.posParams??{}}}function gy(n){return{matched:!0,parameters:n.length>0?Jd(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function Kd(n,e,t,r){return t.length>0&&yy(n,t,r)?{segmentGroup:new J(e,_y(r,new J(t,n.children))),slicedSegments:[]}:t.length===0&&vy(n,t,r)?{segmentGroup:new J(n.segments,my(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new J(n.segments,n.children),slicedSegments:t}}function my(n,e,t,r){let i={};for(let s of t)if(As(n,e,s)&&!r[rt(s)]){let a=new J([],{});i[rt(s)]=a}return M(M({},r),i)}function _y(n,e){let t={};t[B]=e;for(let r of n)if(r.path===""&&rt(r)!==B){let i=new J([],{});t[rt(r)]=i}return t}function yy(n,e,t){return t.some(r=>As(n,e,r)&&rt(r)!==B)}function vy(n,e,t){return t.some(r=>As(n,e,r))}function As(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function Iy(n,e,t,r){return rt(n)!==r&&(r===B||!As(e,t,n))?!1:sc(e,n,t).matched}function wy(n,e,t){return e.length===0&&!n.children[t]}var Ya=class{};function Ey(n,e,t,r,i,s,a="emptyOnly"){return new Xa(n,e,t,r,i,a,s).recognize()}var Ty=31,Xa=class{constructor(e,t,r,i,s,a,u){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=a,this.urlSerializer=u,this.applyRedirects=new Qa(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new Me(4002,`'${e.segmentGroup}'`)}recognize(){let e=Kd(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(ee(t=>{let r=new ri([],Object.freeze({}),Object.freeze(M({},this.urlTree.queryParams)),this.urlTree.fragment,{},B,this.rootComponentType,null,{}),i=new $e(r,t),s=new Is("",i),a=P_(r,[],this.urlTree.queryParams,this.urlTree.fragment);return a.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(a),this.inheritParamsAndData(s._root,null),{state:s,tree:a}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,B).pipe(Bn(r=>{if(r instanceof Es)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof si?this.noMatchError(r):r}))}inheritParamsAndData(e,t){let r=e.value,i=tc(r,t,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,t,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i,!0).pipe(ee(s=>s instanceof $e?[s]:[]))}processChildren(e,t,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return Je(i).pipe(zr(s=>{let a=r.children[s],u=z_(t,s);return this.processSegmentGroup(e,u,a,s)}),Td((s,a)=>(s.push(...a),s)),ma(null),Ed(),He(s=>{if(s===null)return $n(r);let a=vf(s);return Ay(a),F(a)}))}processSegment(e,t,r,i,s,a){return Je(t).pipe(zr(u=>this.processSegmentAgainstRoute(u._injector??e,t,u,r,i,s,a).pipe(Bn(h=>{if(h instanceof si)return F(null);throw h}))),Lt(u=>!!u),Bn(u=>{if(_f(u))return wy(r,i,s)?F(new Ya):$n(r);throw u}))}processSegmentAgainstRoute(e,t,r,i,s,a,u){return Iy(r,i,s,a)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,a):this.allowRedirects&&u?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,a):$n(i):$n(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,a){let{matched:u,consumedSegments:h,positionalParamSegments:d,remainingSegments:p}=sc(t,i,s);if(!u)return $n(t);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Ty&&(this.allowRedirects=!1));let E=this.applyRedirects.applyRedirectCommands(h,i.redirectTo,d);return this.applyRedirects.lineralizeSegments(i,E).pipe(He(b=>this.processSegment(e,r,t,b.concat(p),a,!1)))}matchSegmentAgainstRoute(e,t,r,i,s){let a=py(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),a.pipe(et(u=>u.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(et(({routes:h})=>{let d=r._loadedInjector??e,{consumedSegments:p,remainingSegments:E,parameters:b}=u,R=new ri(p,b,Object.freeze(M({},this.urlTree.queryParams)),this.urlTree.fragment,Sy(r),rt(r),r.component??r._loadedComponent??null,r,Ry(r)),{segmentGroup:k,slicedSegments:x}=Kd(t,p,E,h);if(x.length===0&&k.hasChildren())return this.processChildren(d,h,k).pipe(ee(q=>q===null?null:new $e(R,q)));if(h.length===0&&x.length===0)return F(new $e(R,[]));let N=rt(r)===s;return this.processSegment(d,h,k,x,N?B:s,!0).pipe(ee(q=>new $e(R,q instanceof $e?[q]:[])))}))):$n(t)))}getChildConfig(e,t,r){return t.children?F({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?F({routes:t._loadedRoutes,injector:t._loadedInjector}):ly(e,t,r,this.urlSerializer).pipe(He(i=>i?this.configLoader.loadChildren(e,t).pipe(fe(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):fy(t))):F({routes:[],injector:e})}};function Ay(n){n.sort((e,t)=>e.value.outlet===B?-1:t.value.outlet===B?1:e.value.outlet.localeCompare(t.value.outlet))}function by(n){let e=n.value.routeConfig;return e&&e.path===""}function vf(n){let e=[],t=new Set;for(let r of n){if(!by(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=vf(r.children);e.push(new $e(r.value,i))}return e.filter(r=>!t.has(r))}function Sy(n){return n.data||{}}function Ry(n){return n.resolve||{}}function Cy(n,e,t,r,i,s){return He(a=>Ey(n,e,t,r,a.extractedUrl,i,s).pipe(ee(({state:u,tree:h})=>xe(M({},a),{targetSnapshot:u,urlAfterRedirects:h}))))}function Py(n,e){return He(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return F(t);let s=new Set(i.map(h=>h.route)),a=new Set;for(let h of s)if(!a.has(h))for(let d of If(h))a.add(d);let u=0;return Je(a).pipe(zr(h=>s.has(h)?Dy(h,r,n,e):(h.data=tc(h,h.parent,n).resolve,F(void 0))),fe(()=>u++),_a(1),He(h=>u===a.size?F(t):Mt))})}function If(n){let e=n.children.map(t=>If(t)).flat();return[n,...e]}function Dy(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!df(i)&&(s[oi]=i.title),ky(s,n,e,r).pipe(ee(a=>(n._resolvedData=a,n.data=tc(n,n.parent,t).resolve,null)))}function ky(n,e,t,r){let i=Ca(n);if(i.length===0)return F({});let s={};return Je(i).pipe(He(a=>Ny(n[a],e,t,r).pipe(Lt(),fe(u=>{s[a]=u}))),_a(1),wd(s),Bn(a=>_f(a)?Mt:jr(a)))}function Ny(n,e,t,r){let i=ai(e)??r,s=Jn(n,i),a=s.resolve?s.resolve(e,t):an(i,()=>s(e,t));return Bt(a)}function Sa(n){return et(e=>{let t=n(e);return t?Je(t).pipe(ee(()=>e)):F(e)})}var wf=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(a=>a.outlet===B);return i}getResolvedTitleForRoute(r){return r.data[oi]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:()=>U(Oy),providedIn:"root"});let n=e;return n})(),Oy=(()=>{let e=class e extends wf{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(Vt(jd))},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),oc=new Ie("",{providedIn:"root",factory:()=>({})}),ac=new Ie(""),xy=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=U(wa)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return F(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=Bt(r.loadComponent()).pipe(ee(Ef),fe(a=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=a}),os(()=>{this.componentLoaders.delete(r)})),s=new la(i,()=>new on).pipe(ua());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return F({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let a=My(i,this.compiler,r,this.onLoadEndListener).pipe(os(()=>{this.childrenLoaders.delete(i)})),u=new la(a,()=>new on).pipe(ua());return this.childrenLoaders.set(i,u),u}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function My(n,e,t,r){return Bt(n.loadChildren()).pipe(ee(Ef),He(i=>i instanceof Od||Array.isArray(i)?F(i):Je(e.compileModuleAsync(i))),ee(i=>{r&&r(n);let s,a,u=!1;return Array.isArray(i)?(a=i,u=!0):(s=i.create(t).injector,a=s.get(ac,[],{optional:!0,self:!0}).flat()),{routes:a.map(ic),injector:s}}))}function Ly(n){return n&&typeof n=="object"&&"default"in n}function Ef(n){return Ly(n)?n.default:n}var cc=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:()=>U(Vy),providedIn:"root"});let n=e;return n})(),Vy=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Uy=new Ie("");var Fy=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new on,this.transitionAbortSubject=new on,this.configLoader=U(xy),this.environmentInjector=U(as),this.urlSerializer=U(ec),this.rootContexts=U(Ts),this.location=U(cs),this.inputBindingEnabled=U(rc,{optional:!0})!==null,this.titleStrategy=U(wf),this.options=U(oc,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=U(cc),this.createViewTransition=U(Uy,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>F(void 0),this.rootComponentType=null;let r=s=>this.events.next(new Va(s)),i=s=>this.events.next(new Ua(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(xe(M(M({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new We({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Jr,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Fn(a=>a.id!==0),ee(a=>xe(M({},a),{extractedUrl:this.urlHandlingStrategy.extract(a.rawUrl)})),et(a=>{let u=!1,h=!1;return F(a).pipe(et(d=>{if(this.navigationId>a.id)return this.cancelNavigationTransition(a,"",je.SupersededByNewNavigation),Mt;this.currentTransition=a,this.currentNavigation={id:d.id,initialUrl:d.rawUrl,extractedUrl:d.extractedUrl,trigger:d.source,extras:d.extras,previousNavigation:this.lastSuccessfulNavigation?xe(M({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let p=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),E=d.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!p&&E!=="reload"){let b="";return this.events.next(new hn(d.id,this.urlSerializer.serialize(d.rawUrl),b,Na.IgnoredSameUrlNavigation)),d.resolve(null),Mt}if(this.urlHandlingStrategy.shouldProcessUrl(d.rawUrl))return F(d).pipe(et(b=>{let R=this.transitions?.getValue();return this.events.next(new Zr(b.id,this.urlSerializer.serialize(b.extractedUrl),b.source,b.restoredState)),R!==this.transitions?.getValue()?Mt:Promise.resolve(b)}),Cy(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),fe(b=>{a.targetSnapshot=b.targetSnapshot,a.urlAfterRedirects=b.urlAfterRedirects,this.currentNavigation=xe(M({},this.currentNavigation),{finalUrl:b.urlAfterRedirects});let R=new _s(b.id,this.urlSerializer.serialize(b.extractedUrl),this.urlSerializer.serialize(b.urlAfterRedirects),b.targetSnapshot);this.events.next(R)}));if(p&&this.urlHandlingStrategy.shouldProcessUrl(d.currentRawUrl)){let{id:b,extractedUrl:R,source:k,restoredState:x,extras:N}=d,q=new Zr(b,this.urlSerializer.serialize(R),k,x);this.events.next(q);let j=lf(this.rootComponentType).snapshot;return this.currentTransition=a=xe(M({},d),{targetSnapshot:j,urlAfterRedirects:R,extras:xe(M({},N),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=R,F(a)}else{let b="";return this.events.next(new hn(d.id,this.urlSerializer.serialize(d.extractedUrl),b,Na.IgnoredByUrlHandlingStrategy)),d.resolve(null),Mt}}),fe(d=>{let p=new Oa(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(p)}),ee(d=>(this.currentTransition=a=xe(M({},d),{guards:W_(d.targetSnapshot,d.currentSnapshot,this.rootContexts)}),a)),ny(this.environmentInjector,d=>this.events.next(d)),fe(d=>{if(a.guardsResult=d.guardsResult,Hn(d.guardsResult))throw pf(this.urlSerializer,d.guardsResult);let p=new xa(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot,!!d.guardsResult);this.events.next(p)}),Fn(d=>d.guardsResult?!0:(this.cancelNavigationTransition(d,"",je.GuardRejected),!1)),Sa(d=>{if(d.guards.canActivateChecks.length)return F(d).pipe(fe(p=>{let E=new Ma(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(E)}),et(p=>{let E=!1;return F(p).pipe(Py(this.paramsInheritanceStrategy,this.environmentInjector),fe({next:()=>E=!0,complete:()=>{E||this.cancelNavigationTransition(p,"",je.NoDataFromResolver)}}))}),fe(p=>{let E=new La(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(E)}))}),Sa(d=>{let p=E=>{let b=[];E.routeConfig?.loadComponent&&!E.routeConfig._loadedComponent&&b.push(this.configLoader.loadComponent(E.routeConfig).pipe(fe(R=>{E.component=R}),ee(()=>{})));for(let R of E.children)b.push(...p(R));return b};return pa(p(d.targetSnapshot.root)).pipe(ma(null),qn(1))}),Sa(()=>this.afterPreactivation()),et(()=>{let{currentSnapshot:d,targetSnapshot:p}=a,E=this.createViewTransition?.(this.environmentInjector,d.root,p.root);return E?Je(E).pipe(ee(()=>a)):F(a)}),ee(d=>{let p=U_(r.routeReuseStrategy,d.targetSnapshot,d.currentRouterState);return this.currentTransition=a=xe(M({},d),{targetRouterState:p}),this.currentNavigation.targetRouterState=p,a}),fe(()=>{this.events.next(new ti)}),G_(this.rootContexts,r.routeReuseStrategy,d=>this.events.next(d),this.inputBindingEnabled),qn(1),fe({next:d=>{u=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new ln(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects))),this.titleStrategy?.updateTitle(d.targetRouterState.snapshot),d.resolve(!0)},complete:()=>{u=!0}}),bd(this.transitionAbortSubject.pipe(fe(d=>{throw d}))),os(()=>{!u&&!h&&this.cancelNavigationTransition(a,"",je.SupersededByNewNavigation),this.currentTransition?.id===a.id&&(this.currentNavigation=null,this.currentTransition=null)}),Bn(d=>{if(h=!0,mf(d))this.events.next(new Ft(a.id,this.urlSerializer.serialize(a.extractedUrl),d.message,d.cancellationCode)),q_(d)?this.events.next(new ni(d.url)):a.resolve(!1);else{this.events.next(new ei(a.id,this.urlSerializer.serialize(a.extractedUrl),d,a.targetSnapshot??void 0));try{a.resolve(r.errorHandler(d))}catch(p){this.options.resolveNavigationPromiseOnError?a.resolve(!1):a.reject(p)}}return Mt}))}))}cancelNavigationTransition(r,i,s){let a=new Ft(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(a),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function By(n){return n!==Jr}var qy=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:()=>U($y),providedIn:"root"});let n=e;return n})(),Za=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},$y=(()=>{let e=class e extends Za{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=va(e)))(s||e)}})(),e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Tf=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:()=>U(jy),providedIn:"root"});let n=e;return n})(),jy=(()=>{let e=class e extends Tf{constructor(){super(...arguments),this.location=U(cs),this.urlSerializer=U(ec),this.options=U(oc,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=U(cc),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Ut,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=lf(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof Zr)this.stateMemento=this.createStateMemento();else if(r instanceof hn)this.rawUrlTree=i.initialUrl;else if(r instanceof _s){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof ti?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof Ft&&(r.code===je.GuardRejected||r.code===je.NoDataFromResolver)?this.restoreHistory(i):r instanceof ei?this.restoreHistory(i,!0):r instanceof ln&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let a=this.browserPageId,u=M(M({},i.extras.state),this.generateNgRouterState(i.id,a));this.location.replaceState(s,"",u)}else{let a=M(M({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",a)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,a=this.currentPageId-s;a!==0?this.location.historyGo(a):this.currentUrlTree===r.finalUrl&&a===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=va(e)))(s||e)}})(),e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Kr=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(Kr||{});function zy(n,e){n.events.pipe(Fn(t=>t instanceof ln||t instanceof Ft||t instanceof ei||t instanceof hn),ee(t=>t instanceof ln||t instanceof hn?Kr.COMPLETE:(t instanceof Ft?t.code===je.Redirect||t.code===je.SupersededByNewNavigation:!1)?Kr.REDIRECTING:Kr.FAILED),Fn(t=>t!==Kr.REDIRECTING),qn(1)).subscribe(()=>{e()})}function Gy(n){throw n}var Wy={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Hy={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},bs=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=U(Fd),this.stateManager=U(Tf),this.options=U(oc,{optional:!0})||{},this.pendingTasks=U(Md),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=U(Fy),this.urlSerializer=U(ec),this.location=U(cs),this.urlHandlingStrategy=U(cc),this._events=new on,this.errorHandler=this.options.errorHandler||Gy,this.navigated=!1,this.routeReuseStrategy=U(qy),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=U(ac,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!U(rc,{optional:!0}),this.eventsSubscription=new pd,this.isNgZoneEnabled=U(Ue)instanceof Ue&&Ue.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,a=this.navigationTransitions.currentNavigation;if(s!==null&&a!==null){if(this.stateManager.handleRouterEvent(i,a),i instanceof Ft&&i.code!==je.Redirect&&i.code!==je.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof ln)this.navigated=!0;else if(i instanceof ni){let u=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),h={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||By(s.source)};this.scheduleNavigation(u,Jr,null,h,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}Qy(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Jr,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let a={replaceUrl:!0},u=s?.navigationId?s:null;if(s){let d=M({},s);delete d.navigationId,delete d.\u0275routerPageId,Object.keys(d).length!==0&&(a.state=d)}let h=this.parseUrl(r);this.scheduleNavigation(h,i,u,a)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(ic),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:a,fragment:u,queryParamsHandling:h,preserveFragment:d}=i,p=d?this.currentUrlTree.fragment:u,E=null;switch(h){case"merge":E=M(M({},this.currentUrlTree.queryParams),a);break;case"preserve":E=this.currentUrlTree.queryParams;break;default:E=a||null}E!==null&&(E=this.removeEmptyProps(E));let b;try{let R=s?s.snapshot:this.routerState.snapshot.root;b=of(R)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),b=this.currentUrlTree.root}return af(b,r,E,p??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=Hn(r)?r:this.parseUrl(r),a=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(a,Jr,null,i)}navigate(r,i={skipLocationChange:!1}){return Ky(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=M({},Wy):i===!1?s=M({},Hy):s=i,Hn(r))return zd(this.currentUrlTree,r,s);let a=this.parseUrl(r);return zd(this.currentUrlTree,a,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,a])=>(a!=null&&(i[s]=a),i),{})}scheduleNavigation(r,i,s,a,u){if(this.disposed)return Promise.resolve(!1);let h,d,p;u?(h=u.resolve,d=u.reject,p=u.promise):p=new Promise((b,R)=>{h=b,d=R});let E=this.pendingTasks.add();return zy(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(E))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:a,resolve:h,reject:d,promise:p,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),p.catch(b=>Promise.reject(b))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Ky(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new Me(4008,!1)}function Qy(n){return!(n instanceof ti)&&!(n instanceof ni)}var Jy=new Ie("");function qS(n,...e){return Pd([{provide:ac,multi:!0,useValue:n},[],{provide:Kn,useFactory:Yy,deps:[bs]},{provide:qd,multi:!0,useFactory:Xy},e.map(t=>t.\u0275providers)])}function Yy(n){return n.routerState.root}function Xy(){let n=U(tt);return e=>{let t=n.get($d);if(e!==t.components[0])return;let r=n.get(bs),i=n.get(Zy);n.get(ev)===1&&r.initialNavigation(),n.get(tv,null,ya.Optional)?.setUpPreloading(),n.get(Jy,null,ya.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var Zy=new Ie("",{factory:()=>new on}),ev=new Ie("",{providedIn:"root",factory:()=>1});var tv=new Ie("");var Af=(()=>{let e=class e{constructor(){this.router=U(bs)}routerLink(r){return this.router.navigateByUrl(r)}saveInLocalStorage(r,i){return localStorage.setItem(r,JSON.stringify(i))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var Sf=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},nv=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],a=n[t++],u=n[t++],h=((i&7)<<18|(s&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{let s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},Rf={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],a=i+1<n.length,u=a?n[i+1]:0,h=i+2<n.length,d=h?n[i+2]:0,p=s>>2,E=(s&3)<<4|u>>4,b=(u&15)<<2|d>>6,R=d&63;h||(R=64,a||(b=64)),r.push(t[p],t[E],t[b],t[R])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Sf(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):nv(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let E=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||u==null||d==null||E==null)throw new lc;let b=s<<2|u>>4;if(r.push(b),d!==64){let R=u<<4&240|d>>2;if(r.push(R),E!==64){let k=d<<6&192|E;r.push(k)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},lc=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},rv=function(n){let e=Sf(n);return Rf.encodeByteArray(e,!0)},ui=function(n){return rv(n).replace(/\./g,"")},dc=function(n){try{return Rf.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function iv(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var sv=()=>iv().__FIREBASE_DEFAULTS__,ov=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},av=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&dc(n[1]);return e&&JSON.parse(e)},Rs=()=>{try{return sv()||ov()||av()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},fc=n=>{var e,t;return(t=(e=Rs())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Cs=n=>{let e=fc(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},pc=()=>{var n;return(n=Rs())===null||n===void 0?void 0:n.config},gc=n=>{var e;return(e=Rs())===null||e===void 0?void 0:e[`_${n}`]};var Ss=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Ps(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[ui(JSON.stringify(t)),ui(JSON.stringify(a)),""].join(".")}function le(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Cf(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(le())}function cv(){var n;let e=(n=Rs())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Pf(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Df(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function kf(){let n=le();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Nf(){return!cv()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function mc(){try{return typeof indexedDB=="object"}catch{return!1}}function Of(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var uv="FirebaseError",Le=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=uv,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,It.prototype.create)}},It=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?lv(s,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new Le(i,u,r)}};function lv(n,e){return n.replace(hv,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var hv=/\{\$([^}]+)}/g;function xf(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function fn(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],a=e[i];if(bf(s)&&bf(a)){if(!fn(s,a))return!1}else if(s!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function bf(n){return n!==null&&typeof n=="object"}function li(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Yn(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Xn(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function Mf(n,e){let t=new hc(n,e);return t.subscribe.bind(t)}var hc=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");dv(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=uc),i.error===void 0&&(i.error=uc),i.complete===void 0&&(i.complete=uc);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function dv(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function uc(){}var KS=4*60*60*1e3;function Ee(n){return n&&n._delegate?n._delegate:n}var Fe=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var pn="[DEFAULT]";var _c=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Ss;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(pv(e))try{this.getOrInitializeService({instanceIdentifier:pn})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=pn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return y(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=pn){return this.instances.has(e)}getOptions(e=pn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,a]of this.instancesDeferred.entries()){let u=this.normalizeInstanceIdentifier(s);r===u&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:fv(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=pn){return this.component?this.component.multipleInstances?e:pn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function fv(n){return n===pn?void 0:n}function pv(n){return n.instantiationMode==="EAGER"}var Ds=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new _c(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var gv=[],G=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(G||{}),mv={debug:G.DEBUG,verbose:G.VERBOSE,info:G.INFO,warn:G.WARN,error:G.ERROR,silent:G.SILENT},_v=G.INFO,yv={[G.DEBUG]:"log",[G.VERBOSE]:"log",[G.INFO]:"info",[G.WARN]:"warn",[G.ERROR]:"error"},vv=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=yv[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},qt=class{constructor(e){this.name=e,this._logLevel=_v,this._logHandler=vv,this._userLogHandler=null,gv.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in G))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?mv[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,G.DEBUG,...e),this._logHandler(this,G.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,G.VERBOSE,...e),this._logHandler(this,G.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,G.INFO,...e),this._logHandler(this,G.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,G.WARN,...e),this._logHandler(this,G.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,G.ERROR,...e),this._logHandler(this,G.ERROR,...e)}};var Iv=(n,e)=>e.some(t=>n instanceof t),Lf,Vf;function wv(){return Lf||(Lf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ev(){return Vf||(Vf=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Uf=new WeakMap,vc=new WeakMap,Ff=new WeakMap,yc=new WeakMap,wc=new WeakMap;function Tv(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(it(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&Uf.set(t,n)}).catch(()=>{}),wc.set(e,n),e}function Av(n){if(vc.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});vc.set(n,e)}var Ic={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return vc.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Ff.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return it(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Bf(n){Ic=n(Ic)}function bv(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(ks(this),e,...t);return Ff.set(r,e.sort?e.sort():[e]),it(r)}:Ev().includes(n)?function(...e){return n.apply(ks(this),e),it(Uf.get(this))}:function(...e){return it(n.apply(ks(this),e))}}function Sv(n){return typeof n=="function"?bv(n):(n instanceof IDBTransaction&&Av(n),Iv(n,wv())?new Proxy(n,Ic):n)}function it(n){if(n instanceof IDBRequest)return Tv(n);if(yc.has(n))return yc.get(n);let e=Sv(n);return e!==n&&(yc.set(n,e),wc.set(e,n)),e}var ks=n=>wc.get(n);function $f(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let a=indexedDB.open(n,e),u=it(a);return r&&a.addEventListener("upgradeneeded",h=>{r(it(a.result),h.oldVersion,h.newVersion,it(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),u.then(h=>{s&&h.addEventListener("close",()=>s()),i&&h.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}var Rv=["get","getKey","getAll","getAllKeys","count"],Cv=["put","add","delete","clear"],Ec=new Map;function qf(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ec.get(e))return Ec.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=Cv.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Rv.includes(t)))return;let s=function(a,...u){return y(this,null,function*(){let h=this.transaction(a,i?"readwrite":"readonly"),d=h.store;return r&&(d=d.index(u.shift())),(yield Promise.all([d[t](...u),i&&h.done]))[0]})};return Ec.set(e,s),s}Bf(n=>xe(M({},n),{get:(e,t,r)=>qf(e,t)||n.get(e,t,r),has:(e,t)=>!!qf(e,t)||n.has(e,t)}));var Ac=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Pv(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function Pv(n){let e=n.getComponent();return e?.type==="VERSION"}var bc="@firebase/app",jf="0.10.5";var gn=new qt("@firebase/app"),Dv="@firebase/app-compat",kv="@firebase/analytics-compat",Nv="@firebase/analytics",Ov="@firebase/app-check-compat",xv="@firebase/app-check",Mv="@firebase/auth",Lv="@firebase/auth-compat",Vv="@firebase/database",Uv="@firebase/database-compat",Fv="@firebase/functions",Bv="@firebase/functions-compat",qv="@firebase/installations",$v="@firebase/installations-compat",jv="@firebase/messaging",zv="@firebase/messaging-compat",Gv="@firebase/performance",Wv="@firebase/performance-compat",Hv="@firebase/remote-config",Kv="@firebase/remote-config-compat",Qv="@firebase/storage",Jv="@firebase/storage-compat",Yv="@firebase/firestore",Xv="@firebase/vertexai-preview",Zv="@firebase/firestore-compat",eI="firebase",tI="10.12.2";var Sc="[DEFAULT]",nI={[bc]:"fire-core",[Dv]:"fire-core-compat",[Nv]:"fire-analytics",[kv]:"fire-analytics-compat",[xv]:"fire-app-check",[Ov]:"fire-app-check-compat",[Mv]:"fire-auth",[Lv]:"fire-auth-compat",[Vv]:"fire-rtdb",[Uv]:"fire-rtdb-compat",[Fv]:"fire-fn",[Bv]:"fire-fn-compat",[qv]:"fire-iid",[$v]:"fire-iid-compat",[jv]:"fire-fcm",[zv]:"fire-fcm-compat",[Gv]:"fire-perf",[Wv]:"fire-perf-compat",[Hv]:"fire-rc",[Kv]:"fire-rc-compat",[Qv]:"fire-gcs",[Jv]:"fire-gcs-compat",[Yv]:"fire-fst",[Zv]:"fire-fst-compat",[Xv]:"fire-vertex","fire-js":"fire-js",[eI]:"fire-js-all"};var hi=new Map,rI=new Map,Rc=new Map;function zf(n,e){try{n.container.addComponent(e)}catch(t){gn.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function st(n){let e=n.name;if(Rc.has(e))return gn.debug(`There were multiple attempts to register component ${e}.`),!1;Rc.set(e,n);for(let t of hi.values())zf(t,n);for(let t of rI.values())zf(t,n);return!0}function mn(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ye(n){return n.settings!==void 0}var iI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},$t=new It("app","Firebase",iI);var Cc=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Fe("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw $t.create("app-deleted",{appName:this._name})}};var ot=tI;function kc(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:Sc,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw $t.create("bad-app-name",{appName:String(i)});if(t||(t=pc()),!t)throw $t.create("no-options");let s=hi.get(i);if(s){if(fn(t,s.options)&&fn(r,s.config))return s;throw $t.create("duplicate-app",{appName:i})}let a=new Ds(i);for(let h of Rc.values())a.addComponent(h);let u=new Cc(t,r,a);return hi.set(i,u),u}function jt(n=Sc){let e=hi.get(n);if(!e&&n===Sc&&pc())return kc();if(!e)throw $t.create("no-app",{appName:n});return e}function Ns(){return Array.from(hi.values())}function ne(n,e,t){var r;let i=(r=nI[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){let u=[`Unable to register library "${i}" with version "${e}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),gn.warn(u.join(" "));return}st(new Fe(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var sI="firebase-heartbeat-database",oI=1,di="firebase-heartbeat-store",Tc=null;function Kf(){return Tc||(Tc=$f(sI,oI,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(di)}catch(t){console.warn(t)}}}}).catch(n=>{throw $t.create("idb-open",{originalErrorMessage:n.message})})),Tc}function aI(n){return y(this,null,function*(){try{let t=(yield Kf()).transaction(di),r=yield t.objectStore(di).get(Qf(n));return yield t.done,r}catch(e){if(e instanceof Le)gn.warn(e.message);else{let t=$t.create("idb-get",{originalErrorMessage:e?.message});gn.warn(t.message)}}})}function Gf(n,e){return y(this,null,function*(){try{let r=(yield Kf()).transaction(di,"readwrite");yield r.objectStore(di).put(e,Qf(n)),yield r.done}catch(t){if(t instanceof Le)gn.warn(t.message);else{let r=$t.create("idb-set",{originalErrorMessage:t?.message});gn.warn(r.message)}}})}function Qf(n){return`${n.name}!${n.options.appId}`}var cI=1024,uI=30*24*60*60*1e3,Pc=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Dc(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return y(this,null,function*(){var e,t;let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Wf();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{let u=new Date(a.date).valueOf();return Date.now()-u<=uI}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return y(this,null,function*(){var e;if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=Wf(),{heartbeatsToSend:r,unsentEntries:i}=lI(this._heartbeatsCache.heartbeats),s=ui(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s})}};function Wf(){return new Date().toISOString().substring(0,10)}function lI(n,e=cI){let t=[],r=n.slice();for(let i of n){let s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),Hf(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Hf(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Dc=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return y(this,null,function*(){return mc()?Of().then(()=>!0).catch(()=>!1):!1})}read(){return y(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield aI(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Gf(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Gf(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function Hf(n){return ui(JSON.stringify({version:2,heartbeats:n})).length}function hI(n){st(new Fe("platform-logger",e=>new Ac(e),"PRIVATE")),st(new Fe("heartbeat",e=>new Pc(e),"PRIVATE")),ne(bc,jf,n),ne(bc,jf,"esm2017"),ne("fire-js","")}hI("");var dI="firebase",fI="10.12.2";ne(dI,fI,"app");var wt=new Ia("ANGULARFIRE2_VERSION");function er(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(a=>a.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var yn=(n,e)=>{let t=e?[e]:Ns(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},zt=class{constructor(){return yn(pI)}},pI="app-check";function Zn(){}var Os=class{zone;delegate;constructor(e,t=_d){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(a){i.runGuarded(()=>{e.apply(this,[a])})};return this.delegate.schedule(s,t,r)}},Nc=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Zn,{},Zn,Zn)),t.pipe(fe({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Gt=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Os(Zone.current)),this.insideAngular=t.run(()=>new Os(Zone.current,md)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(Vt(Ue))};static \u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function xs(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function gI(n){return xs().ngZone.runOutsideAngular(()=>n())}function _n(n){return xs().ngZone.run(()=>n())}function mI(n){return _I(xs())(n)}function _I(n){return function(t){return t=t.lift(new Nc(n.ngZone)),t.pipe(fa(n.outsideAngular),da(n.insideAngular))}}var yI=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),_n(()=>n.apply(void 0,r))},Be=(n,e)=>function(){let t,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(t||=_n(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Zn,{},Zn,Zn))),r[s]=yI(r[s],t));let i=gI(()=>n.apply(this,r));if(!e)if(i instanceof ca){let s=xs();return i.pipe(fa(s.outsideAngular),da(s.insideAngular))}else return _n(()=>i);return i instanceof ca?i.pipe(mI):i instanceof Promise?_n(()=>new Promise((s,a)=>i.then(u=>_n(()=>s(u)),u=>_n(()=>a(u))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:_n(()=>i)};var Xe=class{constructor(e){return e}},Et=class{constructor(){return Ns()}};function vI(n){return n&&n.length===1?n[0]:new Xe(jt())}var Oc=new Ie("angularfire2._apps"),II={provide:Xe,useFactory:vI,deps:[[new pe,Oc]]},wI={provide:Et,deps:[[new pe,Oc]]};function EI(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Xe(r)}}var TI=(()=>{class n{constructor(t){ne("angularfire",wt.full,"core"),ne("angularfire",wt.full,"app"),ne("angular",Ud.full,t.toString())}static \u0275fac=function(r){return new(r||n)(Vt(kd))};static \u0275mod=vt({type:n});static \u0275inj=yt({providers:[II,wI]})}return n})();function NR(n,...e){return{ngModule:TI,providers:[{provide:Oc,useFactory:EI(n),multi:!0,deps:[Ue,tt,Gt,...e]}]}}var OR=Be(kc,!0);function dp(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var fp=dp,pp=new It("auth","Firebase",dp());var Bs=new qt("@firebase/auth");function AI(n,...e){Bs.logLevel<=G.WARN&&Bs.warn(`Auth (${ot}): ${n}`,...e)}function Ls(n,...e){Bs.logLevel<=G.ERROR&&Bs.error(`Auth (${ot}): ${n}`,...e)}function ct(n,...e){throw nu(n,...e)}function vn(n,...e){return nu(n,...e)}function gp(n,e,t){let r=Object.assign(Object.assign({},fp()),{[e]:t});return new It("auth","Firebase",r).create(e,{appName:n.name})}function bt(n){return gp(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function nu(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return pp.create(n,...e)}function L(n,e,...t){if(!n)throw nu(e,...t)}function Tt(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Ls(e),new Error(e)}function Ht(n,e){n||Tt(e)}function Vc(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function bI(){return Jf()==="http:"||Jf()==="https:"}function Jf(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function SI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(bI()||Pf()||"connection"in navigator)?navigator.onLine:!0}function RI(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var In=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ht(t>e,"Short delay should be less than long delay!"),this.isMobile=Cf()||Df()}get(){return SI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function ru(n,e){Ht(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var qs=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Tt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Tt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Tt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var CI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var PI=new In(3e4,6e4);function Kt(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function Qt(s,a,u,h){return y(this,arguments,function*(n,e,t,r,i={}){return mp(n,i,()=>y(this,null,function*(){let d={},p={};r&&(e==="GET"?p=r:d={body:JSON.stringify(r)});let E=li(Object.assign({key:n.config.apiKey},p)).slice(1),b=yield n._getAdditionalHeaders();return b["Content-Type"]="application/json",n.languageCode&&(b["X-Firebase-Locale"]=n.languageCode),qs.fetch()(_p(n,n.config.apiHost,t,E),Object.assign({method:e,headers:b,referrerPolicy:"no-referrer"},d))}))})}function mp(n,e,t){return y(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},CI),e);try{let i=new Uc(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield s.json();if("needConfirmation"in a)throw Ms(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{let u=s.ok?a.errorMessage:a.error.message,[h,d]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ms(n,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw Ms(n,"email-already-in-use",a);if(h==="USER_DISABLED")throw Ms(n,"user-disabled",a);let p=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw gp(n,p,d);ct(n,p)}}catch(i){if(i instanceof Le)throw i;ct(n,"network-request-failed",{message:String(i)})}})}function Ii(s,a,u,h){return y(this,arguments,function*(n,e,t,r,i={}){let d=yield Qt(n,e,t,r,i);return"mfaPendingCredential"in d&&ct(n,"multi-factor-auth-required",{_serverResponse:d}),d})}function _p(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?ru(n.config,i):`${n.config.apiScheme}://${i}`}function DI(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var Uc=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(vn(this.auth,"network-request-failed")),PI.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Ms(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=vn(n,e,r);return i.customData._tokenResponse=t,i}function Yf(n){return n!==void 0&&n.enterprise!==void 0}var Fc=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return DI(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}};function kI(n,e){return y(this,null,function*(){return Qt(n,"GET","/v2/recaptchaConfig",Kt(n,e))})}function NI(n,e){return y(this,null,function*(){return Qt(n,"POST","/v1/accounts:delete",e)})}function yp(n,e){return y(this,null,function*(){return Qt(n,"POST","/v1/accounts:lookup",e)})}function fi(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function iu(n,e=!1){return y(this,null,function*(){let t=Ee(n),r=yield t.getIdToken(e),i=su(r);L(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:fi(xc(i.auth_time)),issuedAtTime:fi(xc(i.iat)),expirationTime:fi(xc(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function xc(n){return Number(n)*1e3}function su(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Ls("JWT malformed, contained fewer than 3 sections"),null;try{let i=dc(t);return i?JSON.parse(i):(Ls("Failed to decode base64 JWT payload"),null)}catch(i){return Ls("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Xf(n){let e=su(n);return L(e,"internal-error"),L(typeof e.exp<"u","internal-error"),L(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function gi(n,e,t=!1){return y(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof Le&&OI(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function OI({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Bc=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>y(this,null,function*(){yield this.iteration()}),t)}iteration(){return y(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var mi=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=fi(this.lastLoginAt),this.creationTime=fi(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function $s(n){return y(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield gi(n,yp(t,{idToken:r}));L(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?vp(s.providerUserInfo):[],u=xI(n.providerData,a),h=n.isAnonymous,d=!(n.email&&s.passwordHash)&&!u?.length,p=h?d:!1,E={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:u,metadata:new mi(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,E)})}function ou(n){return y(this,null,function*(){let e=Ee(n);yield $s(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function xI(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function vp(n){return n.map(e=>{var{providerId:t}=e,r=ha(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function MI(n,e){return y(this,null,function*(){let t=yield mp(n,{},()=>y(this,null,function*(){let r=li({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=_p(n,i,"/v1/token",`key=${s}`),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",qs.fetch()(a,{method:"POST",headers:u,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function LI(n,e){return y(this,null,function*(){return Qt(n,"POST","/v2/accounts:revokeToken",Kt(n,e))})}var pi=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){L(e.idToken,"internal-error"),L(typeof e.idToken<"u","internal-error"),L(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Xf(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){L(e.length!==0,"internal-error");let t=Xf(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return y(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(L(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return y(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield MI(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new n;return r&&(L(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(L(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(L(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Tt("not implemented")}};function Wt(n,e){L(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var tr=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=ha(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Bc(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new mi(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return y(this,null,function*(){let t=yield gi(this,this.stsTokenManager.getToken(this.auth,e));return L(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return iu(this,e)}reload(){return ou(this)}_assign(e){this!==e&&(L(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){L(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return y(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield $s(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return y(this,null,function*(){if(Ye(this.auth.app))return Promise.reject(bt(this.auth));let e=yield this.getIdToken();return yield gi(this,NI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,a,u,h,d,p;let E=(r=t.displayName)!==null&&r!==void 0?r:void 0,b=(i=t.email)!==null&&i!==void 0?i:void 0,R=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,k=(a=t.photoURL)!==null&&a!==void 0?a:void 0,x=(u=t.tenantId)!==null&&u!==void 0?u:void 0,N=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,q=(d=t.createdAt)!==null&&d!==void 0?d:void 0,j=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:z,emailVerified:H,isAnonymous:ke,providerData:re,stsTokenManager:I}=t;L(z&&I,e,"internal-error");let g=pi.fromJSON(this.name,I);L(typeof z=="string",e,"internal-error"),Wt(E,e.name),Wt(b,e.name),L(typeof H=="boolean",e,"internal-error"),L(typeof ke=="boolean",e,"internal-error"),Wt(R,e.name),Wt(k,e.name),Wt(x,e.name),Wt(N,e.name),Wt(q,e.name),Wt(j,e.name);let _=new n({uid:z,auth:e,email:b,emailVerified:H,displayName:E,isAnonymous:ke,photoURL:k,phoneNumber:R,tenantId:x,stsTokenManager:g,createdAt:q,lastLoginAt:j});return re&&Array.isArray(re)&&(_.providerData=re.map(v=>Object.assign({},v))),N&&(_._redirectEventId=N),_}static _fromIdTokenResponse(e,t,r=!1){return y(this,null,function*(){let i=new pi;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield $s(s),s})}static _fromGetAccountInfoResponse(e,t,r){return y(this,null,function*(){let i=t.users[0];L(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?vp(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,u=new pi;u.updateFromIdToken(r);let h=new n({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new mi(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(h,d),h})}};var Zf=new Map;function At(n){Ht(n instanceof Function,"Expected a class definition");let e=Zf.get(n);return e?(Ht(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Zf.set(n,e),e)}var VI=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return y(this,null,function*(){return!0})}_set(t,r){return y(this,null,function*(){this.storage[t]=r})}_get(t){return y(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return y(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),qc=VI;function Vs(n,e,t){return`firebase:${n}:${e}:${t}`}var js=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Vs(this.userKey,i.apiKey,s),this.fullPersistenceKey=Vs("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return y(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?tr._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return y(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return y(this,null,function*(){if(!t.length)return new n(At(qc),e,r);let i=(yield Promise.all(t.map(d=>y(this,null,function*(){if(yield d._isAvailable())return d})))).filter(d=>d),s=i[0]||At(qc),a=Vs(r,e.config.apiKey,e.name),u=null;for(let d of t)try{let p=yield d._get(a);if(p){let E=tr._fromJSON(e,p);d!==s&&(u=E),s=d;break}}catch{}let h=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!h.length?new n(s,e,r):(s=h[0],u&&(yield s._set(a,u.toJSON())),yield Promise.all(t.map(d=>y(this,null,function*(){if(d!==s)try{yield d._remove(a)}catch{}}))),new n(s,e,r))})}};function ep(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ep(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ip(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Ap(e))return"Blackberry";if(bp(e))return"Webos";if(au(e))return"Safari";if((e.includes("chrome/")||wp(e))&&!e.includes("edge/"))return"Chrome";if(Tp(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function Ip(n=le()){return/firefox\//i.test(n)}function au(n=le()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function wp(n=le()){return/crios\//i.test(n)}function Ep(n=le()){return/iemobile/i.test(n)}function Tp(n=le()){return/android/i.test(n)}function Ap(n=le()){return/blackberry/i.test(n)}function bp(n=le()){return/webos/i.test(n)}function Ys(n=le()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function UI(n=le()){var e;return Ys(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function FI(){return kf()&&document.documentMode===10}function Sp(n=le()){return Ys(n)||Tp(n)||bp(n)||Ap(n)||/windows phone/i.test(n)||Ep(n)}function BI(){try{return!!(window&&window!==window.top)}catch{return!1}}function Rp(n,e=[]){let t;switch(n){case"Browser":t=ep(le());break;case"Worker":t=`${ep(le())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ot}/${r}`}var $c=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((a,u)=>{try{let h=e(s);a(h)}catch(h){u(h)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return y(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function qI(t){return y(this,arguments,function*(n,e={}){return Qt(n,"GET","/v2/passwordPolicy",Kt(n,e))})}var $I=6,jc=class{constructor(e){var t,r,i,s;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:$I,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,a,u;let h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(s=h.containsUppercaseLetter)!==null&&s!==void 0?s:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(u=h.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),h}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var zc=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new zs(this),this.idTokenSubscription=new zs(this),this.beforeStateQueue=new $c(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=pp,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=At(t)),this._initializationPromise=this.queue(()=>y(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield js.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return y(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return y(this,null,function*(){try{let t=yield yp(this,{idToken:e}),r=yield tr._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return y(this,null,function*(){var t;if(Ye(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,u=i?._redirectEventId,h=yield this.tryRedirectSignIn(e);(!a||a===u)&&h?.user&&(i=h.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return L(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return y(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return y(this,null,function*(){try{yield $s(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=RI()}_delete(){return y(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return y(this,null,function*(){if(Ye(this.app))return Promise.reject(bt(this));let t=e?Ee(e):null;return t&&L(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return y(this,null,function*(){if(!this._deleted)return e&&L(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>y(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return y(this,null,function*(){return Ye(this.app)?Promise.reject(bt(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Ye(this.app)?Promise.reject(bt(this)):this.queue(()=>y(this,null,function*(){yield this.assertedPersistence.setPersistence(At(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return y(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return y(this,null,function*(){let e=yield qI(this),t=new jc(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new It("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return y(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield LI(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return y(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return y(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&At(e)||this._popupRedirectResolver;L(t,this,"argument-error"),this.redirectPersistenceManager=yield js.create(this,[At(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return y(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>y(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return y(this,null,function*(){if(e===this.currentUser)return this.queue(()=>y(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),a=!1,u=this._isInitialized?Promise.resolve():this._initializationPromise;if(L(u,this,"internal-error"),u.then(()=>{a||s(this.currentUser)}),typeof t=="function"){let h=e.addObserver(t,r,i);return()=>{a=!0,h()}}else{let h=e.addObserver(t);return()=>{a=!0,h()}}}directlySetCurrentUser(e){return y(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return L(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Rp(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return y(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return y(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&AI(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function En(n){return Ee(n)}var zs=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Mf(t=>this.observer=t)}get next(){return L(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Xs={loadJS(){return y(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function jI(n){Xs=n}function Cp(n){return Xs.loadJS(n)}function zI(){return Xs.recaptchaEnterpriseScript}function GI(){return Xs.gapiScript}function Pp(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var WI="recaptcha-enterprise",HI="NO_RECAPTCHA",Gc=class{constructor(e){this.type=WI,this.auth=En(e)}verify(e="verify",t=!1){return y(this,null,function*(){function r(s){return y(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((a,u)=>y(this,null,function*(){kI(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{let d=new Fc(h);return s.tenantId==null?s._agentRecaptchaConfig=d:s._tenantRecaptchaConfigs[s.tenantId]=d,a(d.siteKey)}}).catch(h=>{u(h)})}))})}function i(s,a,u){let h=window.grecaptcha;Yf(h)?h.enterprise.ready(()=>{h.enterprise.execute(s,{action:e}).then(d=>{a(d)}).catch(()=>{a(HI)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{r(this.auth).then(u=>{if(!t&&Yf(window.grecaptcha))i(u,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let h=zI();h.length!==0&&(h+=u),Cp(h).then(()=>{i(u,s,a)}).catch(d=>{a(d)})}}).catch(u=>{a(u)})})})}};function tp(n,e,t,r=!1){return y(this,null,function*(){let i=new Gc(n),s;try{s=yield i.verify(t)}catch{s=yield i.verify(t,!0)}let a=Object.assign({},e);return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a})}function Wc(n,e,t,r){return y(this,null,function*(){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let s=yield tp(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(s=>y(this,null,function*(){if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let a=yield tp(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(s)}))})}function cu(n,e){let t=mn(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(fn(s,e??{}))return i;ct(i,"already-initialized")}return t.initialize({options:e})}function KI(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(At);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function uu(n,e,t){let r=En(n);L(r._canInitEmulator,r,"emulator-config-failed"),L(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=Dp(e),{host:a,port:u}=QI(e),h=u===null?"":`:${u}`;r.config.emulator={url:`${s}//${a}${h}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:u,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||JI()}function Dp(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function QI(n){let e=Dp(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:np(r.substr(s.length+1))}}else{let[s,a]=r.split(":");return{host:s,port:np(a)}}}function np(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function JI(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var _i=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Tt("not implemented")}_getIdTokenResponse(e){return Tt("not implemented")}_linkToIdToken(e,t){return Tt("not implemented")}_getReauthenticationResolver(e){return Tt("not implemented")}};function YI(n,e){return y(this,null,function*(){return Qt(n,"POST","/v1/accounts:signUp",e)})}function XI(n,e){return y(this,null,function*(){return Ii(n,"POST","/v1/accounts:signInWithPassword",Kt(n,e))})}function ZI(n,e){return y(this,null,function*(){return Ii(n,"POST","/v1/accounts:signInWithEmailLink",Kt(n,e))})}function ew(n,e){return y(this,null,function*(){return Ii(n,"POST","/v1/accounts:signInWithEmailLink",Kt(n,e))})}var yi=class n extends _i{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return y(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Wc(e,t,"signInWithPassword",XI);case"emailLink":return ZI(e,{email:this._email,oobCode:this._password});default:ct(e,"internal-error")}})}_linkToIdToken(e,t){return y(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Wc(e,r,"signUpPassword",YI);case"emailLink":return ew(e,{idToken:t,email:this._email,oobCode:this._password});default:ct(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function Mc(n,e){return y(this,null,function*(){return Ii(n,"POST","/v1/accounts:signInWithIdp",Kt(n,e))})}function tw(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function nw(n){let e=Yn(Xn(n)).link,t=e?Yn(Xn(e)).deep_link_id:null,r=Yn(Xn(n)).deep_link_id;return(r?Yn(Xn(r)).link:null)||r||t||e||n}var Gs=class n{constructor(e){var t,r,i,s,a,u;let h=Yn(Xn(e)),d=(t=h.apiKey)!==null&&t!==void 0?t:null,p=(r=h.oobCode)!==null&&r!==void 0?r:null,E=tw((i=h.mode)!==null&&i!==void 0?i:null);L(d&&p&&E,"argument-error"),this.apiKey=d,this.operation=E,this.code=p,this.continueUrl=(s=h.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=h.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(u=h.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){let t=nw(e);try{return new n(t)}catch{return null}}};var kp=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return yi._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=Gs.parseLink(r);return L(i,"argument-error"),yi._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),Ws=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Hc=class extends Ws{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};function rw(n,e){return y(this,null,function*(){return Ii(n,"POST","/v1/accounts:signUp",Kt(n,e))})}var nr=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return y(this,null,function*(){let s=yield tr._fromIdTokenResponse(e,r,i),a=rp(r);return new n({user:s,providerId:a,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return y(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=rp(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function rp(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var Kc=class n extends Le{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function Np(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Kc._fromErrorAndOperation(n,s,e,r):s})}function iw(n,e,t=!1){return y(this,null,function*(){let r=yield gi(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return nr._forOperation(n,"link",r)})}function sw(n,e,t=!1){return y(this,null,function*(){let{auth:r}=n;if(Ye(r.app))return Promise.reject(bt(r));let i="reauthenticate";try{let s=yield gi(n,Np(r,i,e,n),t);L(s.idToken,r,"internal-error");let a=su(s.idToken);L(a,r,"internal-error");let{sub:u}=a;return L(n.uid===u,r,"user-mismatch"),nr._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&ct(r,"user-mismatch"),s}})}function Op(n,e,t=!1){return y(this,null,function*(){if(Ye(n.app))return Promise.reject(bt(n));let r="signIn",i=yield Np(n,r,e),s=yield nr._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function lu(n,e){return y(this,null,function*(){return Op(En(n),e)})}function xp(n){return y(this,null,function*(){let e=En(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function hu(n,e,t){return y(this,null,function*(){if(Ye(n.app))return Promise.reject(bt(n));let r=En(n),a=yield Wc(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",rw).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&xp(n),h}),u=yield nr._fromIdTokenResponse(r,"signIn",a);return yield r._updateCurrentUser(u.user),u})}function du(n,e,t){return Ye(n.app)?Promise.reject(bt(n)):lu(Ee(n),kp.credential(e,t)).catch(r=>y(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&xp(n),r}))}function fu(n,e,t,r){return Ee(n).onIdTokenChanged(e,t,r)}function pu(n,e,t){return Ee(n).beforeAuthStateChanged(e,t)}var Hs="__sak";var Ks=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Hs,"1"),this.storage.removeItem(Hs),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};function ow(){let n=le();return au(n)||Ys(n)}var aw=1e3,cw=10,uw=(()=>{class n extends Ks{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=ow()&&BI(),this.fallbackToPolling=Sp(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((u,h,d)=>{this.notifyListeners(u,d)});return}let i=t.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){let u=this.storage.getItem(i);if(t.newValue!==u)t.newValue!==null?this.storage.setItem(i,t.newValue):this.storage.removeItem(i);else if(this.localCache[i]===t.newValue&&!r)return}let s=()=>{let u=this.storage.getItem(i);!r&&this.localCache[i]===u||this.notifyListeners(i,u)},a=this.storage.getItem(i);FI()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,cw):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},aw)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return y(this,null,function*(){yield xt(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return y(this,null,function*(){let r=yield xt(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return y(this,null,function*(){yield xt(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),Mp=uw;var lw=(()=>{class n extends Ks{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),gu=lw;function hw(n){return Promise.all(n.map(e=>y(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var dw=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return y(this,null,function*(){let r=t,{eventId:i,eventType:s,data:a}=r.data,u=this.handlersMap[s];if(!u?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let h=Array.from(u).map(p=>y(this,null,function*(){return p(r.origin,a)})),d=yield hw(h);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:d})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function Lp(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var Qc=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return y(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((u,h)=>{let d=Lp("",20);i.port1.start();let p=setTimeout(()=>{h(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(E){let b=E;if(b.data.eventId===d)switch(b.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),u(b.data.response);break;default:clearTimeout(p),clearTimeout(s),h(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})})}};function at(){return window}function fw(n){at().location.href=n}function Vp(){return typeof at().WorkerGlobalScope<"u"&&typeof at().importScripts=="function"}function pw(){return y(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function gw(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function mw(){return Vp()?self:null}var Up="firebaseLocalStorageDb",_w=1,Qs="firebaseLocalStorage",Fp="fbase_key",wn=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Zs(n,e){return n.transaction([Qs],e?"readwrite":"readonly").objectStore(Qs)}function yw(){let n=indexedDB.deleteDatabase(Up);return new wn(n).toPromise()}function Jc(){let n=indexedDB.open(Up,_w);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Qs,{keyPath:Fp})}catch(i){t(i)}}),n.addEventListener("success",()=>y(this,null,function*(){let r=n.result;r.objectStoreNames.contains(Qs)?e(r):(r.close(),yield yw(),e(yield Jc()))}))})}function ip(n,e,t){return y(this,null,function*(){let r=Zs(n,!0).put({[Fp]:e,value:t});return new wn(r).toPromise()})}function vw(n,e){return y(this,null,function*(){let t=Zs(n,!1).get(e),r=yield new wn(t).toPromise();return r===void 0?null:r.value})}function sp(n,e){let t=Zs(n,!0).delete(e);return new wn(t).toPromise()}var Iw=800,ww=3,Ew=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return y(this,null,function*(){return this.db?this.db:(this.db=yield Jc(),this.db)})}_withRetries(t){return y(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>ww)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return y(this,null,function*(){return Vp()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return y(this,null,function*(){this.receiver=dw._getInstance(mw()),this.receiver._subscribe("keyChanged",(t,r)=>y(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>y(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return y(this,null,function*(){var t,r;if(this.activeServiceWorker=yield pw(),!this.activeServiceWorker)return;this.sender=new Qc(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return y(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||gw()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return y(this,null,function*(){try{if(!indexedDB)return!1;let t=yield Jc();return yield ip(t,Hs,"1"),yield sp(t,Hs),!0}catch{}return!1})}_withPendingWrite(t){return y(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(i=>ip(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return y(this,null,function*(){let r=yield this._withRetries(i=>vw(i,t));return this.localCache[t]=r,r})}_remove(t){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(r=>sp(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return y(this,null,function*(){let t=yield this._withRetries(s=>{let a=Zs(s,!1).getAll();return new wn(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:a}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>y(this,null,function*(){return this._poll()}),Iw)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),Bp=Ew;var qR=Pp("rcb"),$R=new In(3e4,6e4);function Tw(n,e){return e?At(e):(L(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var vi=class extends _i{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Mc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Mc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Mc(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function Aw(n){return Op(n.auth,new vi(n),n.bypassAuthState)}function bw(n){let{auth:e,user:t}=n;return L(t,e,"internal-error"),sw(t,new vi(n),n.bypassAuthState)}function Sw(n){return y(this,null,function*(){let{auth:e,user:t}=n;return L(t,e,"internal-error"),iw(t,new vi(n),n.bypassAuthState)})}var Yc=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>y(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return y(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:u}=e;if(a){this.reject(a);return}let h={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(u)(h))}catch(d){this.reject(d)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Aw;case"linkViaPopup":case"linkViaRedirect":return Sw;case"reauthViaPopup":case"reauthViaRedirect":return bw;default:ct(this.auth,"internal-error")}}resolve(e){Ht(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ht(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var jR=new In(2e3,1e4);var Rw="pendingRedirect",Us=new Map,Xc=class n extends Yc{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return y(this,null,function*(){let e=Us.get(this.auth._key());if(!e){try{let r=(yield Cw(this.resolver,this.auth))?yield xt(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Us.set(this.auth._key(),e)}return this.bypassAuthState||Us.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return y(this,null,function*(){if(e.type==="signInViaRedirect")return xt(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,xt(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return y(this,null,function*(){})}cleanUp(){}};function Cw(n,e){return y(this,null,function*(){let t=kw(e),r=Dw(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function Pw(n,e){Us.set(n._key(),e)}function Dw(n){return At(n._redirectPersistence)}function kw(n){return Vs(Rw,n.config.apiKey,n.name)}function Nw(n,e,t=!1){return y(this,null,function*(){if(Ye(n.app))return Promise.reject(bt(n));let r=En(n),i=Tw(r,e),a=yield new Xc(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,yield r._persistUserIfCurrent(a.user),yield r._setRedirectUser(null,e)),a})}var Ow=10*60*1e3,Zc=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!xw(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!qp(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(vn(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Ow&&this.cachedEventUids.clear(),this.cachedEventUids.has(op(e))}saveEventToCache(e){this.cachedEventUids.add(op(e)),this.lastProcessedEventTime=Date.now()}};function op(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function qp({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function xw(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return qp(n);default:return!1}}function Mw(t){return y(this,arguments,function*(n,e={}){return Qt(n,"GET","/v1/projects",e)})}var Lw=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Vw=/^https?/;function Uw(n){return y(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield Mw(n);for(let t of e)try{if(Fw(t))return}catch{}ct(n,"unauthorized-domain")})}function Fw(n){let e=Vc(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!Vw.test(t))return!1;if(Lw.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var Bw=new In(3e4,6e4);function ap(){let n=at().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function qw(n){return new Promise((e,t)=>{var r,i,s;function a(){ap(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ap(),t(vn(n,"network-request-failed"))},timeout:Bw.get()})}if(!((i=(r=at().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=at().gapi)===null||s===void 0)&&s.load)a();else{let u=Pp("iframefcb");return at()[u]=()=>{gapi.load?a():t(vn(n,"network-request-failed"))},Cp(`${GI()}?onload=${u}`).catch(h=>t(h))}}).catch(e=>{throw Fs=null,e})}var Fs=null;function $w(n){return Fs=Fs||qw(n),Fs}var jw=new In(5e3,15e3),zw="__/auth/iframe",Gw="emulator/auth/iframe",Ww={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Hw=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Kw(n){let e=n.config;L(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?ru(e,Gw):`https://${n.config.authDomain}/${zw}`,r={apiKey:e.apiKey,appName:n.name,v:ot},i=Hw.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${li(r).slice(1)}`}function Qw(n){return y(this,null,function*(){let e=yield $w(n),t=at().gapi;return L(t,n,"internal-error"),e.open({where:document.body,url:Kw(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Ww,dontclear:!0},r=>new Promise((i,s)=>y(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let a=vn(n,"network-request-failed"),u=at().setTimeout(()=>{s(a)},jw.get());function h(){at().clearTimeout(u),i(r)}r.ping(h).then(h,()=>{s(a)})})))})}var Jw={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Yw=500,Xw=600,Zw="_blank",eE="http://localhost",Js=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function tE(n,e,t,r=Yw,i=Xw){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString(),u="",h=Object.assign(Object.assign({},Jw),{width:r.toString(),height:i.toString(),top:s,left:a}),d=le().toLowerCase();t&&(u=wp(d)?Zw:t),Ip(d)&&(e=e||eE,h.scrollbars="yes");let p=Object.entries(h).reduce((b,[R,k])=>`${b}${R}=${k},`,"");if(UI(d)&&u!=="_self")return nE(e||"",u),new Js(null);let E=window.open(e||"",u,p);L(E,n,"popup-blocked");try{E.focus()}catch{}return new Js(E)}function nE(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var rE="__/auth/handler",iE="emulator/auth/handler",sE=encodeURIComponent("fac");function cp(n,e,t,r,i,s){return y(this,null,function*(){L(n.config.authDomain,n,"auth-domain-config-required"),L(n.config.apiKey,n,"invalid-api-key");let a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:ot,eventId:i};if(e instanceof Ws){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",xf(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(let[p,E]of Object.entries(s||{}))a[p]=E}if(e instanceof Hc){let p=e.getScopes().filter(E=>E!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);let u=a;for(let p of Object.keys(u))u[p]===void 0&&delete u[p];let h=yield n._getAppCheckToken(),d=h?`#${sE}=${encodeURIComponent(h)}`:"";return`${oE(n)}?${li(u).slice(1)}${d}`})}function oE({config:n}){return n.emulator?ru(n,iE):`https://${n.authDomain}/${rE}`}var Lc="webStorageSupport",eu=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=gu,this._completeRedirectFn=Nw,this._overrideRedirectResult=Pw}_openPopup(e,t,r,i){return y(this,null,function*(){var s;Ht((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let a=yield cp(e,t,r,Vc(),i);return tE(e,a,Lp())})}_openRedirect(e,t,r,i){return y(this,null,function*(){yield this._originValidation(e);let s=yield cp(e,t,r,Vc(),i);return fw(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Ht(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return y(this,null,function*(){let t=yield Qw(e),r=new Zc(e);return t.register("authEvent",i=>(L(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Lc,{type:Lc},i=>{var s;let a=(s=i?.[0])===null||s===void 0?void 0:s[Lc];a!==void 0&&t(!!a),ct(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Uw(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Sp()||au()||Ys()}},$p=eu;var up="@firebase/auth",lp="1.7.4";var tu=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return y(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){L(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function aE(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function cE(n){st(new Fe("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;L(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let h={apiKey:a,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Rp(n)},d=new zc(r,i,s,h);return KI(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),st(new Fe("auth-internal",e=>{let t=En(e.getProvider("auth").getImmediate());return(r=>new tu(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ne(up,lp,aE(n)),ne(up,lp,"esm2017")}var uE=5*60,lE=gc("authIdTokenMaxAge")||uE,hp=null,hE=n=>e=>y(void 0,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>lE)return;let i=t?.token;hp!==i&&(hp=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function mu(n=jt()){let e=mn(n,"auth");if(e.isInitialized())return e.getImmediate();let t=cu(n,{popupRedirectResolver:$p,persistence:[Bp,Mp,gu]}),r=gc("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let a=hE(s.toString());pu(t,a,()=>a(t.currentUser)),fu(t,u=>a(u))}}let i=fc("auth");return i&&uu(t,`http://${i}`),t}function dE(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}jI({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=vn("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",dE().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});cE("Browser");var jp="auth",Tn=class{constructor(e){return e}},An=class{constructor(){return yn(jp)}};var _u=new Ie("angularfire2.auth-instances");function rT(n,e){let t=er(jp,n,e);return t&&new Tn(t)}function iT(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Tn(r)}}var sT={provide:An,deps:[[new pe,_u]]},oT={provide:Tn,useFactory:rT,deps:[[new pe,_u],Xe]},aT=(()=>{class n{constructor(){ne("angularfire",wt.full,"auth")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=vt({type:n});static \u0275inj=yt({providers:[oT,sT]})}return n})();function S0(n,...e){return{ngModule:aT,providers:[{provide:_u,useFactory:iT(n),multi:!0,deps:[Ue,tt,Gt,Et,[new pe,zt],...e]}]}}var zp=Be(hu,!0);var wi=Be(mu,!0);var Gp=Be(du,!0);var Wp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Hp={};var yu,Kp;(function(){var n;function e(I,g){function _(){}_.prototype=g.prototype,I.D=g.prototype,I.prototype=new _,I.prototype.constructor=I,I.C=function(v,w,A){for(var m=Array(arguments.length-2),gt=2;gt<arguments.length;gt++)m[gt-2]=arguments[gt];return g.prototype[w].apply(v,m)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,g,_){_||(_=0);var v=Array(16);if(typeof g=="string")for(var w=0;16>w;++w)v[w]=g.charCodeAt(_++)|g.charCodeAt(_++)<<8|g.charCodeAt(_++)<<16|g.charCodeAt(_++)<<24;else for(w=0;16>w;++w)v[w]=g[_++]|g[_++]<<8|g[_++]<<16|g[_++]<<24;g=I.g[0],_=I.g[1],w=I.g[2];var A=I.g[3],m=g+(A^_&(w^A))+v[0]+3614090360&4294967295;g=_+(m<<7&4294967295|m>>>25),m=A+(w^g&(_^w))+v[1]+3905402710&4294967295,A=g+(m<<12&4294967295|m>>>20),m=w+(_^A&(g^_))+v[2]+606105819&4294967295,w=A+(m<<17&4294967295|m>>>15),m=_+(g^w&(A^g))+v[3]+3250441966&4294967295,_=w+(m<<22&4294967295|m>>>10),m=g+(A^_&(w^A))+v[4]+4118548399&4294967295,g=_+(m<<7&4294967295|m>>>25),m=A+(w^g&(_^w))+v[5]+1200080426&4294967295,A=g+(m<<12&4294967295|m>>>20),m=w+(_^A&(g^_))+v[6]+2821735955&4294967295,w=A+(m<<17&4294967295|m>>>15),m=_+(g^w&(A^g))+v[7]+4249261313&4294967295,_=w+(m<<22&4294967295|m>>>10),m=g+(A^_&(w^A))+v[8]+1770035416&4294967295,g=_+(m<<7&4294967295|m>>>25),m=A+(w^g&(_^w))+v[9]+2336552879&4294967295,A=g+(m<<12&4294967295|m>>>20),m=w+(_^A&(g^_))+v[10]+4294925233&4294967295,w=A+(m<<17&4294967295|m>>>15),m=_+(g^w&(A^g))+v[11]+2304563134&4294967295,_=w+(m<<22&4294967295|m>>>10),m=g+(A^_&(w^A))+v[12]+1804603682&4294967295,g=_+(m<<7&4294967295|m>>>25),m=A+(w^g&(_^w))+v[13]+4254626195&4294967295,A=g+(m<<12&4294967295|m>>>20),m=w+(_^A&(g^_))+v[14]+2792965006&4294967295,w=A+(m<<17&4294967295|m>>>15),m=_+(g^w&(A^g))+v[15]+1236535329&4294967295,_=w+(m<<22&4294967295|m>>>10),m=g+(w^A&(_^w))+v[1]+4129170786&4294967295,g=_+(m<<5&4294967295|m>>>27),m=A+(_^w&(g^_))+v[6]+3225465664&4294967295,A=g+(m<<9&4294967295|m>>>23),m=w+(g^_&(A^g))+v[11]+643717713&4294967295,w=A+(m<<14&4294967295|m>>>18),m=_+(A^g&(w^A))+v[0]+3921069994&4294967295,_=w+(m<<20&4294967295|m>>>12),m=g+(w^A&(_^w))+v[5]+3593408605&4294967295,g=_+(m<<5&4294967295|m>>>27),m=A+(_^w&(g^_))+v[10]+38016083&4294967295,A=g+(m<<9&4294967295|m>>>23),m=w+(g^_&(A^g))+v[15]+3634488961&4294967295,w=A+(m<<14&4294967295|m>>>18),m=_+(A^g&(w^A))+v[4]+3889429448&4294967295,_=w+(m<<20&4294967295|m>>>12),m=g+(w^A&(_^w))+v[9]+568446438&4294967295,g=_+(m<<5&4294967295|m>>>27),m=A+(_^w&(g^_))+v[14]+3275163606&4294967295,A=g+(m<<9&4294967295|m>>>23),m=w+(g^_&(A^g))+v[3]+4107603335&4294967295,w=A+(m<<14&4294967295|m>>>18),m=_+(A^g&(w^A))+v[8]+1163531501&4294967295,_=w+(m<<20&4294967295|m>>>12),m=g+(w^A&(_^w))+v[13]+2850285829&4294967295,g=_+(m<<5&4294967295|m>>>27),m=A+(_^w&(g^_))+v[2]+4243563512&4294967295,A=g+(m<<9&4294967295|m>>>23),m=w+(g^_&(A^g))+v[7]+1735328473&4294967295,w=A+(m<<14&4294967295|m>>>18),m=_+(A^g&(w^A))+v[12]+2368359562&4294967295,_=w+(m<<20&4294967295|m>>>12),m=g+(_^w^A)+v[5]+4294588738&4294967295,g=_+(m<<4&4294967295|m>>>28),m=A+(g^_^w)+v[8]+2272392833&4294967295,A=g+(m<<11&4294967295|m>>>21),m=w+(A^g^_)+v[11]+1839030562&4294967295,w=A+(m<<16&4294967295|m>>>16),m=_+(w^A^g)+v[14]+4259657740&4294967295,_=w+(m<<23&4294967295|m>>>9),m=g+(_^w^A)+v[1]+2763975236&4294967295,g=_+(m<<4&4294967295|m>>>28),m=A+(g^_^w)+v[4]+1272893353&4294967295,A=g+(m<<11&4294967295|m>>>21),m=w+(A^g^_)+v[7]+4139469664&4294967295,w=A+(m<<16&4294967295|m>>>16),m=_+(w^A^g)+v[10]+3200236656&4294967295,_=w+(m<<23&4294967295|m>>>9),m=g+(_^w^A)+v[13]+681279174&4294967295,g=_+(m<<4&4294967295|m>>>28),m=A+(g^_^w)+v[0]+3936430074&4294967295,A=g+(m<<11&4294967295|m>>>21),m=w+(A^g^_)+v[3]+3572445317&4294967295,w=A+(m<<16&4294967295|m>>>16),m=_+(w^A^g)+v[6]+76029189&4294967295,_=w+(m<<23&4294967295|m>>>9),m=g+(_^w^A)+v[9]+3654602809&4294967295,g=_+(m<<4&4294967295|m>>>28),m=A+(g^_^w)+v[12]+3873151461&4294967295,A=g+(m<<11&4294967295|m>>>21),m=w+(A^g^_)+v[15]+530742520&4294967295,w=A+(m<<16&4294967295|m>>>16),m=_+(w^A^g)+v[2]+3299628645&4294967295,_=w+(m<<23&4294967295|m>>>9),m=g+(w^(_|~A))+v[0]+4096336452&4294967295,g=_+(m<<6&4294967295|m>>>26),m=A+(_^(g|~w))+v[7]+1126891415&4294967295,A=g+(m<<10&4294967295|m>>>22),m=w+(g^(A|~_))+v[14]+2878612391&4294967295,w=A+(m<<15&4294967295|m>>>17),m=_+(A^(w|~g))+v[5]+4237533241&4294967295,_=w+(m<<21&4294967295|m>>>11),m=g+(w^(_|~A))+v[12]+1700485571&4294967295,g=_+(m<<6&4294967295|m>>>26),m=A+(_^(g|~w))+v[3]+2399980690&4294967295,A=g+(m<<10&4294967295|m>>>22),m=w+(g^(A|~_))+v[10]+4293915773&4294967295,w=A+(m<<15&4294967295|m>>>17),m=_+(A^(w|~g))+v[1]+2240044497&4294967295,_=w+(m<<21&4294967295|m>>>11),m=g+(w^(_|~A))+v[8]+1873313359&4294967295,g=_+(m<<6&4294967295|m>>>26),m=A+(_^(g|~w))+v[15]+4264355552&4294967295,A=g+(m<<10&4294967295|m>>>22),m=w+(g^(A|~_))+v[6]+2734768916&4294967295,w=A+(m<<15&4294967295|m>>>17),m=_+(A^(w|~g))+v[13]+1309151649&4294967295,_=w+(m<<21&4294967295|m>>>11),m=g+(w^(_|~A))+v[4]+4149444226&4294967295,g=_+(m<<6&4294967295|m>>>26),m=A+(_^(g|~w))+v[11]+3174756917&4294967295,A=g+(m<<10&4294967295|m>>>22),m=w+(g^(A|~_))+v[2]+718787259&4294967295,w=A+(m<<15&4294967295|m>>>17),m=_+(A^(w|~g))+v[9]+3951481745&4294967295,I.g[0]=I.g[0]+g&4294967295,I.g[1]=I.g[1]+(w+(m<<21&4294967295|m>>>11))&4294967295,I.g[2]=I.g[2]+w&4294967295,I.g[3]=I.g[3]+A&4294967295}r.prototype.u=function(I,g){g===void 0&&(g=I.length);for(var _=g-this.blockSize,v=this.B,w=this.h,A=0;A<g;){if(w==0)for(;A<=_;)i(this,I,A),A+=this.blockSize;if(typeof I=="string"){for(;A<g;)if(v[w++]=I.charCodeAt(A++),w==this.blockSize){i(this,v),w=0;break}}else for(;A<g;)if(v[w++]=I[A++],w==this.blockSize){i(this,v),w=0;break}}this.h=w,this.o+=g},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var g=1;g<I.length-8;++g)I[g]=0;var _=8*this.o;for(g=I.length-8;g<I.length;++g)I[g]=_&255,_/=256;for(this.u(I),I=Array(16),g=_=0;4>g;++g)for(var v=0;32>v;v+=8)I[_++]=this.g[g]>>>v&255;return I};function s(I,g){var _=u;return Object.prototype.hasOwnProperty.call(_,I)?_[I]:_[I]=g(I)}function a(I,g){this.h=g;for(var _=[],v=!0,w=I.length-1;0<=w;w--){var A=I[w]|0;v&&A==g||(_[w]=A,v=!1)}this.g=_}var u={};function h(I){return-128<=I&&128>I?s(I,function(g){return new a([g|0],0>g?-1:0)}):new a([I|0],0>I?-1:0)}function d(I){if(isNaN(I)||!isFinite(I))return E;if(0>I)return N(d(-I));for(var g=[],_=1,v=0;I>=_;v++)g[v]=I/_|0,_*=4294967296;return new a(g,0)}function p(I,g){if(I.length==0)throw Error("number format error: empty string");if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(I.charAt(0)=="-")return N(p(I.substring(1),g));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=d(Math.pow(g,8)),v=E,w=0;w<I.length;w+=8){var A=Math.min(8,I.length-w),m=parseInt(I.substring(w,w+A),g);8>A?(A=d(Math.pow(g,A)),v=v.j(A).add(d(m))):(v=v.j(_),v=v.add(d(m)))}return v}var E=h(0),b=h(1),R=h(16777216);n=a.prototype,n.m=function(){if(x(this))return-N(this).m();for(var I=0,g=1,_=0;_<this.g.length;_++){var v=this.i(_);I+=(0<=v?v:4294967296+v)*g,g*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(k(this))return"0";if(x(this))return"-"+N(this).toString(I);for(var g=d(Math.pow(I,6)),_=this,v="";;){var w=H(_,g).g;_=q(_,w.j(g));var A=((0<_.g.length?_.g[0]:_.h)>>>0).toString(I);if(_=w,k(_))return A+v;for(;6>A.length;)A="0"+A;v=A+v}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function k(I){if(I.h!=0)return!1;for(var g=0;g<I.g.length;g++)if(I.g[g]!=0)return!1;return!0}function x(I){return I.h==-1}n.l=function(I){return I=q(this,I),x(I)?-1:k(I)?0:1};function N(I){for(var g=I.g.length,_=[],v=0;v<g;v++)_[v]=~I.g[v];return new a(_,~I.h).add(b)}n.abs=function(){return x(this)?N(this):this},n.add=function(I){for(var g=Math.max(this.g.length,I.g.length),_=[],v=0,w=0;w<=g;w++){var A=v+(this.i(w)&65535)+(I.i(w)&65535),m=(A>>>16)+(this.i(w)>>>16)+(I.i(w)>>>16);v=m>>>16,A&=65535,m&=65535,_[w]=m<<16|A}return new a(_,_[_.length-1]&-2147483648?-1:0)};function q(I,g){return I.add(N(g))}n.j=function(I){if(k(this)||k(I))return E;if(x(this))return x(I)?N(this).j(N(I)):N(N(this).j(I));if(x(I))return N(this.j(N(I)));if(0>this.l(R)&&0>I.l(R))return d(this.m()*I.m());for(var g=this.g.length+I.g.length,_=[],v=0;v<2*g;v++)_[v]=0;for(v=0;v<this.g.length;v++)for(var w=0;w<I.g.length;w++){var A=this.i(v)>>>16,m=this.i(v)&65535,gt=I.i(w)>>>16,Ar=I.i(w)&65535;_[2*v+2*w]+=m*Ar,j(_,2*v+2*w),_[2*v+2*w+1]+=A*Ar,j(_,2*v+2*w+1),_[2*v+2*w+1]+=m*gt,j(_,2*v+2*w+1),_[2*v+2*w+2]+=A*gt,j(_,2*v+2*w+2)}for(v=0;v<g;v++)_[v]=_[2*v+1]<<16|_[2*v];for(v=g;v<2*g;v++)_[v]=0;return new a(_,0)};function j(I,g){for(;(I[g]&65535)!=I[g];)I[g+1]+=I[g]>>>16,I[g]&=65535,g++}function z(I,g){this.g=I,this.h=g}function H(I,g){if(k(g))throw Error("division by zero");if(k(I))return new z(E,E);if(x(I))return g=H(N(I),g),new z(N(g.g),N(g.h));if(x(g))return g=H(I,N(g)),new z(N(g.g),g.h);if(30<I.g.length){if(x(I)||x(g))throw Error("slowDivide_ only works with positive integers.");for(var _=b,v=g;0>=v.l(I);)_=ke(_),v=ke(v);var w=re(_,1),A=re(v,1);for(v=re(v,2),_=re(_,2);!k(v);){var m=A.add(v);0>=m.l(I)&&(w=w.add(_),A=m),v=re(v,1),_=re(_,1)}return g=q(I,w.j(g)),new z(w,g)}for(w=E;0<=I.l(g);){for(_=Math.max(1,Math.floor(I.m()/g.m())),v=Math.ceil(Math.log(_)/Math.LN2),v=48>=v?1:Math.pow(2,v-48),A=d(_),m=A.j(g);x(m)||0<m.l(I);)_-=v,A=d(_),m=A.j(g);k(A)&&(A=b),w=w.add(A),I=q(I,m)}return new z(w,I)}n.A=function(I){return H(this,I).h},n.and=function(I){for(var g=Math.max(this.g.length,I.g.length),_=[],v=0;v<g;v++)_[v]=this.i(v)&I.i(v);return new a(_,this.h&I.h)},n.or=function(I){for(var g=Math.max(this.g.length,I.g.length),_=[],v=0;v<g;v++)_[v]=this.i(v)|I.i(v);return new a(_,this.h|I.h)},n.xor=function(I){for(var g=Math.max(this.g.length,I.g.length),_=[],v=0;v<g;v++)_[v]=this.i(v)^I.i(v);return new a(_,this.h^I.h)};function ke(I){for(var g=I.g.length+1,_=[],v=0;v<g;v++)_[v]=I.i(v)<<1|I.i(v-1)>>>31;return new a(_,I.h)}function re(I,g){var _=g>>5;g%=32;for(var v=I.g.length-_,w=[],A=0;A<v;A++)w[A]=0<g?I.i(A+_)>>>g|I.i(A+_+1)<<32-g:I.i(A+_);return new a(w,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Kp=Hp.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,yu=Hp.Integer=a}).apply(typeof Wp<"u"?Wp:typeof self<"u"?self:typeof window<"u"?window:{});var eo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},St={};var vu,Iu,rr,wu,Ei,to,Eu,Tu,Au;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,c,l){return o==Array.prototype||o==Object.prototype||(o[c]=l.value),o};function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof eo=="object"&&eo];for(var c=0;c<o.length;++c){var l=o[c];if(l&&l.Math==Math)return l}throw Error("Cannot find global object")}var r=t(this);function i(o,c){if(c)e:{var l=r;o=o.split(".");for(var f=0;f<o.length-1;f++){var T=o[f];if(!(T in l))break e;l=l[T]}o=o[o.length-1],f=l[o],c=c(f),c!=f&&c!=null&&e(l,o,{configurable:!0,writable:!0,value:c})}}function s(o,c){o instanceof String&&(o+="");var l=0,f=!1,T={next:function(){if(!f&&l<o.length){var S=l++;return{value:c(S,o[S]),done:!1}}return f=!0,{done:!0,value:void 0}}};return T[Symbol.iterator]=function(){return T},T}i("Array.prototype.values",function(o){return o||function(){return s(this,function(c,l){return l})}});var a=a||{},u=this||self;function h(o){var c=typeof o;return c=c!="object"?c:o?Array.isArray(o)?"array":c:"null",c=="array"||c=="object"&&typeof o.length=="number"}function d(o){var c=typeof o;return c=="object"&&o!=null||c=="function"}function p(o,c,l){return o.call.apply(o.bind,arguments)}function E(o,c,l){if(!o)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var T=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(T,f),o.apply(c,T)}}return function(){return o.apply(c,arguments)}}function b(o,c,l){return b=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:E,b.apply(null,arguments)}function R(o,c){var l=Array.prototype.slice.call(arguments,1);return function(){var f=l.slice();return f.push.apply(f,arguments),o.apply(this,f)}}function k(o,c){function l(){}l.prototype=c.prototype,o.aa=c.prototype,o.prototype=new l,o.prototype.constructor=o,o.Qb=function(f,T,S){for(var D=Array(arguments.length-2),Y=2;Y<arguments.length;Y++)D[Y-2]=arguments[Y];return c.prototype[T].apply(f,D)}}function x(o){let c=o.length;if(0<c){let l=Array(c);for(let f=0;f<c;f++)l[f]=o[f];return l}return[]}function N(o,c){for(let l=1;l<arguments.length;l++){let f=arguments[l];if(h(f)){let T=o.length||0,S=f.length||0;o.length=T+S;for(let D=0;D<S;D++)o[T+D]=f[D]}else o.push(f)}}class q{constructor(c,l){this.i=c,this.j=l,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function j(o){return/^[\s\xa0]*$/.test(o)}function z(){var o=u.navigator;return o&&(o=o.userAgent)?o:""}function H(o){return H[" "](o),o}H[" "]=function(){};var ke=z().indexOf("Gecko")!=-1&&!(z().toLowerCase().indexOf("webkit")!=-1&&z().indexOf("Edge")==-1)&&!(z().indexOf("Trident")!=-1||z().indexOf("MSIE")!=-1)&&z().indexOf("Edge")==-1;function re(o,c,l){for(let f in o)c.call(l,o[f],f,o)}function I(o,c){for(let l in o)c.call(void 0,o[l],l,o)}function g(o){let c={};for(let l in o)c[l]=o[l];return c}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function v(o,c){let l,f;for(let T=1;T<arguments.length;T++){f=arguments[T];for(l in f)o[l]=f[l];for(let S=0;S<_.length;S++)l=_[S],Object.prototype.hasOwnProperty.call(f,l)&&(o[l]=f[l])}}function w(o){var c=1;o=o.split(":");let l=[];for(;0<c&&o.length;)l.push(o.shift()),c--;return o.length&&l.push(o.join(":")),l}function A(o){u.setTimeout(()=>{throw o},0)}function m(){var o=Vo;let c=null;return o.g&&(c=o.g,o.g=o.g.next,o.g||(o.h=null),c.next=null),c}class gt{constructor(){this.h=this.g=null}add(c,l){let f=Ar.get();f.set(c,l),this.h?this.h.next=f:this.g=f,this.h=f}}var Ar=new q(()=>new Dm,o=>o.reset());class Dm{constructor(){this.next=this.g=this.h=null}set(c,l){this.h=c,this.g=l,this.next=null}reset(){this.next=this.g=this.h=null}}let br,Sr=!1,Vo=new gt,fh=()=>{let o=u.Promise.resolve(void 0);br=()=>{o.then(km)}};var km=()=>{for(var o;o=m();){try{o.h.call(o.g)}catch(l){A(l)}var c=Ar;c.j(o),100>c.h&&(c.h++,o.next=c.g,c.g=o)}Sr=!1};function Dt(){this.s=this.s,this.C=this.C}Dt.prototype.s=!1,Dt.prototype.ma=function(){this.s||(this.s=!0,this.N())},Dt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ae(o,c){this.type=o,this.g=this.target=c,this.defaultPrevented=!1}Ae.prototype.h=function(){this.defaultPrevented=!0};var Nm=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var o=!1,c=Object.defineProperty({},"passive",{get:function(){o=!0}});try{let l=()=>{};u.addEventListener("test",l,c),u.removeEventListener("test",l,c)}catch{}return o}();function Rr(o,c){if(Ae.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var l=this.type=o.type,f=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=c,c=o.relatedTarget){if(ke){e:{try{H(c.nodeName);var T=!0;break e}catch{}T=!1}T||(c=null)}}else l=="mouseover"?c=o.fromElement:l=="mouseout"&&(c=o.toElement);this.relatedTarget=c,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:Om[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&Rr.aa.h.call(this)}}k(Rr,Ae);var Om={2:"touch",3:"pen",4:"mouse"};Rr.prototype.h=function(){Rr.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var Cr="closure_listenable_"+(1e6*Math.random()|0),xm=0;function Mm(o,c,l,f,T){this.listener=o,this.proxy=null,this.src=c,this.type=l,this.capture=!!f,this.ha=T,this.key=++xm,this.da=this.fa=!1}function ji(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function zi(o){this.src=o,this.g={},this.h=0}zi.prototype.add=function(o,c,l,f,T){var S=o.toString();o=this.g[S],o||(o=this.g[S]=[],this.h++);var D=Fo(o,c,f,T);return-1<D?(c=o[D],l||(c.fa=!1)):(c=new Mm(c,this.src,S,!!f,T),c.fa=l,o.push(c)),c};function Uo(o,c){var l=c.type;if(l in o.g){var f=o.g[l],T=Array.prototype.indexOf.call(f,c,void 0),S;(S=0<=T)&&Array.prototype.splice.call(f,T,1),S&&(ji(c),o.g[l].length==0&&(delete o.g[l],o.h--))}}function Fo(o,c,l,f){for(var T=0;T<o.length;++T){var S=o[T];if(!S.da&&S.listener==c&&S.capture==!!l&&S.ha==f)return T}return-1}var Bo="closure_lm_"+(1e6*Math.random()|0),qo={};function ph(o,c,l,f,T){if(f&&f.once)return mh(o,c,l,f,T);if(Array.isArray(c)){for(var S=0;S<c.length;S++)ph(o,c[S],l,f,T);return null}return l=Go(l),o&&o[Cr]?o.K(c,l,d(f)?!!f.capture:!!f,T):gh(o,c,l,!1,f,T)}function gh(o,c,l,f,T,S){if(!c)throw Error("Invalid event type");var D=d(T)?!!T.capture:!!T,Y=jo(o);if(Y||(o[Bo]=Y=new zi(o)),l=Y.add(c,l,f,D,S),l.proxy)return l;if(f=Lm(),l.proxy=f,f.src=o,f.listener=l,o.addEventListener)Nm||(T=D),T===void 0&&(T=!1),o.addEventListener(c.toString(),f,T);else if(o.attachEvent)o.attachEvent(yh(c.toString()),f);else if(o.addListener&&o.removeListener)o.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return l}function Lm(){function o(l){return c.call(o.src,o.listener,l)}let c=Vm;return o}function mh(o,c,l,f,T){if(Array.isArray(c)){for(var S=0;S<c.length;S++)mh(o,c[S],l,f,T);return null}return l=Go(l),o&&o[Cr]?o.L(c,l,d(f)?!!f.capture:!!f,T):gh(o,c,l,!0,f,T)}function _h(o,c,l,f,T){if(Array.isArray(c))for(var S=0;S<c.length;S++)_h(o,c[S],l,f,T);else f=d(f)?!!f.capture:!!f,l=Go(l),o&&o[Cr]?(o=o.i,c=String(c).toString(),c in o.g&&(S=o.g[c],l=Fo(S,l,f,T),-1<l&&(ji(S[l]),Array.prototype.splice.call(S,l,1),S.length==0&&(delete o.g[c],o.h--)))):o&&(o=jo(o))&&(c=o.g[c.toString()],o=-1,c&&(o=Fo(c,l,f,T)),(l=-1<o?c[o]:null)&&$o(l))}function $o(o){if(typeof o!="number"&&o&&!o.da){var c=o.src;if(c&&c[Cr])Uo(c.i,o);else{var l=o.type,f=o.proxy;c.removeEventListener?c.removeEventListener(l,f,o.capture):c.detachEvent?c.detachEvent(yh(l),f):c.addListener&&c.removeListener&&c.removeListener(f),(l=jo(c))?(Uo(l,o),l.h==0&&(l.src=null,c[Bo]=null)):ji(o)}}}function yh(o){return o in qo?qo[o]:qo[o]="on"+o}function Vm(o,c){if(o.da)o=!0;else{c=new Rr(c,this);var l=o.listener,f=o.ha||o.src;o.fa&&$o(o),o=l.call(f,c)}return o}function jo(o){return o=o[Bo],o instanceof zi?o:null}var zo="__closure_events_fn_"+(1e9*Math.random()>>>0);function Go(o){return typeof o=="function"?o:(o[zo]||(o[zo]=function(c){return o.handleEvent(c)}),o[zo])}function be(){Dt.call(this),this.i=new zi(this),this.M=this,this.F=null}k(be,Dt),be.prototype[Cr]=!0,be.prototype.removeEventListener=function(o,c,l,f){_h(this,o,c,l,f)};function Ne(o,c){var l,f=o.F;if(f)for(l=[];f;f=f.F)l.push(f);if(o=o.M,f=c.type||c,typeof c=="string")c=new Ae(c,o);else if(c instanceof Ae)c.target=c.target||o;else{var T=c;c=new Ae(f,o),v(c,T)}if(T=!0,l)for(var S=l.length-1;0<=S;S--){var D=c.g=l[S];T=Gi(D,f,!0,c)&&T}if(D=c.g=o,T=Gi(D,f,!0,c)&&T,T=Gi(D,f,!1,c)&&T,l)for(S=0;S<l.length;S++)D=c.g=l[S],T=Gi(D,f,!1,c)&&T}be.prototype.N=function(){if(be.aa.N.call(this),this.i){var o=this.i,c;for(c in o.g){for(var l=o.g[c],f=0;f<l.length;f++)ji(l[f]);delete o.g[c],o.h--}}this.F=null},be.prototype.K=function(o,c,l,f){return this.i.add(String(o),c,!1,l,f)},be.prototype.L=function(o,c,l,f){return this.i.add(String(o),c,!0,l,f)};function Gi(o,c,l,f){if(c=o.i.g[String(c)],!c)return!0;c=c.concat();for(var T=!0,S=0;S<c.length;++S){var D=c[S];if(D&&!D.da&&D.capture==l){var Y=D.listener,ve=D.ha||D.src;D.fa&&Uo(o.i,D),T=Y.call(ve,f)!==!1&&T}}return T&&!f.defaultPrevented}function vh(o,c,l){if(typeof o=="function")l&&(o=b(o,l));else if(o&&typeof o.handleEvent=="function")o=b(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:u.setTimeout(o,c||0)}function Ih(o){o.g=vh(()=>{o.g=null,o.i&&(o.i=!1,Ih(o))},o.l);let c=o.h;o.h=null,o.m.apply(null,c)}class Um extends Dt{constructor(c,l){super(),this.m=c,this.l=l,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:Ih(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Pr(o){Dt.call(this),this.h=o,this.g={}}k(Pr,Dt);var wh=[];function Eh(o){re(o.g,function(c,l){this.g.hasOwnProperty(l)&&$o(c)},o),o.g={}}Pr.prototype.N=function(){Pr.aa.N.call(this),Eh(this)},Pr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Wo=u.JSON.stringify,Fm=u.JSON.parse,Bm=class{stringify(o){return u.JSON.stringify(o,void 0)}parse(o){return u.JSON.parse(o,void 0)}};function Ho(){}Ho.prototype.h=null;function Th(o){return o.h||(o.h=o.i())}function Ah(){}var Dr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ko(){Ae.call(this,"d")}k(Ko,Ae);function Qo(){Ae.call(this,"c")}k(Qo,Ae);var tn={},bh=null;function Wi(){return bh=bh||new be}tn.La="serverreachability";function Sh(o){Ae.call(this,tn.La,o)}k(Sh,Ae);function kr(o){let c=Wi();Ne(c,new Sh(c))}tn.STAT_EVENT="statevent";function Rh(o,c){Ae.call(this,tn.STAT_EVENT,o),this.stat=c}k(Rh,Ae);function Oe(o){let c=Wi();Ne(c,new Rh(c,o))}tn.Ma="timingevent";function Ch(o,c){Ae.call(this,tn.Ma,o),this.size=c}k(Ch,Ae);function Nr(o,c){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){o()},c)}function Or(){this.g=!0}Or.prototype.xa=function(){this.g=!1};function qm(o,c,l,f,T,S){o.info(function(){if(o.g)if(S)for(var D="",Y=S.split("&"),ve=0;ve<Y.length;ve++){var Q=Y[ve].split("=");if(1<Q.length){var Se=Q[0];Q=Q[1];var Re=Se.split("_");D=2<=Re.length&&Re[1]=="type"?D+(Se+"="+Q+"&"):D+(Se+"=redacted&")}}else D=null;else D=S;return"XMLHTTP REQ ("+f+") [attempt "+T+"]: "+c+`
`+l+`
`+D})}function $m(o,c,l,f,T,S,D){o.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+T+"]: "+c+`
`+l+`
`+S+" "+D})}function Mn(o,c,l,f){o.info(function(){return"XMLHTTP TEXT ("+c+"): "+zm(o,l)+(f?" "+f:"")})}function jm(o,c){o.info(function(){return"TIMEOUT: "+c})}Or.prototype.info=function(){};function zm(o,c){if(!o.g)return c;if(!c)return null;try{var l=JSON.parse(c);if(l){for(o=0;o<l.length;o++)if(Array.isArray(l[o])){var f=l[o];if(!(2>f.length)){var T=f[1];if(Array.isArray(T)&&!(1>T.length)){var S=T[0];if(S!="noop"&&S!="stop"&&S!="close")for(var D=1;D<T.length;D++)T[D]=""}}}}return Wo(l)}catch{return c}}var Hi={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ph={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Jo;function Ki(){}k(Ki,Ho),Ki.prototype.g=function(){return new XMLHttpRequest},Ki.prototype.i=function(){return{}},Jo=new Ki;function kt(o,c,l,f){this.j=o,this.i=c,this.l=l,this.R=f||1,this.U=new Pr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Dh}function Dh(){this.i=null,this.g="",this.h=!1}var kh={},Yo={};function Xo(o,c,l){o.L=1,o.v=Xi(mt(c)),o.m=l,o.P=!0,Nh(o,null)}function Nh(o,c){o.F=Date.now(),Qi(o),o.A=mt(o.v);var l=o.A,f=o.R;Array.isArray(f)||(f=[String(f)]),Wh(l.i,"t",f),o.C=0,l=o.j.J,o.h=new Dh,o.g=ld(o.j,l?c:null,!o.m),0<o.O&&(o.M=new Um(b(o.Y,o,o.g),o.O)),c=o.U,l=o.g,f=o.ca;var T="readystatechange";Array.isArray(T)||(T&&(wh[0]=T.toString()),T=wh);for(var S=0;S<T.length;S++){var D=ph(l,T[S],f||c.handleEvent,!1,c.h||c);if(!D)break;c.g[D.key]=D}c=o.H?g(o.H):{},o.m?(o.u||(o.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,c)):(o.u="GET",o.g.ea(o.A,o.u,null,c)),kr(),qm(o.i,o.u,o.A,o.l,o.R,o.m)}kt.prototype.ca=function(o){o=o.target;let c=this.M;c&&_t(o)==3?c.j():this.Y(o)},kt.prototype.Y=function(o){try{if(o==this.g)e:{let Re=_t(this.g);var c=this.g.Ba();let Un=this.g.Z();if(!(3>Re)&&(Re!=3||this.g&&(this.h.h||this.g.oa()||Zh(this.g)))){this.J||Re!=4||c==7||(c==8||0>=Un?kr(3):kr(2)),Zo(this);var l=this.g.Z();this.X=l;t:if(Oh(this)){var f=Zh(this.g);o="";var T=f.length,S=_t(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){nn(this),xr(this);var D="";break t}this.h.i=new u.TextDecoder}for(c=0;c<T;c++)this.h.h=!0,o+=this.h.i.decode(f[c],{stream:!(S&&c==T-1)});f.length=0,this.h.g+=o,this.C=0,D=this.h.g}else D=this.g.oa();if(this.o=l==200,$m(this.i,this.u,this.A,this.l,this.R,Re,l),this.o){if(this.T&&!this.K){t:{if(this.g){var Y,ve=this.g;if((Y=ve.g?ve.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(Y)){var Q=Y;break t}}Q=null}if(l=Q)Mn(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ea(this,l);else{this.o=!1,this.s=3,Oe(12),nn(this),xr(this);break e}}if(this.P){l=!0;let Qe;for(;!this.J&&this.C<D.length;)if(Qe=Gm(this,D),Qe==Yo){Re==4&&(this.s=4,Oe(14),l=!1),Mn(this.i,this.l,null,"[Incomplete Response]");break}else if(Qe==kh){this.s=4,Oe(15),Mn(this.i,this.l,D,"[Invalid Chunk]"),l=!1;break}else Mn(this.i,this.l,Qe,null),ea(this,Qe);if(Oh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Re!=4||D.length!=0||this.h.h||(this.s=1,Oe(16),l=!1),this.o=this.o&&l,!l)Mn(this.i,this.l,D,"[Invalid Chunked Response]"),nn(this),xr(this);else if(0<D.length&&!this.W){this.W=!0;var Se=this.j;Se.g==this&&Se.ba&&!Se.M&&(Se.j.info("Great, no buffering proxy detected. Bytes received: "+D.length),oa(Se),Se.M=!0,Oe(11))}}else Mn(this.i,this.l,D,null),ea(this,D);Re==4&&nn(this),this.o&&!this.J&&(Re==4?od(this.j,this):(this.o=!1,Qi(this)))}else c_(this.g),l==400&&0<D.indexOf("Unknown SID")?(this.s=3,Oe(12)):(this.s=0,Oe(13)),nn(this),xr(this)}}}catch{}finally{}};function Oh(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function Gm(o,c){var l=o.C,f=c.indexOf(`
`,l);return f==-1?Yo:(l=Number(c.substring(l,f)),isNaN(l)?kh:(f+=1,f+l>c.length?Yo:(c=c.slice(f,f+l),o.C=f+l,c)))}kt.prototype.cancel=function(){this.J=!0,nn(this)};function Qi(o){o.S=Date.now()+o.I,xh(o,o.I)}function xh(o,c){if(o.B!=null)throw Error("WatchDog timer not null");o.B=Nr(b(o.ba,o),c)}function Zo(o){o.B&&(u.clearTimeout(o.B),o.B=null)}kt.prototype.ba=function(){this.B=null;let o=Date.now();0<=o-this.S?(jm(this.i,this.A),this.L!=2&&(kr(),Oe(17)),nn(this),this.s=2,xr(this)):xh(this,this.S-o)};function xr(o){o.j.G==0||o.J||od(o.j,o)}function nn(o){Zo(o);var c=o.M;c&&typeof c.ma=="function"&&c.ma(),o.M=null,Eh(o.U),o.g&&(c=o.g,o.g=null,c.abort(),c.ma())}function ea(o,c){try{var l=o.j;if(l.G!=0&&(l.g==o||ta(l.h,o))){if(!o.K&&ta(l.h,o)&&l.G==3){try{var f=l.Da.g.parse(c)}catch{f=null}if(Array.isArray(f)&&f.length==3){var T=f;if(T[0]==0){e:if(!l.u){if(l.g)if(l.g.F+3e3<o.F)rs(l),ts(l);else break e;sa(l),Oe(18)}}else l.za=T[1],0<l.za-l.T&&37500>T[2]&&l.F&&l.v==0&&!l.C&&(l.C=Nr(b(l.Za,l),6e3));if(1>=Vh(l.h)&&l.ca){try{l.ca()}catch{}l.ca=void 0}}else sn(l,11)}else if((o.K||l.g==o)&&rs(l),!j(c))for(T=l.Da.g.parse(c),c=0;c<T.length;c++){let Q=T[c];if(l.T=Q[0],Q=Q[1],l.G==2)if(Q[0]=="c"){l.K=Q[1],l.ia=Q[2];let Se=Q[3];Se!=null&&(l.la=Se,l.j.info("VER="+l.la));let Re=Q[4];Re!=null&&(l.Aa=Re,l.j.info("SVER="+l.Aa));let Un=Q[5];Un!=null&&typeof Un=="number"&&0<Un&&(f=1.5*Un,l.L=f,l.j.info("backChannelRequestTimeoutMs_="+f)),f=l;let Qe=o.g;if(Qe){let ss=Qe.g?Qe.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ss){var S=f.h;S.g||ss.indexOf("spdy")==-1&&ss.indexOf("quic")==-1&&ss.indexOf("h2")==-1||(S.j=S.l,S.g=new Set,S.h&&(na(S,S.h),S.h=null))}if(f.D){let aa=Qe.g?Qe.g.getResponseHeader("X-HTTP-Session-Id"):null;aa&&(f.ya=aa,Z(f.I,f.D,aa))}}l.G=3,l.l&&l.l.ua(),l.ba&&(l.R=Date.now()-o.F,l.j.info("Handshake RTT: "+l.R+"ms")),f=l;var D=o;if(f.qa=ud(f,f.J?f.ia:null,f.W),D.K){Uh(f.h,D);var Y=D,ve=f.L;ve&&(Y.I=ve),Y.B&&(Zo(Y),Qi(Y)),f.g=D}else id(f);0<l.i.length&&ns(l)}else Q[0]!="stop"&&Q[0]!="close"||sn(l,7);else l.G==3&&(Q[0]=="stop"||Q[0]=="close"?Q[0]=="stop"?sn(l,7):ia(l):Q[0]!="noop"&&l.l&&l.l.ta(Q),l.v=0)}}kr(4)}catch{}}var Wm=class{constructor(o,c){this.g=o,this.map=c}};function Mh(o){this.l=o||10,u.PerformanceNavigationTiming?(o=u.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Lh(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Vh(o){return o.h?1:o.g?o.g.size:0}function ta(o,c){return o.h?o.h==c:o.g?o.g.has(c):!1}function na(o,c){o.g?o.g.add(c):o.h=c}function Uh(o,c){o.h&&o.h==c?o.h=null:o.g&&o.g.has(c)&&o.g.delete(c)}Mh.prototype.cancel=function(){if(this.i=Fh(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let o of this.g.values())o.cancel();this.g.clear()}};function Fh(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let c=o.i;for(let l of o.g.values())c=c.concat(l.D);return c}return x(o.i)}function Hm(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(h(o)){for(var c=[],l=o.length,f=0;f<l;f++)c.push(o[f]);return c}c=[],l=0;for(f in o)c[l++]=o[f];return c}function Km(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(h(o)||typeof o=="string"){var c=[];o=o.length;for(var l=0;l<o;l++)c.push(l);return c}c=[],l=0;for(let f in o)c[l++]=f;return c}}}function Bh(o,c){if(o.forEach&&typeof o.forEach=="function")o.forEach(c,void 0);else if(h(o)||typeof o=="string")Array.prototype.forEach.call(o,c,void 0);else for(var l=Km(o),f=Hm(o),T=f.length,S=0;S<T;S++)c.call(void 0,f[S],l&&l[S],o)}var qh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Qm(o,c){if(o){o=o.split("&");for(var l=0;l<o.length;l++){var f=o[l].indexOf("="),T=null;if(0<=f){var S=o[l].substring(0,f);T=o[l].substring(f+1)}else S=o[l];c(S,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function rn(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof rn){this.h=o.h,Ji(this,o.j),this.o=o.o,this.g=o.g,Yi(this,o.s),this.l=o.l;var c=o.i,l=new Vr;l.i=c.i,c.g&&(l.g=new Map(c.g),l.h=c.h),$h(this,l),this.m=o.m}else o&&(c=String(o).match(qh))?(this.h=!1,Ji(this,c[1]||"",!0),this.o=Mr(c[2]||""),this.g=Mr(c[3]||"",!0),Yi(this,c[4]),this.l=Mr(c[5]||"",!0),$h(this,c[6]||"",!0),this.m=Mr(c[7]||"")):(this.h=!1,this.i=new Vr(null,this.h))}rn.prototype.toString=function(){var o=[],c=this.j;c&&o.push(Lr(c,jh,!0),":");var l=this.g;return(l||c=="file")&&(o.push("//"),(c=this.o)&&o.push(Lr(c,jh,!0),"@"),o.push(encodeURIComponent(String(l)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l=this.s,l!=null&&o.push(":",String(l))),(l=this.l)&&(this.g&&l.charAt(0)!="/"&&o.push("/"),o.push(Lr(l,l.charAt(0)=="/"?Xm:Ym,!0))),(l=this.i.toString())&&o.push("?",l),(l=this.m)&&o.push("#",Lr(l,e_)),o.join("")};function mt(o){return new rn(o)}function Ji(o,c,l){o.j=l?Mr(c,!0):c,o.j&&(o.j=o.j.replace(/:$/,""))}function Yi(o,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);o.s=c}else o.s=null}function $h(o,c,l){c instanceof Vr?(o.i=c,t_(o.i,o.h)):(l||(c=Lr(c,Zm)),o.i=new Vr(c,o.h))}function Z(o,c,l){o.i.set(c,l)}function Xi(o){return Z(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function Mr(o,c){return o?c?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Lr(o,c,l){return typeof o=="string"?(o=encodeURI(o).replace(c,Jm),l&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Jm(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var jh=/[#\/\?@]/g,Ym=/[#\?:]/g,Xm=/[#\?]/g,Zm=/[#\?@]/g,e_=/#/g;function Vr(o,c){this.h=this.g=null,this.i=o||null,this.j=!!c}function Nt(o){o.g||(o.g=new Map,o.h=0,o.i&&Qm(o.i,function(c,l){o.add(decodeURIComponent(c.replace(/\+/g," ")),l)}))}n=Vr.prototype,n.add=function(o,c){Nt(this),this.i=null,o=Ln(this,o);var l=this.g.get(o);return l||this.g.set(o,l=[]),l.push(c),this.h+=1,this};function zh(o,c){Nt(o),c=Ln(o,c),o.g.has(c)&&(o.i=null,o.h-=o.g.get(c).length,o.g.delete(c))}function Gh(o,c){return Nt(o),c=Ln(o,c),o.g.has(c)}n.forEach=function(o,c){Nt(this),this.g.forEach(function(l,f){l.forEach(function(T){o.call(c,T,f,this)},this)},this)},n.na=function(){Nt(this);let o=Array.from(this.g.values()),c=Array.from(this.g.keys()),l=[];for(let f=0;f<c.length;f++){let T=o[f];for(let S=0;S<T.length;S++)l.push(c[f])}return l},n.V=function(o){Nt(this);let c=[];if(typeof o=="string")Gh(this,o)&&(c=c.concat(this.g.get(Ln(this,o))));else{o=Array.from(this.g.values());for(let l=0;l<o.length;l++)c=c.concat(o[l])}return c},n.set=function(o,c){return Nt(this),this.i=null,o=Ln(this,o),Gh(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[c]),this.h+=1,this},n.get=function(o,c){return o?(o=this.V(o),0<o.length?String(o[0]):c):c};function Wh(o,c,l){zh(o,c),0<l.length&&(o.i=null,o.g.set(Ln(o,c),x(l)),o.h+=l.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let o=[],c=Array.from(this.g.keys());for(var l=0;l<c.length;l++){var f=c[l];let S=encodeURIComponent(String(f)),D=this.V(f);for(f=0;f<D.length;f++){var T=S;D[f]!==""&&(T+="="+encodeURIComponent(String(D[f]))),o.push(T)}}return this.i=o.join("&")};function Ln(o,c){return c=String(c),o.j&&(c=c.toLowerCase()),c}function t_(o,c){c&&!o.j&&(Nt(o),o.i=null,o.g.forEach(function(l,f){var T=f.toLowerCase();f!=T&&(zh(this,f),Wh(this,T,l))},o)),o.j=c}function n_(o,c){let l=new Or;if(u.Image){let f=new Image;f.onload=R(Ot,l,"TestLoadImage: loaded",!0,c,f),f.onerror=R(Ot,l,"TestLoadImage: error",!1,c,f),f.onabort=R(Ot,l,"TestLoadImage: abort",!1,c,f),f.ontimeout=R(Ot,l,"TestLoadImage: timeout",!1,c,f),u.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=o}else c(!1)}function r_(o,c){let l=new Or,f=new AbortController,T=setTimeout(()=>{f.abort(),Ot(l,"TestPingServer: timeout",!1,c)},1e4);fetch(o,{signal:f.signal}).then(S=>{clearTimeout(T),S.ok?Ot(l,"TestPingServer: ok",!0,c):Ot(l,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(T),Ot(l,"TestPingServer: error",!1,c)})}function Ot(o,c,l,f,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),f(l)}catch{}}function i_(){this.g=new Bm}function s_(o,c,l){let f=l||"";try{Bh(o,function(T,S){let D=T;d(T)&&(D=Wo(T)),c.push(f+S+"="+encodeURIComponent(D))})}catch(T){throw c.push(f+"type="+encodeURIComponent("_badmap")),T}}function Ur(o){this.l=o.Ub||null,this.j=o.eb||!1}k(Ur,Ho),Ur.prototype.g=function(){return new Zi(this.l,this.j)},Ur.prototype.i=function(o){return function(){return o}}({});function Zi(o,c){be.call(this),this.D=o,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}k(Zi,be),n=Zi.prototype,n.open=function(o,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=c,this.readyState=1,Br(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(c.body=o),(this.D||u).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Fr(this)),this.readyState=0},n.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Br(this)),this.g&&(this.readyState=3,Br(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Hh(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function Hh(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}n.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var c=o.value?o.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!o.done}))&&(this.response=this.responseText+=c)}o.done?Fr(this):Br(this),this.readyState==3&&Hh(this)}},n.Ra=function(o){this.g&&(this.response=this.responseText=o,Fr(this))},n.Qa=function(o){this.g&&(this.response=o,Fr(this))},n.ga=function(){this.g&&Fr(this)};function Fr(o){o.readyState=4,o.l=null,o.j=null,o.v=null,Br(o)}n.setRequestHeader=function(o,c){this.u.append(o,c)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let o=[],c=this.h.entries();for(var l=c.next();!l.done;)l=l.value,o.push(l[0]+": "+l[1]),l=c.next();return o.join(`\r
`)};function Br(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(Zi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function Kh(o){let c="";return re(o,function(l,f){c+=f,c+=":",c+=l,c+=`\r
`}),c}function ra(o,c,l){e:{for(f in l){var f=!1;break e}f=!0}f||(l=Kh(l),typeof o=="string"?l!=null&&encodeURIComponent(String(l)):Z(o,c,l))}function ie(o){be.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}k(ie,be);var o_=/^https?$/i,a_=["POST","PUT"];n=ie.prototype,n.Ha=function(o){this.J=o},n.ea=function(o,c,l,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);c=c?c.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Jo.g(),this.v=this.o?Th(this.o):Th(Jo),this.g.onreadystatechange=b(this.Ea,this);try{this.B=!0,this.g.open(c,String(o),!0),this.B=!1}catch(S){Qh(this,S);return}if(o=l||"",l=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var T in f)l.set(T,f[T]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let S of f.keys())l.set(S,f.get(S));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(l.keys()).find(S=>S.toLowerCase()=="content-type"),T=u.FormData&&o instanceof u.FormData,!(0<=Array.prototype.indexOf.call(a_,c,void 0))||f||T||l.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[S,D]of l)this.g.setRequestHeader(S,D);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Xh(this),this.u=!0,this.g.send(o),this.u=!1}catch(S){Qh(this,S)}};function Qh(o,c){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=c,o.m=5,Jh(o),es(o)}function Jh(o){o.A||(o.A=!0,Ne(o,"complete"),Ne(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,Ne(this,"complete"),Ne(this,"abort"),es(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),es(this,!0)),ie.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Yh(this):this.bb())},n.bb=function(){Yh(this)};function Yh(o){if(o.h&&typeof a<"u"&&(!o.v[1]||_t(o)!=4||o.Z()!=2)){if(o.u&&_t(o)==4)vh(o.Ea,0,o);else if(Ne(o,"readystatechange"),_t(o)==4){o.h=!1;try{let D=o.Z();e:switch(D){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var l;if(!(l=c)){var f;if(f=D===0){var T=String(o.D).match(qh)[1]||null;!T&&u.self&&u.self.location&&(T=u.self.location.protocol.slice(0,-1)),f=!o_.test(T?T.toLowerCase():"")}l=f}if(l)Ne(o,"complete"),Ne(o,"success");else{o.m=6;try{var S=2<_t(o)?o.g.statusText:""}catch{S=""}o.l=S+" ["+o.Z()+"]",Jh(o)}}finally{es(o)}}}}function es(o,c){if(o.g){Xh(o);let l=o.g,f=o.v[0]?()=>{}:null;o.g=null,o.v=null,c||Ne(o,"ready");try{l.onreadystatechange=f}catch{}}}function Xh(o){o.I&&(u.clearTimeout(o.I),o.I=null)}n.isActive=function(){return!!this.g};function _t(o){return o.g?o.g.readyState:0}n.Z=function(){try{return 2<_t(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(o){if(this.g){var c=this.g.responseText;return o&&c.indexOf(o)==0&&(c=c.substring(o.length)),Fm(c)}};function Zh(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function c_(o){let c={};o=(o.g&&2<=_t(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<o.length;f++){if(j(o[f]))continue;var l=w(o[f]);let T=l[0];if(l=l[1],typeof l!="string")continue;l=l.trim();let S=c[T]||[];c[T]=S,S.push(l)}I(c,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function qr(o,c,l){return l&&l.internalChannelParams&&l.internalChannelParams[o]||c}function ed(o){this.Aa=0,this.i=[],this.j=new Or,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=qr("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=qr("baseRetryDelayMs",5e3,o),this.cb=qr("retryDelaySeedMs",1e4,o),this.Wa=qr("forwardChannelMaxRetries",2,o),this.wa=qr("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Mh(o&&o.concurrentRequestLimit),this.Da=new i_,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=ed.prototype,n.la=8,n.G=1,n.connect=function(o,c,l,f){Oe(0),this.W=o,this.H=c||{},l&&f!==void 0&&(this.H.OSID=l,this.H.OAID=f),this.F=this.X,this.I=ud(this,null,this.W),ns(this)};function ia(o){if(td(o),o.G==3){var c=o.U++,l=mt(o.I);if(Z(l,"SID",o.K),Z(l,"RID",c),Z(l,"TYPE","terminate"),$r(o,l),c=new kt(o,o.j,c),c.L=2,c.v=Xi(mt(l)),l=!1,u.navigator&&u.navigator.sendBeacon)try{l=u.navigator.sendBeacon(c.v.toString(),"")}catch{}!l&&u.Image&&(new Image().src=c.v,l=!0),l||(c.g=ld(c.j,null),c.g.ea(c.v)),c.F=Date.now(),Qi(c)}cd(o)}function ts(o){o.g&&(oa(o),o.g.cancel(),o.g=null)}function td(o){ts(o),o.u&&(u.clearTimeout(o.u),o.u=null),rs(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&u.clearTimeout(o.s),o.s=null)}function ns(o){if(!Lh(o.h)&&!o.s){o.s=!0;var c=o.Ga;br||fh(),Sr||(br(),Sr=!0),Vo.add(c,o),o.B=0}}function u_(o,c){return Vh(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=c.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=Nr(b(o.Ga,o,c),ad(o,o.B)),o.B++,!0)}n.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;let T=new kt(this,this.j,o),S=this.o;if(this.S&&(S?(S=g(S),v(S,this.S)):S=this.S),this.m!==null||this.O||(T.H=S,S=null),this.P)e:{for(var c=0,l=0;l<this.i.length;l++){t:{var f=this.i[l];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(c+=f,4096<c){c=l;break e}if(c===4096||l===this.i.length-1){c=l+1;break e}}c=1e3}else c=1e3;c=rd(this,T,c),l=mt(this.I),Z(l,"RID",o),Z(l,"CVER",22),this.D&&Z(l,"X-HTTP-Session-Id",this.D),$r(this,l),S&&(this.O?c="headers="+encodeURIComponent(String(Kh(S)))+"&"+c:this.m&&ra(l,this.m,S)),na(this.h,T),this.Ua&&Z(l,"TYPE","init"),this.P?(Z(l,"$req",c),Z(l,"SID","null"),T.T=!0,Xo(T,l,null)):Xo(T,l,c),this.G=2}}else this.G==3&&(o?nd(this,o):this.i.length==0||Lh(this.h)||nd(this))};function nd(o,c){var l;c?l=c.l:l=o.U++;let f=mt(o.I);Z(f,"SID",o.K),Z(f,"RID",l),Z(f,"AID",o.T),$r(o,f),o.m&&o.o&&ra(f,o.m,o.o),l=new kt(o,o.j,l,o.B+1),o.m===null&&(l.H=o.o),c&&(o.i=c.D.concat(o.i)),c=rd(o,l,1e3),l.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),na(o.h,l),Xo(l,f,c)}function $r(o,c){o.H&&re(o.H,function(l,f){Z(c,f,l)}),o.l&&Bh({},function(l,f){Z(c,f,l)})}function rd(o,c,l){l=Math.min(o.i.length,l);var f=o.l?b(o.l.Na,o.l,o):null;e:{var T=o.i;let S=-1;for(;;){let D=["count="+l];S==-1?0<l?(S=T[0].g,D.push("ofs="+S)):S=0:D.push("ofs="+S);let Y=!0;for(let ve=0;ve<l;ve++){let Q=T[ve].g,Se=T[ve].map;if(Q-=S,0>Q)S=Math.max(0,T[ve].g-100),Y=!1;else try{s_(Se,D,"req"+Q+"_")}catch{f&&f(Se)}}if(Y){f=D.join("&");break e}}}return o=o.i.splice(0,l),c.D=o,f}function id(o){if(!o.g&&!o.u){o.Y=1;var c=o.Fa;br||fh(),Sr||(br(),Sr=!0),Vo.add(c,o),o.v=0}}function sa(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=Nr(b(o.Fa,o),ad(o,o.v)),o.v++,!0)}n.Fa=function(){if(this.u=null,sd(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=Nr(b(this.ab,this),o)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Oe(10),ts(this),sd(this))};function oa(o){o.A!=null&&(u.clearTimeout(o.A),o.A=null)}function sd(o){o.g=new kt(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var c=mt(o.qa);Z(c,"RID","rpc"),Z(c,"SID",o.K),Z(c,"AID",o.T),Z(c,"CI",o.F?"0":"1"),!o.F&&o.ja&&Z(c,"TO",o.ja),Z(c,"TYPE","xmlhttp"),$r(o,c),o.m&&o.o&&ra(c,o.m,o.o),o.L&&(o.g.I=o.L);var l=o.g;o=o.ia,l.L=1,l.v=Xi(mt(c)),l.m=null,l.P=!0,Nh(l,o)}n.Za=function(){this.C!=null&&(this.C=null,ts(this),sa(this),Oe(19))};function rs(o){o.C!=null&&(u.clearTimeout(o.C),o.C=null)}function od(o,c){var l=null;if(o.g==c){rs(o),oa(o),o.g=null;var f=2}else if(ta(o.h,c))l=c.D,Uh(o.h,c),f=1;else return;if(o.G!=0){if(c.o)if(f==1){l=c.m?c.m.length:0,c=Date.now()-c.F;var T=o.B;f=Wi(),Ne(f,new Ch(f,l)),ns(o)}else id(o);else if(T=c.s,T==3||T==0&&0<c.X||!(f==1&&u_(o,c)||f==2&&sa(o)))switch(l&&0<l.length&&(c=o.h,c.i=c.i.concat(l)),T){case 1:sn(o,5);break;case 4:sn(o,10);break;case 3:sn(o,6);break;default:sn(o,2)}}}function ad(o,c){let l=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(l*=2),l*c}function sn(o,c){if(o.j.info("Error code "+c),c==2){var l=b(o.fb,o),f=o.Xa;let T=!f;f=new rn(f||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Ji(f,"https"),Xi(f),T?n_(f.toString(),l):r_(f.toString(),l)}else Oe(2);o.G=0,o.l&&o.l.sa(c),cd(o),td(o)}n.fb=function(o){o?(this.j.info("Successfully pinged google.com"),Oe(2)):(this.j.info("Failed to ping google.com"),Oe(1))};function cd(o){if(o.G=0,o.ka=[],o.l){let c=Fh(o.h);(c.length!=0||o.i.length!=0)&&(N(o.ka,c),N(o.ka,o.i),o.h.i.length=0,x(o.i),o.i.length=0),o.l.ra()}}function ud(o,c,l){var f=l instanceof rn?mt(l):new rn(l);if(f.g!="")c&&(f.g=c+"."+f.g),Yi(f,f.s);else{var T=u.location;f=T.protocol,c=c?c+"."+T.hostname:T.hostname,T=+T.port;var S=new rn(null);f&&Ji(S,f),c&&(S.g=c),T&&Yi(S,T),l&&(S.l=l),f=S}return l=o.D,c=o.ya,l&&c&&Z(f,l,c),Z(f,"VER",o.la),$r(o,f),f}function ld(o,c,l){if(c&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=o.Ca&&!o.pa?new ie(new Ur({eb:l})):new ie(o.pa),c.Ha(o.J),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function hd(){}n=hd.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function is(){}is.prototype.g=function(o,c){return new qe(o,c)};function qe(o,c){be.call(this),this.g=new ed(c),this.l=o,this.h=c&&c.messageUrlParams||null,o=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(o?o["X-WebChannel-Content-Type"]=c.messageContentType:o={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(o?o["X-WebChannel-Client-Profile"]=c.va:o={"X-WebChannel-Client-Profile":c.va}),this.g.S=o,(o=c&&c.Sb)&&!j(o)&&(this.g.m=o),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!j(c)&&(this.g.D=c,o=this.h,o!==null&&c in o&&(o=this.h,c in o&&delete o[c])),this.j=new Vn(this)}k(qe,be),qe.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},qe.prototype.close=function(){ia(this.g)},qe.prototype.o=function(o){var c=this.g;if(typeof o=="string"){var l={};l.__data__=o,o=l}else this.u&&(l={},l.__data__=Wo(o),o=l);c.i.push(new Wm(c.Ya++,o)),c.G==3&&ns(c)},qe.prototype.N=function(){this.g.l=null,delete this.j,ia(this.g),delete this.g,qe.aa.N.call(this)};function dd(o){Ko.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var c=o.__sm__;if(c){e:{for(let l in c){o=l;break e}o=void 0}(this.i=o)&&(o=this.i,c=c!==null&&o in c?c[o]:void 0),this.data=c}else this.data=o}k(dd,Ko);function fd(){Qo.call(this),this.status=1}k(fd,Qo);function Vn(o){this.g=o}k(Vn,hd),Vn.prototype.ua=function(){Ne(this.g,"a")},Vn.prototype.ta=function(o){Ne(this.g,new dd(o))},Vn.prototype.sa=function(o){Ne(this.g,new fd)},Vn.prototype.ra=function(){Ne(this.g,"b")},is.prototype.createWebChannel=is.prototype.g,qe.prototype.send=qe.prototype.o,qe.prototype.open=qe.prototype.m,qe.prototype.close=qe.prototype.close,Au=St.createWebChannelTransport=function(){return new is},Tu=St.getStatEventTarget=function(){return Wi()},Eu=St.Event=tn,to=St.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Hi.NO_ERROR=0,Hi.TIMEOUT=8,Hi.HTTP_ERROR=6,Ei=St.ErrorCode=Hi,Ph.COMPLETE="complete",wu=St.EventType=Ph,Ah.EventType=Dr,Dr.OPEN="a",Dr.CLOSE="b",Dr.ERROR="c",Dr.MESSAGE="d",be.prototype.listen=be.prototype.K,rr=St.WebChannel=Ah,Iu=St.FetchXmlHttpFactory=Ur,ie.prototype.listenOnce=ie.prototype.L,ie.prototype.getLastError=ie.prototype.Ka,ie.prototype.getLastErrorCode=ie.prototype.Ba,ie.prototype.getStatus=ie.prototype.Z,ie.prototype.getResponseJson=ie.prototype.Oa,ie.prototype.getResponseText=ie.prototype.oa,ie.prototype.send=ie.prototype.ea,ie.prototype.setWithCredentials=ie.prototype.Ha,vu=St.XhrIo=ie}).apply(typeof eo<"u"?eo:typeof self<"u"?self:typeof window<"u"?window:{});var Qp="@firebase/firestore";var ge=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ge.UNAUTHENTICATED=new ge(null),ge.GOOGLE_CREDENTIALS=new ge("google-credentials-uid"),ge.FIRST_PARTY=new ge("first-party-uid"),ge.MOCK_USER=new ge("mock-user");var Ir="10.12.1";var Cn=new qt("@firebase/firestore");function Ti(){return Cn.logLevel}function O(n,...e){if(Cn.logLevel<=G.DEBUG){let t=e.map(Wl);Cn.debug(`Firestore (${Ir}): ${n}`,...t)}}function Pn(n,...e){if(Cn.logLevel<=G.ERROR){let t=e.map(Wl);Cn.error(`Firestore (${Ir}): ${n}`,...t)}}function ao(n,...e){if(Cn.logLevel<=G.WARN){let t=e.map(Wl);Cn.warn(`Firestore (${Ir}): ${n}`,...t)}}function Wl(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function W(n="Unexpected state"){let e=`FIRESTORE (${Ir}) INTERNAL ASSERTION FAILED: `+n;throw Pn(e),new Error(e)}function ye(n,e){n||W()}function te(n,e){return n}var C={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},V=class extends Le{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Rt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var co=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Cu=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ge.UNAUTHENTICATED))}shutdown(){}},Pu=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Du=class{constructor(e){this.t=e,this.currentUser=ge.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve(),s=new Rt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Rt,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let h=s;e.enqueueRetryable(()=>y(this,null,function*(){yield h.promise,yield i(this.currentUser)}))},u=h=>{O("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){let h=this.t.getImmediate({optional:!0});h?u(h):(O("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Rt)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(O("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ye(typeof r.accessToken=="string"),new co(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return ye(e===null||typeof e=="string"),new ge(e)}},ku=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=ge.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Nu=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new ku(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(ge.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Ou=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},xu=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=s=>{s.error!=null&&O("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.R;return this.R=s.token,O("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{O("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):O("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ye(typeof t.token=="string"),this.R=t.token,new Ou(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function cT(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var uo=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=cT(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function X(n,e){return n<e?-1:n>e?1:0}function ar(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var De=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new V(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new V(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new V(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new V(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?X(this.nanoseconds,e.nanoseconds):X(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var se=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new De(0,0))}static max(){return new n(new De(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var lo=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&W(),r===void 0?r=e.length-t:r>e.length-t&&W(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),a=t.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},me=class n extends lo{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new V(C.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},uT=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ze=class n extends lo{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return uT.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new V(C.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new V(C.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new V(C.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(s(),i++)}if(s(),a)throw new V(C.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var $=class n{constructor(e){this.path=e}static fromPath(e){return new n(me.fromString(e))}static fromName(e){return new n(me.fromString(e).popFirst(5))}static empty(){return new n(me.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&me.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return me.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new me(e.slice()))}};var Mu=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Mu.UNKNOWN_ID=-1;function lT(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=se.fromTimestamp(r===1e9?new De(t+1,0):new De(t,r));return new Dn(i,$.empty(),e)}function hT(n){return new Dn(n.readTime,n.key,-1)}var Dn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(se.min(),$.empty(),-1)}static max(){return new n(se.max(),$.empty(),-1)}};function dT(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=$.comparator(n.documentKey,e.documentKey),t!==0?t:X(n.largestBatchId,e.largestBatchId))}var fT="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Lu=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function pg(n){return y(this,null,function*(){if(n.code!==C.FAILED_PRECONDITION||n.message!==fT)throw n;O("LocalStore","Unexpectedly lost primary lease")})}var P=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&W(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++s,a&&s===i&&t()},h=>r(h))}),a=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,a=new Array(s),u=0;for(let h=0;h<s;h++){let d=h;t(e[d]).next(p=>{a[d]=p,++u,u===s&&r(a)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function pT(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Po(n){return n.name==="IndexedDbTransactionError"}var gT=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Hl(n){return n==null}function Pi(n){return n===0&&1/n==-1/0}function mT(n){return typeof n=="number"&&Number.isInteger(n)&&!Pi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var _T=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],B0=[..._T,"documentOverlays"],yT=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],vT=yT,q0=[...vT,"indexConfiguration","indexState","indexEntries"];function Jp(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Mi(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function gg(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Ge=class n{constructor(e,t){this.comparator=e,this.root=t||dt.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,dt.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,dt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new sr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new sr(this.root,e,this.comparator,!1)}getReverseIterator(){return new sr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new sr(this.root,e,this.comparator,!0)}},sr=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},dt=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw W();let e=this.left.check();if(e!==this.right.check())throw W();return e+(this.isRed()?0:1)}};dt.EMPTY=null,dt.RED=!0,dt.BLACK=!1;dt.EMPTY=new class{constructor(){this.size=0}get key(){throw W()}get value(){throw W()}get color(){throw W()}get left(){throw W()}get right(){throw W()}copy(e,t,r,i,s){return this}insert(e,t,r){return new dt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ve=class n{constructor(e){this.comparator=e,this.data=new Ge(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ho(this.data.getIterator())}getIteratorFrom(e){return new ho(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},ho=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var ht=class n{constructor(e){this.fields=e,e.sort(ze.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ve(ze.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ar(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Vu=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Jt=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Vu("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return X(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Jt.EMPTY_BYTE_STRING=new Jt("");var IT=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Yt(n){if(ye(!!n),typeof n=="string"){let e=0,t=IT.exec(n);if(ye(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:he(n.seconds),nanos:he(n.nanos)}}function he(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function cr(n){return typeof n=="string"?Jt.fromBase64String(n):Jt.fromUint8Array(n)}function Kl(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function mg(n){let e=n.mapValue.fields.__previous_value__;return Kl(e)?mg(e):e}function fo(n){let e=Yt(n.mapValue.fields.__local_write_time__.timestampValue);return new De(e.seconds,e.nanos)}var Uu=class{constructor(e,t,r,i,s,a,u,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=d}},Fu=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var no={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function ur(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Kl(n)?4:_g(n)?9007199254740991:10:W()}function ft(n,e){if(n===e)return!0;let t=ur(n);if(t!==ur(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return fo(n).isEqual(fo(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let a=Yt(i.timestampValue),u=Yt(s.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return cr(i.bytesValue).isEqual(cr(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return he(i.geoPointValue.latitude)===he(s.geoPointValue.latitude)&&he(i.geoPointValue.longitude)===he(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return he(i.integerValue)===he(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let a=he(i.doubleValue),u=he(s.doubleValue);return a===u?Pi(a)===Pi(u):isNaN(a)&&isNaN(u)}return!1}(n,e);case 9:return ar(n.arrayValue.values||[],e.arrayValue.values||[],ft);case 10:return function(i,s){let a=i.mapValue.fields||{},u=s.mapValue.fields||{};if(Jp(a)!==Jp(u))return!1;for(let h in a)if(a.hasOwnProperty(h)&&(u[h]===void 0||!ft(a[h],u[h])))return!1;return!0}(n,e);default:return W()}}function Di(n,e){return(n.values||[]).find(t=>ft(t,e))!==void 0}function lr(n,e){if(n===e)return 0;let t=ur(n),r=ur(e);if(t!==r)return X(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return X(n.booleanValue,e.booleanValue);case 2:return function(s,a){let u=he(s.integerValue||s.doubleValue),h=he(a.integerValue||a.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1}(n,e);case 3:return Yp(n.timestampValue,e.timestampValue);case 4:return Yp(fo(n),fo(e));case 5:return X(n.stringValue,e.stringValue);case 6:return function(s,a){let u=cr(s),h=cr(a);return u.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){let u=s.split("/"),h=a.split("/");for(let d=0;d<u.length&&d<h.length;d++){let p=X(u[d],h[d]);if(p!==0)return p}return X(u.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){let u=X(he(s.latitude),he(a.latitude));return u!==0?u:X(he(s.longitude),he(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,a){let u=s.values||[],h=a.values||[];for(let d=0;d<u.length&&d<h.length;++d){let p=lr(u[d],h[d]);if(p)return p}return X(u.length,h.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,a){if(s===no.mapValue&&a===no.mapValue)return 0;if(s===no.mapValue)return 1;if(a===no.mapValue)return-1;let u=s.fields||{},h=Object.keys(u),d=a.fields||{},p=Object.keys(d);h.sort(),p.sort();for(let E=0;E<h.length&&E<p.length;++E){let b=X(h[E],p[E]);if(b!==0)return b;let R=lr(u[h[E]],d[p[E]]);if(R!==0)return R}return X(h.length,p.length)}(n.mapValue,e.mapValue);default:throw W()}}function Yp(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return X(n,e);let t=Yt(n),r=Yt(e),i=X(t.seconds,r.seconds);return i!==0?i:X(t.nanos,r.nanos)}function hr(n){return Bu(n)}function Bu(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Yt(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return cr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return $.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=Bu(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let a of r)s?s=!1:i+=",",i+=`${a}:${Bu(t.fields[a])}`;return i+"}"}(n.mapValue):W()}function qu(n){return!!n&&"integerValue"in n}function Ql(n){return!!n&&"arrayValue"in n}function so(n){return!!n&&"mapValue"in n}function bi(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Mi(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=bi(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=bi(n.arrayValue.values[t]);return e}return Object.assign({},n)}function _g(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var lt=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!so(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=bi(t)}setAll(e){let t=ze.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!t.isImmediateParentOf(u)){let h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=u.popLast()}a?r[u.lastSegment()]=bi(a):i.push(u.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());so(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ft(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];so(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Mi(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(bi(this.value))}};function yg(n){let e=[];return Mi(n.fields,(t,r)=>{let i=new ze([t]);if(so(r)){let s=yg(r.mapValue).fields;if(s.length===0)e.push(i);else for(let a of s)e.push(i.child(a))}else e.push(i)}),new ht(e)}var dr=class n{constructor(e,t,r,i,s,a,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=u}static newInvalidDocument(e){return new n(e,0,se.min(),se.min(),se.min(),lt.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,se.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,se.min(),se.min(),lt.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,se.min(),se.min(),lt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(se.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=lt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=lt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=se.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var fr=class{constructor(e,t){this.position=e,this.inclusive=t}};function Xp(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],a=n.position[i];if(s.field.isKeyField()?r=$.comparator($.fromName(a.referenceValue),t.key):r=lr(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Zp(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ft(n.position[t],e.position[t]))return!1;return!0}var pr=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function wT(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var po=class{},_e=class n extends po{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new ju(e,t,r):t==="array-contains"?new Wu(e,r):t==="in"?new Hu(e,r):t==="not-in"?new Ku(e,r):t==="array-contains-any"?new Qu(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new zu(e,r):new Gu(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(lr(t,this.value)):t!==null&&ur(this.value)===ur(t)&&this.matchesComparison(lr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return W()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Xt=class n extends po{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return vg(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function vg(n){return n.op==="and"}function Ig(n){return ET(n)&&vg(n)}function ET(n){for(let e of n.filters)if(e instanceof Xt)return!1;return!0}function $u(n){if(n instanceof _e)return n.field.canonicalString()+n.op.toString()+hr(n.value);if(Ig(n))return n.filters.map(e=>$u(e)).join(",");{let e=n.filters.map(t=>$u(t)).join(",");return`${n.op}(${e})`}}function wg(n,e){return n instanceof _e?function(r,i){return i instanceof _e&&r.op===i.op&&r.field.isEqual(i.field)&&ft(r.value,i.value)}(n,e):n instanceof Xt?function(r,i){return i instanceof Xt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,u)=>s&&wg(a,i.filters[u]),!0):!1}(n,e):void W()}function Eg(n){return n instanceof _e?function(t){return`${t.field.canonicalString()} ${t.op} ${hr(t.value)}`}(n):n instanceof Xt?function(t){return t.op.toString()+" {"+t.getFilters().map(Eg).join(" ,")+"}"}(n):"Filter"}var ju=class extends _e{constructor(e,t,r){super(e,t,r),this.key=$.fromName(r.referenceValue)}matches(e){let t=$.comparator(e.key,this.key);return this.matchesComparison(t)}},zu=class extends _e{constructor(e,t){super(e,"in",t),this.keys=Tg("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Gu=class extends _e{constructor(e,t){super(e,"not-in",t),this.keys=Tg("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Tg(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>$.fromName(r.referenceValue))}var Wu=class extends _e{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Ql(t)&&Di(t.arrayValue,this.value)}},Hu=class extends _e{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Di(this.value.arrayValue,t)}},Ku=class extends _e{constructor(e,t){super(e,"not-in",t)}matches(e){if(Di(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Di(this.value.arrayValue,t)}},Qu=class extends _e{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Ql(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Di(this.value.arrayValue,r))}};var Ju=class{constructor(e,t=null,r=[],i=[],s=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=u,this.ue=null}};function eg(n,e=null,t=[],r=[],i=null,s=null,a=null){return new Ju(n,e,t,r,i,s,a)}function Jl(n){let e=te(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>$u(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Hl(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>hr(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>hr(r)).join(",")),e.ue=t}return e.ue}function Yl(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!wT(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!wg(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Zp(n.startAt,e.startAt)&&Zp(n.endAt,e.endAt)}var gr=class{constructor(e,t=null,r=[],i=[],s=null,a="F",u=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=u,this.endAt=h,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function TT(n,e,t,r,i,s,a,u){return new gr(n,e,t,r,i,s,a,u)}function AT(n){return new gr(n)}function tg(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function bT(n){return n.collectionGroup!==null}function Si(n){let e=te(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new Ve(ze.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new pr(s,r))}),t.has(ze.keyField().canonicalString())||e.ce.push(new pr(ze.keyField(),r))}return e.ce}function Sn(n){let e=te(n);return e.le||(e.le=ST(e,Si(n))),e.le}function ST(n,e){if(n.limitType==="F")return eg(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new pr(i.field,s)});let t=n.endAt?new fr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new fr(n.startAt.position,n.startAt.inclusive):null;return eg(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Yu(n,e,t){return new gr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Ag(n,e){return Yl(Sn(n),Sn(e))&&n.limitType===e.limitType}function bg(n){return`${Jl(Sn(n))}|lt:${n.limitType}`}function Ai(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>Eg(i)).join(", ")}]`),Hl(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>hr(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>hr(i)).join(",")),`Target(${r})`}(Sn(n))}; limitType=${n.limitType})`}function Xl(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):$.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of Si(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,u,h){let d=Xp(a,u,h);return a.inclusive?d<=0:d<0}(r.startAt,Si(r),i)||r.endAt&&!function(a,u,h){let d=Xp(a,u,h);return a.inclusive?d>=0:d>0}(r.endAt,Si(r),i))}(n,e)}function RT(n){return(e,t)=>{let r=!1;for(let i of Si(n)){let s=CT(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function CT(n,e,t){let r=n.field.isKeyField()?$.comparator(e.key,t.key):function(s,a,u){let h=a.data.field(s),d=u.data.field(s);return h!==null&&d!==null?lr(h,d):W()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return W()}}var Zt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Mi(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return gg(this.inner)}size(){return this.innerSize}};var PT=new Ge($.comparator);function go(){return PT}var Sg=new Ge($.comparator);function ro(...n){let e=Sg;for(let t of n)e=e.insert(t.key,t);return e}function Rg(n){let e=Sg;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function bn(){return Ri()}function Cg(){return Ri()}function Ri(){return new Zt(n=>n.toString(),(n,e)=>n.isEqual(e))}var DT=new Ge($.comparator),kT=new Ve($.comparator);function Pe(...n){let e=kT;for(let t of n)e=e.add(t);return e}var NT=new Ve(X);function OT(){return NT}function Pg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Pi(e)?"-0":e}}function Dg(n){return{integerValue:""+n}}function xT(n,e){return mT(e)?Dg(e):Pg(n,e)}var mr=class{constructor(){this._=void 0}};function MT(n,e,t){return n instanceof _r?function(i,s){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Kl(s)&&(s=mg(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):n instanceof kn?Ng(n,e):n instanceof Nn?Og(n,e):function(i,s){let a=kg(i,s),u=ng(a)+ng(i.Pe);return qu(a)&&qu(i.Pe)?Dg(u):Pg(i.serializer,u)}(n,e)}function LT(n,e,t){return n instanceof kn?Ng(n,e):n instanceof Nn?Og(n,e):t}function kg(n,e){return n instanceof yr?function(r){return qu(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var _r=class extends mr{},kn=class extends mr{constructor(e){super(),this.elements=e}};function Ng(n,e){let t=xg(e);for(let r of n.elements)t.some(i=>ft(i,r))||t.push(r);return{arrayValue:{values:t}}}var Nn=class extends mr{constructor(e){super(),this.elements=e}};function Og(n,e){let t=xg(e);for(let r of n.elements)t=t.filter(i=>!ft(i,r));return{arrayValue:{values:t}}}var yr=class extends mr{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function ng(n){return he(n.integerValue||n.doubleValue)}function xg(n){return Ql(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function VT(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof kn&&i instanceof kn||r instanceof Nn&&i instanceof Nn?ar(r.elements,i.elements,ft):r instanceof yr&&i instanceof yr?ft(r.Pe,i.Pe):r instanceof _r&&i instanceof _r}(n.transform,e.transform)}var Xu=class{constructor(e,t){this.version=e,this.transformResults=t}},Rn=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function oo(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var vr=class{};function Mg(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new mo(n.key,Rn.none()):new On(n.key,n.data,Rn.none());{let t=n.data,r=lt.empty(),i=new Ve(ze.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new Pt(n.key,r,new ht(i.toArray()),Rn.none())}}function UT(n,e,t){n instanceof On?function(i,s,a){let u=i.value.clone(),h=ig(i.fieldTransforms,s,a.transformResults);u.setAll(h),s.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(n,e,t):n instanceof Pt?function(i,s,a){if(!oo(i.precondition,s))return void s.convertToUnknownDocument(a.version);let u=ig(i.fieldTransforms,s,a.transformResults),h=s.data;h.setAll(Lg(i)),h.setAll(u),s.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function Ci(n,e,t,r){return n instanceof On?function(s,a,u,h){if(!oo(s.precondition,a))return u;let d=s.value.clone(),p=sg(s.fieldTransforms,h,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof Pt?function(s,a,u,h){if(!oo(s.precondition,a))return u;let d=sg(s.fieldTransforms,h,a),p=a.data;return p.setAll(Lg(s)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(E=>E.field))}(n,e,t,r):function(s,a,u){return oo(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(n,e,t)}function FT(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=kg(r.transform,i||null);s!=null&&(t===null&&(t=lt.empty()),t.set(r.field,s))}return t||null}function rg(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ar(r,i,(s,a)=>VT(s,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var On=class extends vr{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Pt=class extends vr{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function Lg(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function ig(n,e,t){let r=new Map;ye(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],a=s.transform,u=e.data.field(s.field);r.set(s.field,LT(a,u,t[i]))}return r}function sg(n,e,t){let r=new Map;for(let i of n){let s=i.transform,a=t.data.field(i.field);r.set(i.field,MT(s,a,e))}return r}var mo=class extends vr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Zu=class extends vr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var el=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&UT(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Ci(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Ci(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=Cg();return this.mutations.forEach(i=>{let s=e.get(i.key),a=s.overlayedDocument,u=this.applyToLocalView(a,s.mutatedFields);u=t.has(i.key)?null:u;let h=Mg(a,u);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(se.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Pe())}isEqual(e){return this.batchId===e.batchId&&ar(this.mutations,e.mutations,(t,r)=>rg(t,r))&&ar(this.baseMutations,e.baseMutations,(t,r)=>rg(t,r))}},tl=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ye(e.mutations.length===r.length);let i=function(){return DT}(),s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new n(e,t,r,i)}};var nl=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var ae,K;function BT(n){switch(n){default:return W();case C.CANCELLED:case C.UNKNOWN:case C.DEADLINE_EXCEEDED:case C.RESOURCE_EXHAUSTED:case C.INTERNAL:case C.UNAVAILABLE:case C.UNAUTHENTICATED:return!1;case C.INVALID_ARGUMENT:case C.NOT_FOUND:case C.ALREADY_EXISTS:case C.PERMISSION_DENIED:case C.FAILED_PRECONDITION:case C.ABORTED:case C.OUT_OF_RANGE:case C.UNIMPLEMENTED:case C.DATA_LOSS:return!0}}function qT(n){if(n===void 0)return Pn("GRPC error has no .code"),C.UNKNOWN;switch(n){case ae.OK:return C.OK;case ae.CANCELLED:return C.CANCELLED;case ae.UNKNOWN:return C.UNKNOWN;case ae.DEADLINE_EXCEEDED:return C.DEADLINE_EXCEEDED;case ae.RESOURCE_EXHAUSTED:return C.RESOURCE_EXHAUSTED;case ae.INTERNAL:return C.INTERNAL;case ae.UNAVAILABLE:return C.UNAVAILABLE;case ae.UNAUTHENTICATED:return C.UNAUTHENTICATED;case ae.INVALID_ARGUMENT:return C.INVALID_ARGUMENT;case ae.NOT_FOUND:return C.NOT_FOUND;case ae.ALREADY_EXISTS:return C.ALREADY_EXISTS;case ae.PERMISSION_DENIED:return C.PERMISSION_DENIED;case ae.FAILED_PRECONDITION:return C.FAILED_PRECONDITION;case ae.ABORTED:return C.ABORTED;case ae.OUT_OF_RANGE:return C.OUT_OF_RANGE;case ae.UNIMPLEMENTED:return C.UNIMPLEMENTED;case ae.DATA_LOSS:return C.DATA_LOSS;default:return W()}}(K=ae||(ae={}))[K.OK=0]="OK",K[K.CANCELLED=1]="CANCELLED",K[K.UNKNOWN=2]="UNKNOWN",K[K.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",K[K.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",K[K.NOT_FOUND=5]="NOT_FOUND",K[K.ALREADY_EXISTS=6]="ALREADY_EXISTS",K[K.PERMISSION_DENIED=7]="PERMISSION_DENIED",K[K.UNAUTHENTICATED=16]="UNAUTHENTICATED",K[K.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",K[K.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",K[K.ABORTED=10]="ABORTED",K[K.OUT_OF_RANGE=11]="OUT_OF_RANGE",K[K.UNIMPLEMENTED=12]="UNIMPLEMENTED",K[K.INTERNAL=13]="INTERNAL",K[K.UNAVAILABLE=14]="UNAVAILABLE",K[K.DATA_LOSS=15]="DATA_LOSS";var j0=new yu([4294967295,4294967295],0);var rl=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function il(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function $T(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function jT(n,e){return il(n,e.toTimestamp())}function or(n){return ye(!!n),se.fromTimestamp(function(t){let r=Yt(t);return new De(r.seconds,r.nanos)}(n))}function Vg(n,e){return sl(n,e).canonicalString()}function sl(n,e){let t=function(i){return new me(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function zT(n){let e=me.fromString(n);return ye(XT(e)),e}function ol(n,e){return Vg(n.databaseId,e.path)}function GT(n){let e=zT(n);return e.length===4?me.emptyPath():HT(e)}function WT(n){return new me(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function HT(n){return ye(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function og(n,e,t){return{name:ol(n,e),fields:t.value.mapValue.fields}}function KT(n,e){let t;if(e instanceof On)t={update:og(n,e.key,e.value)};else if(e instanceof mo)t={delete:ol(n,e.key)};else if(e instanceof Pt)t={update:og(n,e.key,e.data),updateMask:YT(e.fieldMask)};else{if(!(e instanceof Zu))return W();t={verify:ol(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,a){let u=a.transform;if(u instanceof _r)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof kn)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Nn)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof yr)return{fieldPath:a.field.canonicalString(),increment:u.Pe};throw W()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:jT(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:W()}(n,e.precondition)),t}function QT(n,e){return n&&n.length>0?(ye(e!==void 0),n.map(t=>function(i,s){let a=i.updateTime?or(i.updateTime):or(s);return a.isEqual(se.min())&&(a=or(s)),new Xu(a,i.transformResults||[])}(t,e))):[]}function JT(n){let e=GT(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){ye(r===1);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=function(E){let b=Ug(E);return b instanceof Xt&&Ig(b)?b.getFilters():[b]}(t.where));let a=[];t.orderBy&&(a=function(E){return E.map(b=>function(k){return new pr(ir(k.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(k.direction))}(b))}(t.orderBy));let u=null;t.limit&&(u=function(E){let b;return b=typeof E=="object"?E.value:E,Hl(b)?null:b}(t.limit));let h=null;t.startAt&&(h=function(E){let b=!!E.before,R=E.values||[];return new fr(R,b)}(t.startAt));let d=null;return t.endAt&&(d=function(E){let b=!E.before,R=E.values||[];return new fr(R,b)}(t.endAt)),TT(e,i,a,s,u,"F",h,d)}function Ug(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=ir(t.unaryFilter.field);return _e.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=ir(t.unaryFilter.field);return _e.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=ir(t.unaryFilter.field);return _e.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=ir(t.unaryFilter.field);return _e.create(a,"!=",{nullValue:"NULL_VALUE"});default:return W()}}(n):n.fieldFilter!==void 0?function(t){return _e.create(ir(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return W()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Xt.create(t.compositeFilter.filters.map(r=>Ug(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return W()}}(t.compositeFilter.op))}(n):W()}function ir(n){return ze.fromServerFormat(n.fieldPath)}function YT(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function XT(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var al=class{constructor(e){this.ct=e}};function ZT(n){let e=JT({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Yu(e,e.limit,"L"):e}var _o=class{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(he(e.integerValue));else if("doubleValue"in e){let r=he(e.doubleValue);isNaN(r)?this.Et(t,13):(this.Et(t,15),Pi(r)?t.dt(0):t.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(t,20),typeof r=="string"&&(r=Yt(r)),t.At(`${r.seconds||""}`),t.dt(r.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(cr(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(t,45),t.dt(r.latitude||0),t.dt(r.longitude||0)}else"mapValue"in e?_g(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):W()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){let r=e.fields||{};this.Et(t,55);for(let i of Object.keys(r))this.Rt(i,t),this.It(r[i],t)}wt(e,t){let r=e.values||[];this.Et(t,50);for(let i of r)this.It(i,t)}gt(e,t){this.Et(t,37),$.fromName(e).path.forEach(r=>{this.Et(t,60),this.St(r,t)})}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}};_o.bt=new _o;var cl=class{constructor(){this._n=new ul}addToCollectionParentIndex(e,t){return this._n.add(t),P.resolve()}getCollectionParents(e,t){return P.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return P.resolve()}deleteFieldIndex(e,t){return P.resolve()}deleteAllFieldIndexes(e){return P.resolve()}createTargetIndexes(e,t){return P.resolve()}getDocumentsMatchingTarget(e,t){return P.resolve(null)}getIndexType(e,t){return P.resolve(0)}getFieldIndexes(e,t){return P.resolve([])}getNextCollectionGroupToUpdate(e){return P.resolve(null)}getMinOffset(e,t){return P.resolve(Dn.min())}getMinOffsetFromCollectionGroup(e,t){return P.resolve(Dn.min())}updateCollectionGroup(e,t,r){return P.resolve()}updateIndexEntries(e,t){return P.resolve()}},ul=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ve(me.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ve(me.comparator)).toArray()}};var z0=new Uint8Array(0);var ut=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};ut.DEFAULT_COLLECTION_PERCENTILE=10,ut.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ut.DEFAULT=new ut(41943040,ut.DEFAULT_COLLECTION_PERCENTILE,ut.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ut.DISABLED=new ut(-1,0,0);var ki=class n{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new n(0)}static Ln(){return new n(-1)}};var ll=class{constructor(){this.changes=new Zt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,dr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?P.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var hl=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var dl=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Ci(r.mutation,i,ht.empty(),De.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Pe()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Pe()){let i=bn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=ro();return s.forEach((u,h)=>{a=a.insert(u,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=bn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Pe()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,u)=>{t.set(a,u)})})}computeViews(e,t,r,i){let s=go(),a=Ri(),u=function(){return Ri()}();return t.forEach((h,d)=>{let p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof Pt)?s=s.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),Ci(p.mutation,d,p.mutation.getFieldMask(),De.now())):a.set(d.key,ht.empty())}),this.recalculateAndSaveOverlays(e,s).next(h=>(h.forEach((d,p)=>a.set(d,p)),t.forEach((d,p)=>{var E;return u.set(d,new hl(p,(E=a.get(d))!==null&&E!==void 0?E:null))}),u))}recalculateAndSaveOverlays(e,t){let r=Ri(),i=new Ge((a,u)=>a-u),s=Pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let u of a)u.keys().forEach(h=>{let d=t.get(h);if(d===null)return;let p=r.get(h)||ht.empty();p=u.applyToLocalView(d,p),r.set(h,p);let E=(i.get(u.batchId)||Pe()).add(h);i=i.insert(u.batchId,E)})}).next(()=>{let a=[],u=i.getReverseIterator();for(;u.hasNext();){let h=u.getNext(),d=h.key,p=h.value,E=Cg();p.forEach(b=>{if(!s.has(b)){let R=Mg(t.get(b),r.get(b));R!==null&&E.set(b,R),s=s.add(b)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,E))}return P.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return $.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):bT(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):P.resolve(bn()),u=-1,h=s;return a.next(d=>P.forEach(d,(p,E)=>(u<E.largestBatchId&&(u=E.largestBatchId),s.get(p)?P.resolve():this.remoteDocumentCache.getEntry(e,p).next(b=>{h=h.insert(p,b)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,h,d,Pe())).next(p=>({batchId:u,changes:Rg(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new $(t)).next(r=>{let i=ro();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,a=ro();return this.indexManager.getCollectionParents(e,s).next(u=>P.forEach(u,h=>{let d=function(E,b){return new gr(b,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)}(t,h.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((E,b)=>{a=a.insert(E,b)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((h,d)=>{let p=d.getKey();a.get(p)===null&&(a=a.insert(p,dr.newInvalidDocument(p)))});let u=ro();return a.forEach((h,d)=>{let p=s.get(h);p!==void 0&&Ci(p.mutation,d,ht.empty(),De.now()),Xl(t,d)&&(u=u.insert(h,d))}),u})}};var fl=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return P.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:or(i.createTime)}}(t)),P.resolve()}getNamedQuery(e,t){return P.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(i){return{name:i.name,query:ZT(i.bundledQuery),readTime:or(i.readTime)}}(t)),P.resolve()}};var pl=class{constructor(){this.overlays=new Ge($.comparator),this.hr=new Map}getOverlay(e,t){return P.resolve(this.overlays.get(t))}getOverlays(e,t){let r=bn();return P.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),P.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),P.resolve()}getOverlaysForCollection(e,t,r){let i=bn(),s=t.length+1,a=new $(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){let h=u.getNext().value,d=h.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&h.largestBatchId>r&&i.set(h.getKey(),h)}return P.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Ge((d,p)=>d-p),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=s.get(d.largestBatchId);p===null&&(p=bn(),s=s.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}let u=bn(),h=s.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((d,p)=>u.set(d,p)),!(u.size()>=i)););return P.resolve(u)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new nl(t,r));let s=this.hr.get(t);s===void 0&&(s=Pe(),this.hr.set(t,s)),this.hr.set(t,s.add(r.key))}};var Ni=class{constructor(){this.Pr=new Ve(ce.Ir),this.Tr=new Ve(ce.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){let r=new ce(e,t);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Ar(new ce(e,t))}Rr(e,t){e.forEach(r=>this.removeReference(r,t))}Vr(e){let t=new $(new me([])),r=new ce(t,e),i=new ce(t,e+1),s=[];return this.Tr.forEachInRange([r,i],a=>{this.Ar(a),s.push(a.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let t=new $(new me([])),r=new ce(t,e),i=new ce(t,e+1),s=Pe();return this.Tr.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){let t=new ce(e,0),r=this.Pr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},ce=class{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return $.comparator(e.key,t.key)||X(e.pr,t.pr)}static Er(e,t){return X(e.pr,t.pr)||$.comparator(e.key,t.key)}};var gl=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new Ve(ce.Ir)}checkEmpty(e){return P.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new el(s,t,r,i);this.mutationQueue.push(a);for(let u of i)this.wr=this.wr.add(new ce(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return P.resolve(a)}lookupMutationBatch(e,t){return P.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.br(r),s=i<0?0:i;return P.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return P.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return P.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new ce(t,0),i=new ce(t,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],a=>{let u=this.Sr(a.pr);s.push(u)}),P.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ve(X);return t.forEach(i=>{let s=new ce(i,0),a=new ce(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,a],u=>{r=r.add(u.pr)})}),P.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;$.isDocumentKey(s)||(s=s.child(""));let a=new ce(new $(s),0),u=new Ve(X);return this.wr.forEachWhile(h=>{let d=h.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(h.pr)),!0)},a),P.resolve(this.Dr(u))}Dr(e){let t=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ye(this.Cr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return P.forEach(t.mutations,i=>{let s=new ce(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,t){let r=new ce(t,0),i=this.wr.firstAfterOrEqual(r);return P.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,P.resolve()}Cr(e,t){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var ml=class{constructor(e){this.vr=e,this.docs=function(){return new Ge($.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.vr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return P.resolve(r?r.document.mutableCopy():dr.newInvalidDocument(t))}getEntries(e,t){let r=go();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():dr.newInvalidDocument(i))}),P.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=go(),a=t.path,u=new $(a.child("")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){let{key:d,value:{document:p}}=h.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||dT(hT(p),r)<=0||(i.has(p.key)||Xl(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return P.resolve(s)}getAllFromCollectionGroup(e,t,r,i){W()}Fr(e,t){return P.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new _l(this)}getSize(e){return P.resolve(this.size)}},_l=class extends ll{constructor(e){super(),this.ar=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),P.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}};var yl=class{constructor(e){this.persistence=e,this.Mr=new Zt(t=>Jl(t),Yl),this.lastRemoteSnapshotVersion=se.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Ni,this.targetCount=0,this.Lr=ki.Nn()}forEachTarget(e,t){return this.Mr.forEach((r,i)=>t(i)),P.resolve()}getLastRemoteSnapshotVersion(e){return P.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return P.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),P.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Or&&(this.Or=t),P.resolve()}qn(e){this.Mr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Lr=new ki(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,P.resolve()}updateTargetData(e,t){return this.qn(t),P.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,P.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Mr.forEach((a,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.Mr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),P.waitFor(s).next(()=>i)}getTargetCount(e){return P.resolve(this.targetCount)}getTargetData(e,t){let r=this.Mr.get(t)||null;return P.resolve(r)}addMatchingKeys(e,t,r){return this.Nr.dr(t,r),P.resolve()}removeMatchingKeys(e,t,r){this.Nr.Rr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),P.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),P.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Nr.gr(t);return P.resolve(r)}containsKey(e,t){return P.resolve(this.Nr.containsKey(t))}};var vl=class{constructor(e,t){this.Br={},this.overlays={},this.kr=new gT(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new yl(this),this.indexManager=new cl,this.remoteDocumentCache=function(i){return new ml(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new al(t),this.$r=new fl(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new pl,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new gl(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,r){O("MemoryPersistence","Starting transaction:",e);let i=new Il(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,t){return P.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}},Il=class extends Lu{constructor(e){super(),this.currentSequenceNumber=e}},wl=class n{constructor(e){this.persistence=e,this.zr=new Ni,this.jr=null}static Hr(e){return new n(e)}get Jr(){if(this.jr)return this.jr;throw W()}addReference(e,t,r){return this.zr.addReference(r,t),this.Jr.delete(r.toString()),P.resolve()}removeReference(e,t,r){return this.zr.removeReference(r,t),this.Jr.add(r.toString()),P.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),P.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ur(){this.jr=new Set}Wr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return P.forEach(this.Jr,r=>{let i=$.fromPath(r);return this.Yr(e,i).next(s=>{s||t.removeEntry(i,se.min())})}).next(()=>(this.jr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Yr(e,t).next(r=>{r?this.Jr.delete(t.toString()):this.Jr.add(t.toString())})}Kr(e){return 0}Yr(e,t){return P.or([()=>P.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}};var El=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.qi=r,this.Qi=i}static Ki(e,t){let r=Pe(),i=Pe();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var Tl=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Al=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return Nf()?8:pT(le())>0?6:4}()}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ji(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Hi(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new Tl;return this.Ji(e,t,a).next(u=>{if(s.result=u,this.Ui)return this.Yi(e,t,a,u.size)})}).next(()=>s.result)}Yi(e,t,r,i){return r.documentReadCount<this.Wi?(Ti()<=G.DEBUG&&O("QueryEngine","SDK will not create cache indexes for query:",Ai(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),P.resolve()):(Ti()<=G.DEBUG&&O("QueryEngine","Query:",Ai(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(Ti()<=G.DEBUG&&O("QueryEngine","The SDK decides to create cache indexes for query:",Ai(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Sn(t))):P.resolve())}ji(e,t){if(tg(t))return P.resolve(null);let r=Sn(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Yu(t,null,"F"),r=Sn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let a=Pe(...s);return this.zi.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(h=>{let d=this.Zi(t,u);return this.Xi(t,d,a,h.readTime)?this.ji(e,Yu(t,null,"F")):this.es(e,d,t,h)}))})))}Hi(e,t,r,i){return tg(t)||i.isEqual(se.min())?P.resolve(null):this.zi.getDocuments(e,r).next(s=>{let a=this.Zi(t,s);return this.Xi(t,a,r,i)?P.resolve(null):(Ti()<=G.DEBUG&&O("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ai(t)),this.es(e,a,t,lT(i,-1)).next(u=>u))})}Zi(e,t){let r=new Ve(RT(e));return t.forEach((i,s)=>{Xl(e,s)&&(r=r.add(s))}),r}Xi(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,t,r){return Ti()<=G.DEBUG&&O("QueryEngine","Using full collection scan to execute query:",Ai(t)),this.zi.getDocumentsMatchingQuery(e,t,Dn.min(),r)}es(e,t,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}};var bl=class{constructor(e,t,r,i){this.persistence=e,this.ts=t,this.serializer=i,this.ns=new Ge(X),this.rs=new Zt(s=>Jl(s),Yl),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new dl(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ns))}};function eA(n,e,t,r){return new bl(n,e,t,r)}function Fg(n,e){return y(this,null,function*(){let t=te(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t._s(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let a=[],u=[],h=Pe();for(let d of i){a.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}for(let d of s){u.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(r,h).next(d=>({us:d,removedBatchIds:a,addedBatchIds:u}))})})})}function tA(n,e){let t=te(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.os.newChangeBuffer({trackRemovals:!0});return function(u,h,d,p){let E=d.batch,b=E.keys(),R=P.resolve();return b.forEach(k=>{R=R.next(()=>p.getEntry(h,k)).next(x=>{let N=d.docVersions.get(k);ye(N!==null),x.version.compareTo(N)<0&&(E.applyToRemoteDocument(x,d),x.isValidDocument()&&(x.setReadTime(d.commitVersion),p.addEntry(x)))})}),R.next(()=>u.mutationQueue.removeMutationBatch(h,E))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let h=Pe();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(h=h.add(u.batch.mutations[d].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function nA(n){let e=te(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Qr.getLastRemoteSnapshotVersion(t))}function rA(n,e){let t=te(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}var yo=class{constructor(){this.activeTargetIds=OT()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Sl=class{constructor(){this.no=new yo,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,r){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new yo,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Rl=class{io(e){}shutdown(){}};var vo=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){O("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){O("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var io=null;function bu(){return io===null?io=function(){return 268435456+Math.round(2147483648*Math.random())}():io++,"0x"+io.toString(16)}var iA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Cl=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}};var Ce="WebChannelConnection",Pl=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.wo=r+"://"+t.host,this.So=`projects/${i}/databases/${s}`,this.bo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Do(){return!1}Co(t,r,i,s,a){let u=bu(),h=this.vo(t,r.toUriEncodedString());O("RestConnection",`Sending RPC '${t}' ${u}:`,h,i);let d={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(d,s,a),this.Mo(t,h,d,i).then(p=>(O("RestConnection",`Received RPC '${t}' ${u}: `,p),p),p=>{throw ao("RestConnection",`RPC '${t}' ${u} failed with error: `,p,"url: ",h,"request:",i),p})}xo(t,r,i,s,a,u){return this.Co(t,r,i,s,a)}Fo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ir}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>t[a]=s),i&&i.headers.forEach((s,a)=>t[a]=s)}vo(t,r){let i=iA[t];return`${this.wo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,t,r,i){let s=bu();return new Promise((a,u)=>{let h=new vu;h.setWithCredentials(!0),h.listenOnce(wu.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Ei.NO_ERROR:let p=h.getResponseJson();O(Ce,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),a(p);break;case Ei.TIMEOUT:O(Ce,`RPC '${e}' ${s} timed out`),u(new V(C.DEADLINE_EXCEEDED,"Request time out"));break;case Ei.HTTP_ERROR:let E=h.getStatus();if(O(Ce,`RPC '${e}' ${s} failed with status:`,E,"response text:",h.getResponseText()),E>0){let b=h.getResponseJson();Array.isArray(b)&&(b=b[0]);let R=b?.error;if(R&&R.status&&R.message){let k=function(N){let q=N.toLowerCase().replace(/_/g,"-");return Object.values(C).indexOf(q)>=0?q:C.UNKNOWN}(R.status);u(new V(k,R.message))}else u(new V(C.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new V(C.UNAVAILABLE,"Connection failed."));break;default:W()}}finally{O(Ce,`RPC '${e}' ${s} completed.`)}});let d=JSON.stringify(i);O(Ce,`RPC '${e}' ${s} sending request:`,i),h.send(t,"POST",d,r,15)})}Oo(e,t,r){let i=bu(),s=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Au(),u=Tu(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.xmlHttpFactory=new Iu({})),this.Fo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;let p=s.join("");O(Ce,`Creating RPC '${e}' stream ${i}: ${p}`,h);let E=a.createWebChannel(p,h),b=!1,R=!1,k=new Cl({lo:N=>{R?O(Ce,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(b||(O(Ce,`Opening RPC '${e}' stream ${i} transport.`),E.open(),b=!0),O(Ce,`RPC '${e}' stream ${i} sending:`,N),E.send(N))},ho:()=>E.close()}),x=(N,q,j)=>{N.listen(q,z=>{try{j(z)}catch(H){setTimeout(()=>{throw H},0)}})};return x(E,rr.EventType.OPEN,()=>{R||(O(Ce,`RPC '${e}' stream ${i} transport opened.`),k.mo())}),x(E,rr.EventType.CLOSE,()=>{R||(R=!0,O(Ce,`RPC '${e}' stream ${i} transport closed`),k.po())}),x(E,rr.EventType.ERROR,N=>{R||(R=!0,ao(Ce,`RPC '${e}' stream ${i} transport errored:`,N),k.po(new V(C.UNAVAILABLE,"The operation could not be completed")))}),x(E,rr.EventType.MESSAGE,N=>{var q;if(!R){let j=N.data[0];ye(!!j);let z=j,H=z.error||((q=z[0])===null||q===void 0?void 0:q.error);if(H){O(Ce,`RPC '${e}' stream ${i} received error:`,H);let ke=H.status,re=function(_){let v=ae[_];if(v!==void 0)return qT(v)}(ke),I=H.message;re===void 0&&(re=C.INTERNAL,I="Unknown error status: "+ke+" with message "+H.message),R=!0,k.po(new V(re,I)),E.close()}else O(Ce,`RPC '${e}' stream ${i} received:`,j),k.yo(j)}}),x(u,Eu.STAT_EVENT,N=>{N.stat===to.PROXY?O(Ce,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===to.NOPROXY&&O(Ce,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{k.fo()},0),k}};function Su(){return typeof document<"u"?document:null}function Do(n){return new rl(n,!0)}var Io=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=t,this.No=r,this.Lo=i,this.Bo=s,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();let t=Math.floor(this.ko+this.Uo()),r=Math.max(0,Date.now()-this.Qo),i=Math.max(0,t-r);i>0&&O("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}};var Dl=class{constructor(e,t,r,i,s,a,u,h){this.oi=e,this.Go=r,this.zo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new Io(e,t)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}stop(){return y(this,null,function*(){this.Zo()&&(yield this.close(0))})}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}r_(){return y(this,null,function*(){if(this.Xo())return this.close(0)})}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}close(e,t){return y(this,null,function*(){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,e!==4?this.Yo.reset():t&&t.code===C.RESOURCE_EXHAUSTED?(Pn(t.toString()),Pn("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):t&&t.code===C.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Ao(t)})}__(){}auth(){this.state=1;let e=this.a_(this.jo),t=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.jo===t&&this.u_(r,i)},r=>{e(()=>{let i=new V(C.UNKNOWN,"Fetching auth token failed: "+r.message);return this.c_(i)})})}u_(e,t){let r=this.a_(this.jo);this.stream=this.l_(e,t),this.stream.Po(()=>{r(()=>this.listener.Po())}),this.stream.To(()=>{r(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(i=>{r(()=>this.c_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}e_(){this.state=5,this.Yo.$o(()=>y(this,null,function*(){this.state=0,this.start()}))}c_(e){return O("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return t=>{this.oi.enqueueAndForget(()=>this.jo===e?t():(O("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}};var kl=class extends Dl{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,t){return this.connection.Oo("Write",e,t)}onMessage(e){if(ye(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();let t=QT(e.writeResults,e.commitTime),r=or(e.commitTime);return this.listener.A_(r,t)}return ye(!e.writeResults||e.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){let e={};e.database=WT(this.serializer),this.i_(e)}d_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>KT(this.serializer,r))};this.i_(t)}};var Nl=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.m_=!1}f_(){if(this.m_)throw new V(C.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,t,r,i){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Co(e,sl(t,r),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new V(C.UNKNOWN,s.toString())})}xo(e,t,r,i,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.xo(e,sl(t,r),i,a,u,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new V(C.UNKNOWN,a.toString())})}terminate(){this.m_=!0,this.connection.terminate()}},Ol=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(Pn(t),this.y_=!1):O("OnlineStateTracker",t)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}};var xl=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.io(a=>{r.enqueueAndForget(()=>y(this,null,function*(){Vi(this)&&(O("RemoteStore","Restarting streams for network reachability change."),yield function(h){return y(this,null,function*(){let d=te(h);d.M_.add(4),yield Li(d),d.N_.set("Unknown"),d.M_.delete(4),yield ko(d)})}(this))}))}),this.N_=new Ol(r,i)}};function ko(n){return y(this,null,function*(){if(Vi(n))for(let e of n.x_)yield e(!0)})}function Li(n){return y(this,null,function*(){for(let e of n.x_)yield e(!1)})}function Vi(n){return te(n).M_.size===0}function Bg(n,e,t){return y(this,null,function*(){if(!Po(e))throw e;n.M_.add(1),yield Li(n),n.N_.set("Offline"),t||(t=()=>nA(n.localStore)),n.asyncQueue.enqueueRetryable(()=>y(this,null,function*(){O("RemoteStore","Retrying IndexedDB access"),yield t(),n.M_.delete(1),yield ko(n)}))})}function qg(n,e){return e().catch(t=>Bg(n,t,e))}function No(n){return y(this,null,function*(){let e=te(n),t=en(e),r=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;sA(e);)try{let i=yield rA(e.localStore,r);if(i===null){e.v_.length===0&&t.n_();break}r=i.batchId,oA(e,i)}catch(i){yield Bg(e,i)}$g(e)&&jg(e)})}function sA(n){return Vi(n)&&n.v_.length<10}function oA(n,e){n.v_.push(e);let t=en(n);t.Xo()&&t.E_&&t.d_(e.mutations)}function $g(n){return Vi(n)&&!en(n).Zo()&&n.v_.length>0}function jg(n){en(n).start()}function aA(n){return y(this,null,function*(){en(n).V_()})}function cA(n){return y(this,null,function*(){let e=en(n);for(let t of n.v_)e.d_(t.mutations)})}function uA(n,e,t){return y(this,null,function*(){let r=n.v_.shift(),i=tl.from(r,e,t);yield qg(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield No(n)})}function lA(n,e){return y(this,null,function*(){e&&en(n).E_&&(yield function(r,i){return y(this,null,function*(){if(function(a){return BT(a)&&a!==C.ABORTED}(i.code)){let s=r.v_.shift();en(r).t_(),yield qg(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield No(r)}})}(n,e)),$g(n)&&jg(n)})}function ag(n,e){return y(this,null,function*(){let t=te(n);t.asyncQueue.verifyOperationInProgress(),O("RemoteStore","RemoteStore received new credentials");let r=Vi(t);t.M_.add(3),yield Li(t),r&&t.N_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.M_.delete(3),yield ko(t)})}function hA(n,e){return y(this,null,function*(){let t=te(n);e?(t.M_.delete(2),yield ko(t)):e||(t.M_.add(2),yield Li(t),t.N_.set("Unknown"))})}function en(n){return n.k_||(n.k_=function(t,r,i){let s=te(t);return s.f_(),new kl(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:()=>Promise.resolve(),To:aA.bind(null,n),Ao:lA.bind(null,n),R_:cA.bind(null,n),A_:uA.bind(null,n)}),n.x_.push(e=>y(this,null,function*(){e?(n.k_.t_(),yield No(n)):(yield n.k_.stop(),n.v_.length>0&&(O("RemoteStore",`Stopping write stream with ${n.v_.length} pending writes`),n.v_=[]))}))),n.k_}var Ml=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Rt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let a=Date.now()+r,u=new n(e,t,a,i,s);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new V(C.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function zg(n,e){if(Pn("AsyncQueue",`${e}: ${n}`),Po(n))return new V(C.UNAVAILABLE,`${e}: ${n}`);throw n}var Ll=class{constructor(){this.queries=new Zt(e=>bg(e),Ag),this.onlineState="Unknown",this.z_=new Set}};function dA(n){n.z_.forEach(e=>{e.next()})}var cg,ug;(ug=cg||(cg={})).J_="default",ug.Cache="cache";var Vl=class{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Sa={},this.ba=new Zt(u=>bg(u),Ag),this.Da=new Map,this.Ca=new Set,this.va=new Ge($.comparator),this.Fa=new Map,this.Ma=new Ni,this.xa={},this.Oa=new Map,this.Na=ki.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}};function fA(n,e,t){return y(this,null,function*(){let r=_A(n);try{let i=yield function(a,u){let h=te(a),d=De.now(),p=u.reduce((R,k)=>R.add(k.key),Pe()),E,b;return h.persistence.runTransaction("Locally write mutations","readwrite",R=>{let k=go(),x=Pe();return h.os.getEntries(R,p).next(N=>{k=N,k.forEach((q,j)=>{j.isValidDocument()||(x=x.add(q))})}).next(()=>h.localDocuments.getOverlayedDocuments(R,k)).next(N=>{E=N;let q=[];for(let j of u){let z=FT(j,E.get(j.key).overlayedDocument);z!=null&&q.push(new Pt(j.key,z,yg(z.value.mapValue),Rn.exists(!0)))}return h.mutationQueue.addMutationBatch(R,d,q,u)}).next(N=>{b=N;let q=N.applyToLocalDocumentSet(E,x);return h.documentOverlayCache.saveOverlays(R,N.batchId,q)})}).then(()=>({batchId:b.batchId,changes:Rg(E)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,u,h){let d=a.xa[a.currentUser.toKey()];d||(d=new Ge(X)),d=d.insert(u,h),a.xa[a.currentUser.toKey()]=d}(r,i.batchId,t),yield Oo(r,i.changes),yield No(r.remoteStore)}catch(i){let s=zg(i,"Failed to persist write");t.reject(s)}})}function lg(n,e,t){let r=te(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.ba.forEach((s,a)=>{let u=a.view.j_(e);u.snapshot&&i.push(u.snapshot)}),function(a,u){let h=te(a);h.onlineState=u;let d=!1;h.queries.forEach((p,E)=>{for(let b of E.U_)b.j_(u)&&(d=!0)}),d&&dA(h)}(r.eventManager,e),i.length&&r.Sa.h_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function pA(n,e){return y(this,null,function*(){let t=te(n),r=e.batch.batchId;try{let i=yield tA(t.localStore,e);Wg(t,r,null),Gg(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Oo(t,i)}catch(i){yield pg(i)}})}function gA(n,e,t){return y(this,null,function*(){let r=te(n);try{let i=yield function(a,u){let h=te(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return h.mutationQueue.lookupMutationBatch(d,u).next(E=>(ye(E!==null),p=E.keys(),h.mutationQueue.removeMutationBatch(d,E))).next(()=>h.mutationQueue.performConsistencyCheck(d)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(d,p,u)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>h.localDocuments.getDocuments(d,p))})}(r.localStore,e);Wg(r,e,t),Gg(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Oo(r,i)}catch(i){yield pg(i)}})}function Gg(n,e){(n.Oa.get(e)||[]).forEach(t=>{t.resolve()}),n.Oa.delete(e)}function Wg(n,e,t){let r=te(n),i=r.xa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.xa[r.currentUser.toKey()]=i}}function Oo(n,e,t){return y(this,null,function*(){let r=te(n),i=[],s=[],a=[];r.ba.isEmpty()||(r.ba.forEach((u,h)=>{a.push(r.Ba(h,e,t).then(d=>{if((d||t)&&r.isPrimaryClient){let p=d&&!d.fromCache;r.sharedClientState.updateQueryState(h.targetId,p?"current":"not-current")}if(d){i.push(d);let p=El.Ki(h.targetId,d);s.push(p)}}))}),yield Promise.all(a),r.Sa.h_(i),yield function(h,d){return y(this,null,function*(){let p=te(h);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",E=>P.forEach(d,b=>P.forEach(b.qi,R=>p.persistence.referenceDelegate.addReference(E,b.targetId,R)).next(()=>P.forEach(b.Qi,R=>p.persistence.referenceDelegate.removeReference(E,b.targetId,R)))))}catch(E){if(!Po(E))throw E;O("LocalStore","Failed to update sequence numbers: "+E)}for(let E of d){let b=E.targetId;if(!E.fromCache){let R=p.ns.get(b),k=R.snapshotVersion,x=R.withLastLimboFreeSnapshotVersion(k);p.ns=p.ns.insert(b,x)}}})}(r.localStore,s))})}function mA(n,e){return y(this,null,function*(){let t=te(n);if(!t.currentUser.isEqual(e)){O("SyncEngine","User change. New user:",e.toKey());let r=yield Fg(t.localStore,e);t.currentUser=e,function(s,a){s.Oa.forEach(u=>{u.forEach(h=>{h.reject(new V(C.CANCELLED,a))})}),s.Oa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Oo(t,r.us)}})}function _A(n){let e=te(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=pA.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=gA.bind(null,e),e}var wo=class{constructor(){this.synchronizeTabs=!1}initialize(e){return y(this,null,function*(){this.serializer=Do(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return eA(this.persistence,new Al,e.initialUser,this.serializer)}createPersistence(e){return new vl(wl.Hr,this.serializer)}createSharedClientState(e){return new Sl}terminate(){return y(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Ul=class{initialize(e,t){return y(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>lg(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=mA.bind(null,this.syncEngine),yield hA(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new Ll}()}createDatastore(e){let t=Do(e.databaseInfo.databaseId),r=function(s){return new Pl(s)}(e.databaseInfo);return function(s,a,u,h){return new Nl(s,a,u,h)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,a,u){return new xl(r,i,s,a,u)}(this.localStore,this.datastore,e.asyncQueue,t=>lg(this.syncEngine,t,0),function(){return vo.D()?new vo:new Rl}())}createSyncEngine(e,t){return function(i,s,a,u,h,d,p){let E=new Vl(i,s,a,u,h,d);return p&&(E.La=!0),E}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return y(this,null,function*(){var e;yield function(r){return y(this,null,function*(){let i=te(r);O("RemoteStore","RemoteStore shutting down."),i.M_.add(5),yield Li(i),i.O_.shutdown(),i.N_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};var Fl=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=ge.UNAUTHENTICATED,this.clientId=uo.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>y(this,null,function*(){O("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(O("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new V(C.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Rt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=zg(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Ru(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),O("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>y(this,null,function*(){r.isEqual(i)||(yield Fg(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function hg(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield vA(n);O("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>ag(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>ag(e.remoteStore,i)),n._onlineComponents=e})}function yA(n){return n.name==="FirebaseError"?n.code===C.FAILED_PRECONDITION||n.code===C.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function vA(n){return y(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){O("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Ru(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!yA(t))throw t;ao("Error using user provided cache. Falling back to memory cache: "+t),yield Ru(n,new wo)}}else O("FirestoreClient","Using default OfflineComponentProvider"),yield Ru(n,new wo);return n._offlineComponents})}function IA(n){return y(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(O("FirestoreClient","Using user provided OnlineComponentProvider"),yield hg(n,n._uninitializedComponentsProvider._online)):(O("FirestoreClient","Using default OnlineComponentProvider"),yield hg(n,new Ul))),n._onlineComponents})}function wA(n){return IA(n).then(e=>e.syncEngine)}function Hg(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var dg=new Map;function EA(n,e,t){if(!t)throw new V(C.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function TA(n,e,t,r){if(e===!0&&r===!0)throw new V(C.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function fg(n){if(!$.isDocumentKey(n))throw new V(C.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Zl(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":W()}function Bl(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new V(C.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Zl(n);throw new V(C.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var Eo=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new V(C.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new V(C.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}TA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Hg((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new V(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new V(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new V(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Oi=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Eo({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new V(C.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new V(C.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Eo(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Cu;switch(r.type){case"firstParty":return new Nu(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new V(C.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=dg.get(t);r&&(O("ComponentProvider","Removing Datastore"),dg.delete(t),r.terminate())}(this),Promise.resolve()}};function Kg(n,e,t,r={}){var i;let s=(n=Bl(n,Oi))._getSettings(),a=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&ao("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let u,h;if(typeof r.mockUserToken=="string")u=r.mockUserToken,h=ge.MOCK_USER;else{u=Ps(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new V(C.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new ge(d)}n._authCredentials=new Pu(new co(u,h))}}var ql=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Ct=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},xi=class n extends ql{constructor(e,t,r){super(e,t,AT(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ct(this.firestore,null,new $(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Qg(n,e,...t){if(n=Ee(n),arguments.length===1&&(e=uo.newId()),EA("doc","path",e),n instanceof Oi){let r=me.fromString(e,...t);return fg(r),new Ct(n,null,new $(r))}{if(!(n instanceof Ct||n instanceof xi))throw new V(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(me.fromString(e,...t));return fg(r),new Ct(n.firestore,n instanceof xi?n.converter:null,new $(r))}}var $l=class{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new Io(this,"async_queue_retry"),this.hu=()=>{let t=Su();t&&O("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Yo.Wo()};let e=Su();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;let t=Su();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});let t=new Rt;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){return y(this,null,function*(){if(this.su.length!==0){try{yield this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!Po(e))throw e;O("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}})}Iu(e){let t=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;let i=function(a){let u=a.message||"";return a.stack&&(u=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),u}(r);throw Pn("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.uu=!1,r))));return this.iu=t,t}enqueueAfterDelay(e,t,r){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);let i=Ml.createAndSchedule(this,e,t,r,s=>this.Eu(s));return this._u.push(i),i}Pu(){this.au&&W()}verifyOperationInProgress(){}du(){return y(this,null,function*(){let e;do e=this.iu,yield e;while(e!==this.iu)})}Au(e){for(let t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this._u)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){let t=this._u.indexOf(e);this._u.splice(t,1)}};var To=class extends Oi{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new $l}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||Yg(this),this._firestoreClient.terminate()}};function Jg(n,e){let t=typeof n=="object"?n:jt(),r=typeof n=="string"?n:e||"(default)",i=mn(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=Cs("firestore");s&&Kg(i,...s)}return i}function AA(n){return n._firestoreClient||Yg(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function Yg(n){var e,t,r;let i=n._freezeSettings(),s=function(u,h,d,p){return new Uu(u,h,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,Hg(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new Fl(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}var Ao=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Jt.fromBase64String(e))}catch(t){throw new V(C.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Jt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var bo=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new V(C.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ze(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var So=class{constructor(e){this._methodName=e}};var Ro=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new V(C.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new V(C.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return X(this._lat,e._lat)||X(this._long,e._long)}};var bA=/^__.*__$/,jl=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Pt(e,this.data,this.fieldMask,t,this.fieldTransforms):new On(e,this.data,t,this.fieldTransforms)}};function Xg(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw W()}}var zl=class n{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.wu(e),i}Su(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.mu(),i}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return Co(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(Xg(this.fu)&&bA.test(e))throw this.Du('Document fields cannot begin and end with "__"')}},Gl=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Do(e)}Fu(e,t,r,i=!1){return new zl({fu:e,methodName:t,vu:r,path:ze.emptyPath(),yu:!1,Cu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function SA(n){let e=n._freezeSettings(),t=Do(n._databaseId);return new Gl(n._databaseId,!!e.ignoreUndefinedProperties,t)}function RA(n,e,t,r,i,s={}){let a=n.Fu(s.merge||s.mergeFields?2:0,e,t,i);nm("Data must be an object, but it was:",a,r);let u=em(r,a),h,d;if(s.merge)h=new ht(a.fieldMask),d=a.fieldTransforms;else if(s.mergeFields){let p=[];for(let E of s.mergeFields){let b=CA(e,E,t);if(!a.contains(b))throw new V(C.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);kA(p,b)||p.push(b)}h=new ht(p),d=a.fieldTransforms.filter(E=>h.covers(E.field))}else h=null,d=a.fieldTransforms;return new jl(new lt(u),h,d)}function Zg(n,e){if(tm(n=Ee(n)))return nm("Unsupported field value:",e,n),em(n,e);if(n instanceof So)return function(r,i){if(!Xg(i.fu))throw i.Du(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Du(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(r,i){let s=[],a=0;for(let u of r){let h=Zg(u,i.bu(a));h==null&&(h={nullValue:"NULL_VALUE"}),s.push(h),a++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=Ee(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return xT(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=De.fromDate(r);return{timestampValue:il(i.serializer,s)}}if(r instanceof De){let s=new De(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:il(i.serializer,s)}}if(r instanceof Ro)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ao)return{bytesValue:$T(i.serializer,r._byteString)};if(r instanceof Ct){let s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Du(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Vg(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Du(`Unsupported field value: ${Zl(r)}`)}(n,e)}function em(n,e){let t={};return gg(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Mi(n,(r,i)=>{let s=Zg(i,e.pu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function tm(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof De||n instanceof Ro||n instanceof Ao||n instanceof Ct||n instanceof So)}function nm(n,e,t){if(!tm(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Zl(t);throw r==="an object"?e.Du(n+" a custom object"):e.Du(n+" "+r)}}function CA(n,e,t){if((e=Ee(e))instanceof bo)return e._internalPath;if(typeof e=="string")return DA(n,e);throw Co("Field path arguments must be of type string or ",n,!1,void 0,t)}var PA=new RegExp("[~\\*/\\[\\]]");function DA(n,e,t){if(e.search(PA)>=0)throw Co(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new bo(...e.split("."))._internalPath}catch{throw Co(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Co(n,e,t,r,i){let s=r&&!r.isEmpty(),a=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(s||a)&&(h+=" (found",s&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new V(C.INVALID_ARGUMENT,u+n+h)}function kA(n,e){return n.some(t=>t.isEqual(e))}function NA(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}function rm(n,e,t){n=Bl(n,Ct);let r=Bl(n.firestore,To),i=NA(n.converter,e,t);return OA(r,[RA(SA(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Rn.none())])}function OA(n,e){return function(r,i){let s=new Rt;return r.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return fA(yield wA(r),i,s)})),s.promise}(AA(n),e)}(function(e,t=!0){(function(i){Ir=i})(ot),st(new Fe("firestore",(r,{instanceIdentifier:i,options:s})=>{let a=r.getProvider("app").getImmediate(),u=new To(new Du(r.getProvider("auth-internal")),new xu(r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new V(C.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Fu(d.options.projectId,p)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),ne(Qp,"4.6.3",e),ne(Qp,"4.6.3","esm2017")})();var Ui=class{constructor(e){return e}},im="firestore",eh=class{constructor(){return yn(im)}};var th=new Ie("angularfire2.firestore-instances");function xA(n,e){let t=er(im,n,e);return t&&new Ui(t)}function MA(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Ui(r)}}var LA={provide:eh,deps:[[new pe,th]]},VA={provide:Ui,useFactory:xA,deps:[[new pe,th],Xe]},UA=(()=>{class n{constructor(){ne("angularfire",wt.full,"fst")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=vt({type:n});static \u0275inj=yt({providers:[VA,LA]})}return n})();function pP(n,...e){return{ngModule:UA,providers:[{provide:th,useFactory:MA(n),multi:!0,deps:[Ue,tt,Gt,Et,[new pe,An],[new pe,zt],...e]}]}}var sm=Be(Qg,!0);var om=Be(Jg,!0);var am=Be(rm,!0);var pm="firebasestorage.googleapis.com",gm="storageBucket",FA=2*60*1e3,BA=10*60*1e3;var ue=class n extends Le{constructor(e,t,r=0){super(nh(e),`Firebase Storage: ${t} (${nh(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return nh(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},de=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(de||{});function nh(n){return"storage/"+n}function uh(){let n="An unknown error occurred, please check the error payload for server response.";return new ue(de.UNKNOWN,n)}function qA(n){return new ue(de.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function $A(){let n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ue(de.UNAUTHENTICATED,n)}function jA(){return new ue(de.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function zA(n){return new ue(de.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function GA(){return new ue(de.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function WA(){return new ue(de.CANCELED,"User canceled the upload/download.")}function HA(n){return new ue(de.INVALID_URL,"Invalid URL '"+n+"'.")}function KA(n){return new ue(de.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function QA(){return new ue(de.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+gm+"' property when initializing the app?")}function JA(){return new ue(de.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function YA(n){return new ue(de.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function rh(n){return new ue(de.INVALID_ARGUMENT,n)}function mm(){return new ue(de.APP_DELETED,"The Firebase app was deleted.")}function XA(n){return new ue(de.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Bi(n,e){return new ue(de.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Fi(n){throw new ue(de.INTERNAL_ERROR,"Internal error: "+n)}var Ze=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(r.path==="")return r;throw KA(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(H){H.path.charAt(H.path.length-1)==="/"&&(H.path_=H.path_.slice(0,-1))}let a="(/(.*))?$",u=new RegExp("^gs://"+i+a,"i"),h={bucket:1,path:3};function d(H){H.path_=decodeURIComponent(H.path)}let p="v[A-Za-z0-9_]+",E=t.replace(/[.]/g,"\\."),b="(/([^?#]*).*)?$",R=new RegExp(`^https?://${E}/${p}/b/${i}/o${b}`,"i"),k={bucket:1,path:3},x=t===pm?"(?:storage.googleapis.com|storage.cloud.google.com)":t,N="([^?#]*)",q=new RegExp(`^https?://${x}/${i}/${N}`,"i"),z=[{regex:u,indices:h,postModify:s},{regex:R,indices:k,postModify:d},{regex:q,indices:{bucket:1,path:2},postModify:d}];for(let H=0;H<z.length;H++){let ke=z[H],re=ke.regex.exec(e);if(re){let I=re[ke.indices.bucket],g=re[ke.indices.path];g||(g=""),r=new n(I,g),ke.postModify(r);break}}if(r==null)throw HA(e);return r}},ih=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function ZA(n,e,t){let r=1,i=null,s=null,a=!1,u=0;function h(){return u===2}let d=!1;function p(...N){d||(d=!0,e.apply(null,N))}function E(N){i=setTimeout(()=>{i=null,n(R,h())},N)}function b(){s&&clearTimeout(s)}function R(N,...q){if(d){b();return}if(N){b(),p.call(null,N,...q);return}if(h()||a){b(),p.call(null,N,...q);return}r<64&&(r*=2);let z;u===1?(u=2,z=0):z=(r+Math.random())*1e3,E(z)}let k=!1;function x(N){k||(k=!0,b(),!d&&(i!==null?(N||(u=2),clearTimeout(i),E(0)):N||(u=1)))}return E(0),s=setTimeout(()=>{a=!0,x(!0)},t),x}function eb(n){n(!1)}function tb(n){return n!==void 0}function nb(n){return typeof n=="object"&&!Array.isArray(n)}function _m(n){return typeof n=="string"||n instanceof String}function cm(n){return lh()&&n instanceof Blob}function lh(){return typeof Blob<"u"}function um(n,e,t,r){if(r<e)throw rh(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw rh(`Invalid value for '${n}'. Expected ${t} or less.`)}function rb(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function ib(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var Er=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(Er||{});function sb(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}var sh=class{constructor(e,t,r,i,s,a,u,h,d,p,E,b=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=u,this.errorCallback_=h,this.timeout_=d,this.progressCallback_=p,this.connectionFactory_=E,this.retry=b,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((R,k)=>{this.resolve_=R,this.reject_=k,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new wr(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let a=u=>{let h=u.loaded,d=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(h,d)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;let u=s.getErrorCode()===Er.NO_ERROR,h=s.getStatus();if(!u||sb(h,this.additionalRetryCodes_)&&this.retry){let p=s.getErrorCode()===Er.ABORT;r(!1,new wr(!1,null,p));return}let d=this.successCodes_.indexOf(h)!==-1;r(!0,new wr(d,s))})},t=(r,i)=>{let s=this.resolve_,a=this.reject_,u=i.connection;if(i.wasSuccessCode)try{let h=this.callback_(u,u.getResponse());tb(h)?s(h):s()}catch(h){a(h)}else if(u!==null){let h=uh();h.serverResponse=u.getErrorText(),this.errorCallback_?a(this.errorCallback_(u,h)):a(h)}else if(i.canceled){let h=this.appDelete_?mm():WA();a(h)}else{let h=GA();a(h)}};this.canceled_?t(!1,new wr(!1,null,!0)):this.backoffId_=ZA(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&eb(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},wr=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function ob(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function ab(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function cb(n,e){e&&(n["X-Firebase-GMPID"]=e)}function ub(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function lb(n,e,t,r,i,s,a=!0){let u=ib(n.urlParams),h=n.url+u,d=Object.assign({},n.headers);return cb(d,e),ob(d,t),ab(d,s),ub(d,r),new sh(h,n.method,d,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,a)}function hb(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function db(...n){let e=hb();if(e!==void 0){let t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(lh())return new Blob(n);throw new ue(de.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function fb(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function pb(n){if(typeof atob>"u")throw YA("base-64");return atob(n)}var pt={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},qi=class{constructor(e,t){this.data=e,this.contentType=t||null}};function gb(n,e){switch(n){case pt.RAW:return new qi(ym(e));case pt.BASE64:case pt.BASE64URL:return new qi(vm(n,e));case pt.DATA_URL:return new qi(_b(e),yb(e))}throw uh()}function ym(n){let e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{let s=r,a=n.charCodeAt(++t);r=65536|(s&1023)<<10|a&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function mb(n){let e;try{e=decodeURIComponent(n)}catch{throw Bi(pt.DATA_URL,"Malformed data URL.")}return ym(e)}function vm(n,e){switch(n){case pt.BASE64:{let i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw Bi(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case pt.BASE64URL:{let i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw Bi(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=pb(e)}catch(i){throw i.message.includes("polyfill")?i:Bi(n,"Invalid character found")}let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}var Mo=class{constructor(e){this.base64=!1,this.contentType=null;let t=e.match(/^data:([^,]+)?,/);if(t===null)throw Bi(pt.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=t[1]||null;r!=null&&(this.base64=vb(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}};function _b(n){let e=new Mo(n);return e.base64?vm(pt.BASE64,e.rest):mb(e.rest)}function yb(n){return new Mo(n).contentType}function vb(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}var Lo=class n{constructor(e,t){let r=0,i="";cm(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(cm(this.data_)){let r=this.data_,i=fb(r,e,t);return i===null?null:new n(i)}else{let r=new Uint8Array(this.data_.buffer,e,t-e);return new n(r,!0)}}static getBlob(...e){if(lh()){let t=e.map(r=>r instanceof n?r.data_:r);return new n(db.apply(null,t))}else{let t=e.map(a=>_m(a)?gb(pt.RAW,a).data:a.data_),r=0;t.forEach(a=>{r+=a.byteLength});let i=new Uint8Array(r),s=0;return t.forEach(a=>{for(let u=0;u<a.length;u++)i[s++]=a[u]}),new n(i,!0)}}uploadData(){return this.data_}};function Ib(n){let e;try{e=JSON.parse(n)}catch{return null}return nb(e)?e:null}function wb(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function Eb(n,e){let t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function Im(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function Tb(n,e){return e}var Te=class{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||Tb}},xo=null;function Ab(n){return!_m(n)||n.length<2?n:Im(n)}function bb(){if(xo)return xo;let n=[];n.push(new Te("bucket")),n.push(new Te("generation")),n.push(new Te("metageneration")),n.push(new Te("name","fullPath",!0));function e(s,a){return Ab(a)}let t=new Te("name");t.xform=e,n.push(t);function r(s,a){return a!==void 0?Number(a):a}let i=new Te("size");return i.xform=r,n.push(i),n.push(new Te("timeCreated")),n.push(new Te("updated")),n.push(new Te("md5Hash",null,!0)),n.push(new Te("cacheControl",null,!0)),n.push(new Te("contentDisposition",null,!0)),n.push(new Te("contentEncoding",null,!0)),n.push(new Te("contentLanguage",null,!0)),n.push(new Te("contentType",null,!0)),n.push(new Te("metadata","customMetadata",!0)),xo=n,xo}function Sb(n,e){function t(){let r=n.bucket,i=n.fullPath,s=new Ze(r,i);return e._makeStorageReference(s)}Object.defineProperty(n,"ref",{get:t})}function Rb(n,e,t){let r={};r.type="file";let i=t.length;for(let s=0;s<i;s++){let a=t[s];r[a.local]=a.xform(r,e[a.server])}return Sb(r,n),r}function Cb(n,e,t){let r=Ib(e);return r===null?null:Rb(n,r,t)}function Pb(n,e){let t={},r=e.length;for(let i=0;i<r;i++){let s=e[i];s.writable&&(t[s.server]=n[s.local])}return JSON.stringify(t)}var oh=class{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function Db(n){if(!n)throw uh()}function kb(n,e){function t(r,i){let s=Cb(n,i,e);return Db(s!==null),s}return t}function Nb(n){function e(t,r){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=jA():i=$A():t.getStatus()===402?i=qA(n.bucket):t.getStatus()===403?i=zA(n.path):i=r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}return e}function Ob(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function xb(n,e,t){let r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=Ob(null,e)),r}function Mb(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function u(){let z="";for(let H=0;H<2;H++)z=z+Math.random().toString().slice(2);return z}let h=u();a["Content-Type"]="multipart/related; boundary="+h;let d=xb(e,r,i),p=Pb(d,t),E="--"+h+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+p+`\r
--`+h+`\r
Content-Type: `+d.contentType+`\r
\r
`,b=`\r
--`+h+"--",R=Lo.getBlob(E,r,b);if(R===null)throw JA();let k={name:d.fullPath},x=rb(s,n.host,n._protocol),N="POST",q=n.maxUploadRetryTime,j=new oh(x,N,kb(n,t),q);return j.urlParams=k,j.headers=a,j.body=R.uploadData(),j.errorHandler=Nb(e),j}var IP=256*1024;var lm=null,ah=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Er.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Er.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Er.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw Fi("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(let s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Fi("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Fi("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Fi("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Fi("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},ch=class extends ah{initXhr(){this.xhr_.responseType="text"}};function Lb(){return lm?lm():new ch}var Tr=class n{constructor(e,t){this._service=e,t instanceof Ze?this._location=t:this._location=Ze.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new Ze(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Im(this._location.path)}get storage(){return this._service}get parent(){let e=wb(this._location.path);if(e===null)return null;let t=new Ze(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw XA(e)}};function Vb(n,e,t){n._throwIfRoot("uploadBytes");let r=Mb(n.storage,n._location,bb(),new Lo(e,!0),t);return n.storage.makeRequestWithTokens(r,Lb).then(i=>({metadata:i,ref:n}))}function Ub(n,e){let t=Eb(n._location.path,e),r=new Ze(n._location.bucket,t);return new Tr(n.storage,r)}function Fb(n){return/^[A-Za-z]+:\/\//.test(n)}function Bb(n,e){return new Tr(n,e)}function wm(n,e){if(n instanceof $i){let t=n;if(t._bucket==null)throw QA();let r=new Tr(t,t._bucket);return e!=null?wm(r,e):r}else return e!==void 0?Ub(n,e):n}function qb(n,e){if(e&&Fb(e)){if(n instanceof $i)return Bb(n,e);throw rh("To use ref(service, url), the first argument must be a Storage instance.")}else return wm(n,e)}function hm(n,e){let t=e?.[gm];return t==null?null:Ze.makeFromBucketSpec(t,n)}function $b(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";let{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:Ps(i,n.app.options.projectId))}var $i=class{constructor(e,t,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=pm,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=FA,this._maxUploadRetryTime=BA,this._requests=new Set,i!=null?this._bucket=Ze.makeFromBucketSpec(i,this._host):this._bucket=hm(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ze.makeFromBucketSpec(this._url,e):this._bucket=hm(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){um("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){um("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return y(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return y(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Tr(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new ih(mm());{let a=lb(e,this._appId,r,i,t,this._firebaseVersion,s);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}makeRequestWithTokens(e,t){return y(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()})}},dm="@firebase/storage",fm="0.12.5";var Em="storage";function Tm(n,e,t){return n=Ee(n),Vb(n,e,t)}function Am(n,e){return n=Ee(n),qb(n,e)}function bm(n=jt(),e){n=Ee(n);let r=mn(n,Em).getImmediate({identifier:e}),i=Cs("storage");return i&&Sm(r,...i),r}function Sm(n,e,t,r={}){$b(n,e,t,r)}function jb(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new $i(t,r,i,e,ot)}function zb(){st(new Fe(Em,jb,"PUBLIC").setMultipleInstances(!0)),ne(dm,fm,""),ne(dm,fm,"esm2017")}zb();var xn=class{constructor(e){return e}},Rm="storage",hh=class{constructor(){return yn(Rm)}};var dh=new Ie("angularfire2.storage-instances");function Gb(n,e){let t=er(Rm,n,e);return t&&new xn(t)}function Wb(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new xn(r)}}var Hb={provide:hh,deps:[[new pe,dh]]},Kb={provide:xn,useFactory:Gb,deps:[[new pe,dh],Xe]},Qb=(()=>{class n{constructor(){ne("angularfire",wt.full,"gcs")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=vt({type:n});static \u0275inj=yt({providers:[Kb,Hb]})}return n})();function jP(n,...e){return{ngModule:Qb,providers:[{provide:dh,useFactory:Wb(n),multi:!0,deps:[Ue,tt,Gt,Et,[new pe,An],[new pe,zt],...e]}]}}var zP=Be(bm,!0);var Cm=Be(Am,!0);var Pm=Be(Tm,!0);var XP=(()=>{let e=class e{constructor(r){this.storage=r,this.auth=U(Tn),this.utilsSvc=U(Af)}getAuth(){return wi()}sigIn(r){return Gp(wi(),r.email,r.password)}signUp(r){return zp(wi(),r.email,r.password)}signOut(){wi().signOut(),localStorage.removeItem("use"),this.utilsSvc.routerLink("/auth")}setDocument(r,i){return am(sm(om(),r),i)}uploadImage(r,i,s){let a=Cm(this.storage,`${r}/${s}`);Pm(a,i).then(u=>console.log(u)).catch(u=>console.log(u))}};e.\u0275fac=function(i){return new(i||e)(Vt(xn))},e.\u0275prov=oe({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();export{V_ as a,bs as b,qS as c,NR as d,OR as e,S0 as f,wi as g,Af as h,pP as i,om as j,jP as k,zP as l,XP as m};
