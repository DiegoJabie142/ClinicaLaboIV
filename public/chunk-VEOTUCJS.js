import{z as k}from"./chunk-JAPQ2JVT.js";import{C as O,x as D}from"./chunk-LWEM5HZJ.js";import{Ab as d,Db as C,Jb as p,Kb as S,Lb as f,Sb as I,Ta as y,Va as a,g as m,ia as E,jb as g,lb as c,ma as w,oc as P,pc as T,qb as s,rb as l,sb as b,va as h,vb as x,wa as _,yb as v}from"./chunk-JWOBJSOL.js";function M(e,o){e&1&&(s(0,"h1",7),p(1,` Seleccione el paciente para su turno:
`),l())}function F(e,o){if(e&1){let i=x();s(0,"div",10),v("click",function(){let n=h(i).$implicit,t=d(2);return _(t.selectPaciente(n))}),b(1,"img",11),s(2,"span"),p(3),l()()}if(e&2){let i=o.$implicit;a(),C("alt","Imagen de ",i.name,""),c("src",i.profilePic,y),a(2),S(i.name)}}function V(e,o){if(e&1&&(s(0,"div",8),g(1,F,4,4,"div",9),l()),e&2){let i=d();a(),c("ngForOf",i.pacientes)}}function j(e,o){if(e&1&&(s(0,"h3",7),p(1),l()),e&2){let i=d();a(),f("Paciente seleccionado: ",i.selectedPaciente.name,"")}}function $(e,o){e&1&&(s(0,"h1",7),p(1,` Seleccione el especialista para su turno:
`),l())}function z(e,o){if(e&1){let i=x();s(0,"div",10),v("click",function(){let n=h(i).$implicit,t=d(2);return _(t.selectEspecialista(n))}),b(1,"img",11),s(2,"span"),p(3),l()()}if(e&2){let i=o.$implicit;a(),C("alt","Imagen de ",i.name,""),c("src",i.profilePic,y),a(2),S(i.name)}}function L(e,o){if(e&1&&(s(0,"div",8),g(1,z,4,4,"div",9),l()),e&2){let i=d();a(),c("ngForOf",i.especialistas)}}function U(e,o){if(e&1){let i=x();s(0,"div",14),v("click",function(){let n=h(i).$implicit,t=d(2);return _(t.selectEspecialidad(n))}),b(1,"img",15),s(2,"span"),p(3),l()()}if(e&2){let i=o.$implicit;a(),C("alt","Imagen de ",i.nombre,""),c("src",i.image||"https://www.rosario3.com/__export/1681168641925/sites/rosario3/img/2023/04/10/clinico.jpg",y),a(2),S(i.nombre)}}function N(e,o){if(e&1&&(s(0,"div")(1,"h3",7),p(2),l(),s(3,"div",12),g(4,U,4,4,"div",13),l()()),e&2){let i=d();a(2),f("Especialidades de ",i.selectedEspecialista.name,""),a(2),c("ngForOf",i.especialidades)}}function H(e,o){if(e&1){let i=x();s(0,"button",20),v("click",function(){let n=h(i).$implicit,t=d(2);return _(t.selectDia(n))}),p(1),l()}if(e&2){let i=o.$implicit;a(),f(" ",i," ")}}function A(e,o){if(e&1&&(s(0,"div",16)(1,"h3",17),p(2),l(),s(3,"div",18),g(4,H,2,1,"button",19),l()()),e&2){let i=d();a(2),f("D\xEDas disponibles para ",i.selectedEspecialidad.nombre,":"),a(2),c("ngForOf",i.diasDisponibles)}}function J(e,o){e&1&&(s(0,"div")(1,"p",21),p(2,"No hay d\xEDas disponibles."),l()())}function R(e,o){if(e&1){let i=x();s(0,"button",25),v("click",function(){let n=h(i).$implicit,t=d(2);return _(t.seleccionarHorario(n))}),p(1),s(2,"span"),p(3),l()()}if(e&2){let i=o.$implicit,r=d(2);a(),f(" ",r.getFormattedTime(i.start)," "),a(2),S(r.getAmPm(i.start))}}function q(e,o){if(e&1&&(s(0,"div",22)(1,"h3",17),p(2),l(),s(3,"div",23),g(4,R,4,2,"button",24),l()()),e&2){let i=d();a(2),f("Horarios disponibles para ",i.selectedDia,":"),a(2),c("ngForOf",i.horariosPorDia[i.selectedDia])}}function B(e,o){e&1&&(s(0,"div",26)(1,"p",27),p(2,"No hay horarios disponibles para este d\xEDa."),l()())}var ee=(()=>{let o=class o{constructor(){this.title="MyClinic",this.headerLinks=[],this.especialistas=[],this.pacientes=[],this.selectedEspecialista=null,this.selectedPaciente=null,this.especialidades=[],this.selectedEspecialidad=null,this.horariosDisponibles=[],this.horariosPorDia={},this.selectedDia=null,this.firebaseSvc=E(O),this.utilSvc=E(D),this.isLoggedIn=!1,this.role=""}getFormattedTime(r){let n=parseInt(r.split(":")[0],10),t=r.split(":")[1],u=n;return n>12?u=n-12:n===0&&(u=12),`${u}:${t}`}getAmPm(r){let n=parseInt(r.split(":")[0],10);return n<12||n===0?"AM":"PM"}ngOnInit(){return m(this,null,function*(){this.isLoggedIn=yield this.estaLoggeado(),this.getEspecialistas(),this.role=this.getRoleFromLocalStorage(),this.role=="administrador"&&this.getPacientes()})}signOut(){return m(this,null,function*(){console.log("Intentando cerrar sesi\xF3n...");try{yield this.firebaseSvc.signOut(),console.log("Sesi\xF3n cerrada exitosamente"),this.isLoggedIn=!1}catch(r){console.error("Error al cerrar sesi\xF3n:",r)}})}estaLoggeado(){return m(this,null,function*(){return yield this.firebaseSvc.isUserLoggedIn()})}getEspecialistas(){return m(this,null,function*(){this.especialistas=yield this.firebaseSvc.getEspecialistas()})}getPacientes(){return m(this,null,function*(){this.pacientes=yield this.firebaseSvc.getPacientes()})}get diasDisponibles(){return Object.keys(this.horariosPorDia)}getRoleFromLocalStorage(){try{let r=localStorage.getItem("user");return r&&JSON.parse(r).role||null}catch(r){return console.error("Error al obtener el rol del usuario desde localStorage:",r),null}}getEspecialidadImage(r){return r?.image||"path/to/default-image.jpg"}selectEspecialista(r){return m(this,null,function*(){try{this.selectedEspecialista=r;let n=yield this.firebaseSvc.getSpecialties();this.especialidades=n.filter(t=>r.specialities.includes(t.nombre))}catch(n){console.error("Error al seleccionar el especialista:",n)}this.selectedEspecialidad=null})}selectPaciente(r){return m(this,null,function*(){try{this.selectedPaciente=r}catch(n){console.error("Error al seleccionar el especialista:",n)}this.selectedEspecialista=null})}selectEspecialidad(r){return m(this,null,function*(){if(this.selectedEspecialista)try{this.horariosDisponibles=yield this.firebaseSvc.getHorariosDisponibles(this.selectedEspecialista.uid),this.horariosPorDia=this.horariosDisponibles.reduce((n,t)=>{let u=t.date;return n[u]||(n[u]=[]),n[u].push(t),n},{}),this.selectedDia=null}catch(n){console.error("Error al cargar los horarios disponibles:",n)}this.selectedEspecialidad=r})}selectDia(r){this.selectedDia=r}seleccionarHorario(r){return m(this,null,function*(){try{let n=JSON.parse(localStorage.getItem("user")||"{}"),t=this.role==="administrador"?this.selectedPaciente?.uid:n?.uid;if(!t){console.error("UID del usuario no encontrado o no v\xE1lido."),this.utilSvc.showError("No se pudo obtener tu informaci\xF3n. Intenta nuevamente.");return}yield this.firebaseSvc.reservarHorario(this.selectedEspecialista.uid,r,t,this.selectedEspecialidad.nombre),this.selectedDia&&this.horariosPorDia[this.selectedDia]&&(this.horariosPorDia[this.selectedDia]=this.horariosPorDia[this.selectedDia].filter(u=>u!==r)),this.utilSvc.showSuccess("Turno reservado exitosamente. Debe esperar que el especialista acepte su cita.")}catch(n){console.error("Error al reservar el horario:",n),this.utilSvc.showError("No se pudo reservar el turno. Intenta nuevamente.")}this.selectedEspecialidad=null})}};o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=w({type:o,selectors:[["app-solicitar-turno"]],standalone:!0,features:[I],decls:11,vars:11,consts:[[3,"title"],["style","width: 100%; display: flex; align-items: center; justify-content: center; margin-top: 50px; font-weight: 600;",4,"ngIf"],["class","especialistas-container",4,"ngIf"],[4,"ngIf"],["style","padding-bottom: 50px;",4,"ngIf"],["style","padding-bottom: 100px;",4,"ngIf"],["style","font-size: 25px; margin-bottom:50px;",4,"ngIf"],[2,"width","100%","display","flex","align-items","center","justify-content","center","margin-top","50px","font-weight","600"],[1,"especialistas-container"],["class","especialista-button",3,"click",4,"ngFor","ngForOf"],[1,"especialista-button",3,"click"],[1,"especialista-img",3,"src","alt"],[1,"especialidades-container"],["class","especialidad-button",3,"click",4,"ngFor","ngForOf"],[1,"especialidad-button",3,"click"],[1,"especialidad-img",3,"src","alt"],[2,"padding-bottom","50px"],[2,"text-align","center","margin-top","20px","font-weight","600"],[1,"dias-container"],["class","dia-button",3,"click",4,"ngFor","ngForOf"],[1,"dia-button",3,"click"],[2,"text-align","center","margin-top","20px","font-weight","500","font-size","25px","margin-top","50px"],[2,"padding-bottom","100px"],[1,"horarios-container"],["class","horario-button",3,"click",4,"ngFor","ngForOf"],[1,"horario-button",3,"click"],[2,"font-size","25px","margin-bottom","50px"],[2,"text-align","center","margin-top","20px","font-weight","500","margin-top","50px","font-size","25px","padding-bottom","50px"]],template:function(n,t){n&1&&(b(0,"app-header",0),g(1,M,2,0,"h1",1)(2,V,2,1,"div",2)(3,j,2,1,"h3",1)(4,$,2,0,"h1",1)(5,L,2,1,"div",2)(6,N,5,2,"div",3)(7,A,5,2,"div",4)(8,J,3,0,"div",3)(9,q,5,2,"div",5)(10,B,3,0,"div",6)),n&2&&(c("title","MyClinic"),a(),c("ngIf",t.role=="administrador"),a(),c("ngIf",t.role=="administrador"),a(),c("ngIf",t.selectedPaciente),a(),c("ngIf",t.role!="administrador"||t.selectedPaciente),a(),c("ngIf",t.role!="administrador"||t.selectedPaciente),a(),c("ngIf",t.selectedEspecialista),a(),c("ngIf",t.diasDisponibles.length>0&&t.selectedEspecialidad),a(),c("ngIf",t.diasDisponibles.length===0&&t.selectedEspecialidad),a(),c("ngIf",t.selectedEspecialidad&&t.selectedDia&&(t.horariosPorDia==null?null:t.horariosPorDia[t.selectedDia])),a(),c("ngIf",t.selectedDia&&(!(t.horariosPorDia!=null&&t.horariosPorDia[t.selectedDia])||t.horariosPorDia[t.selectedDia].length===0)))},dependencies:[k,T,P],styles:['@charset "UTF-8";.especialistas-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap;gap:20px;margin-top:50px}.especialista-button[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin:10px;padding:15px;background-color:#f0f0f0;border-radius:8px;cursor:pointer;width:150px;text-align:center}.especialista-img[_ngcontent-%COMP%]{width:100px;height:100px;border-radius:50%;object-fit:cover;margin-bottom:10px}.especialista-button[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.especialidades-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap;gap:20px;margin-top:20px}.especialistas-container[_ngcontent-%COMP%], .especialidades-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;gap:10px}.especialidades-container[_ngcontent-%COMP%]{padding-bottom:50px}.especialista-button[_ngcontent-%COMP%], .especialidad-button[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:10px;border-radius:10px;border:1px solid #ccc;cursor:pointer;width:150px;height:150px;text-align:center}.especialista-img[_ngcontent-%COMP%], .especialidad-img[_ngcontent-%COMP%]{width:100px;height:100px;border-radius:50%;object-fit:cover;margin-bottom:10px}.dias-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin-top:20px}.dia-button[_ngcontent-%COMP%]{width:100px;height:100px;background-color:#4caf50;color:#fff;border:none;border-radius:5px;font-size:16px;font-weight:600;cursor:pointer;text-align:center}.dia-button[_ngcontent-%COMP%]:hover{background-color:#45a049}.horarios-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin-top:20px}.horario-button[_ngcontent-%COMP%]{padding:10px 20px;background-color:#2196f3;color:#fff;border:none;border-radius:20px;font-size:16px;font-weight:600;cursor:pointer}.horario-button[_ngcontent-%COMP%]:hover{background-color:#1e88e5}']});let e=o;return e})();export{ee as SolicitarTurnoComponent};
