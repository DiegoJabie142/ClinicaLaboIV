import{a as V}from"./chunk-EA54IHKH.js";import{z as T}from"./chunk-JAPQ2JVT.js";import{C as L,x as $}from"./chunk-LWEM5HZJ.js";import{Ab as u,Jb as l,Kb as h,Lb as I,Mb as S,Nb as w,Sb as k,Ta as D,Va as r,e as R,g as x,ia as v,jb as d,lb as c,ma as P,oc as F,pc as U,qb as a,rb as i,sb as C,va as O,vb as y,wa as M,yb as E}from"./chunk-JWOBJSOL.js";var f=R(V());function J(n,s){if(n&1&&(a(0,"div",5),C(1,"img",6),i()),n&2){let e=u(2);r(),c("src",e.userData==null?null:e.userData.profilePic2,D)}}function W(n,s){n&1&&(a(0,"strong"),l(1,"Obra Social: "),i())}function K(n,s){n&1&&(a(0,"strong"),l(1,"Especialidades: "),i())}function q(n,s){if(n&1){let e=y();a(0,"button",15),E("click",function(){let o=O(e).$implicit,p=u(3);return M(p.mostrarDetallesAtencion(o))}),l(1),i()}if(n&2){let e=s.$implicit,t=u(3);r(),w(" ",t.historiaClinica[e].horarioData.date," Inicio: ",t.historiaClinica[e].horarioData.start," - Fin: ",t.historiaClinica[e].horarioData.end," ")}}function G(n,s){if(n&1&&(a(0,"div",12)(1,"h2"),l(2,"Historia Cl\xEDnica"),i(),a(3,"div",13),d(4,q,2,3,"button",14),i()()),n&2){let e=u(2);r(4),c("ngForOf",e.atencionIds)}}function Q(n,s){if(n&1&&(a(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5),C(4,"img",6),i(),d(5,J,2,1,"div",7),i(),a(6,"div",8)(7,"h2",9),l(8),i(),a(9,"p")(10,"strong"),l(11,"Edad: "),i(),l(12),i(),a(13,"p")(14,"strong"),l(15,"DNI: "),i(),l(16),i(),a(17,"p")(18,"strong"),l(19,"Email: "),i(),l(20),i(),a(21,"p"),d(22,W,2,0,"strong",10),l(23),i(),a(24,"p"),d(25,K,2,0,"strong",10),l(26),i()()(),d(27,G,5,1,"div",11),i()),n&2){let e=u();r(4),c("src",e.userData==null?null:e.userData.profilePic,D),r(),c("ngIf",e.userData==null?null:e.userData.profilePic2),r(3),S("",e.userData==null?null:e.userData.name," ",e.userData==null?null:e.userData.lastName,""),r(4),h(e.userData==null?null:e.userData.age),r(4),h(e.userData==null?null:e.userData.dni),r(4),I(" ",e.userData==null?null:e.userData.email,""),r(2),c("ngIf",e.userData==null?null:e.userData.socialWork),r(),h(e.userData==null?null:e.userData.socialWork),r(2),c("ngIf",e.userData==null?null:e.userData.specialities),r(),h(e.userData==null?null:e.userData.specialities),r(),c("ngIf",e.historiaClinica)}}var ot=(()=>{let s=class s{constructor(){this.title="MyClinic",this.headerLinks=[],this.uid="",this.firebaseSvc=v(L),this.utilSvc=v($),this.isLoggedIn=!1,this.atencionIds=[],this.buttons=[],this.role=""}ngOnInit(){return x(this,null,function*(){this.isLoggedIn=yield this.estaLoggeado(),this.loadUserData(),this.role=this.getRoleFromLocalStorage(),this.getUidFromLocalStorage(),this.role=="paciente"&&this.firebaseSvc.getHistoriaClinica(this.uid).then(t=>{this.historiaClinica=t,this.buttons=this.generateButtons(this.historiaClinica),this.atencionIds=Object.keys(this.historiaClinica)}).catch(t=>{console.error("Error al obtener la historia cl\xEDnica:",t.message)})})}generateButtons(t){let o=[];for(let p in t)if(t.hasOwnProperty(p)){let _=t[p],[b,m,g,N,z]=p.split("_"),A=`${b}/${m}/${g}`,H=`${N}:00`,j=`${z}:00`,B=`${A} Inicio ${H} Fin ${j}`;o.push(B)}return o}getKeys(t){return Object.keys(t)}capitalizeFirstLetter(t){return t&&t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()}getRoleFromLocalStorage(){try{let t=localStorage.getItem("user");return t&&JSON.parse(t).role||null}catch(t){return console.error("Error al obtener el rol del usuario desde localStorage:",t),null}}getUidFromLocalStorage(){let t=JSON.parse(localStorage.getItem("user")||"{}");t&&t.uid?this.uid=t.uid:console.error("UID no encontrado en localStorage")}estaLoggeado(){return x(this,null,function*(){return yield this.firebaseSvc.isUserLoggedIn()})}loadUserData(){return x(this,null,function*(){try{this.userData=yield this.firebaseSvc.getUserData(),console.log(this.userData)}catch(t){console.error("Error al cargar datos del usuario:",t)}})}mostrarDetallesAtencion(t){return x(this,null,function*(){let o=this.historiaClinica[t];if(o){let p=o.horarioData.especialistaId;f.default.fire({title:"Cargando detalles...",didOpen:()=>{f.default.showLoading()}});try{let _=yield this.getEspecialistaNombre(p),b=`
          <strong>Rese\xF1a:</strong> ${o.horarioData.rese\u00F1a} <br><br>
          <strong>Especialidad:</strong> ${o.horarioData.especialidad} <br><br>
          <strong>Especialista:</strong> ${_} <br><br>
          <strong>Datos de la Historia Cl\xEDnica:</strong> <br>
        `,m=o.historiaClinicaData;for(let g in m)m.hasOwnProperty(g)&&(b+=`<strong>${g.charAt(0).toUpperCase()+g.slice(1)}:</strong> ${m[g]} <br>`);f.default.fire({title:"Detalles de la Atenci\xF3n",html:b,icon:"info",confirmButtonText:"Cerrar"})}catch(_){console.error("Error al obtener el nombre del especialista:",_),f.default.fire({title:"Error",text:"No se pudo cargar el nombre del especialista.",icon:"error",confirmButtonText:"Cerrar"})}}else f.default.fire({title:"Error",text:"No se encontraron los detalles de esta atenci\xF3n.",icon:"error",confirmButtonText:"Cerrar"})})}getEspecialistaNombre(t){return this.firebaseSvc.getEspecialistaNombre(t)}};s.\u0275fac=function(o){return new(o||s)},s.\u0275cmp=P({type:s,selectors:[["app-perfiles"]],standalone:!0,features:[k],decls:2,vars:2,consts:[[3,"title"],["class","profile-section",4,"ngIf"],[1,"profile-section"],[1,"profile-card"],[1,"profile-images"],[1,"profile-image"],[3,"src"],["class","profile-image",4,"ngIf"],[1,"profile-info"],[1,"mt-1"],[4,"ngIf"],["style","background-color: white; border-radius: 8px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); padding: 20px; margin: 20px;",4,"ngIf"],[2,"background-color","white","border-radius","8px","box-shadow","0 4px 8px rgba(0, 0, 0, 0.1)","padding","20px","margin","20px"],[1,"buttons-container"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(o,p){o&1&&(C(0,"app-header",0),d(1,Q,28,12,"div",1)),o&2&&(c("title","MyClinic"),r(),c("ngIf",p.userData))},dependencies:[T,U,F],styles:['@charset "UTF-8";.profile-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:20px;background-color:#4c7bb8;height:1080px}.profile-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;background-color:#fff;padding:20px;border-radius:8px;box-shadow:0 4px 8px #0000001a;width:100%;max-width:900px;margin-bottom:20px}.profile-images[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:10px;margin-bottom:15px}.profile-image[_ngcontent-%COMP%]{flex-shrink:0}.profile-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:200px;height:200px;border-radius:50%;border:3px solid #ddd;object-fit:cover}.profile-info[_ngcontent-%COMP%]{font-size:16px;line-height:1.6}.profile-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;margin-bottom:10px;font-weight:600;color:#333}.profile-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0}.profile-info[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#555}.profile-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:last-child{margin-bottom:0}h2[_ngcontent-%COMP%]{font-size:22px;margin-top:20px;font-weight:600;color:#333;border-bottom:2px solid #28a745;padding-bottom:5px;margin-bottom:20px}.profile-section[_ngcontent-%COMP%]   .profile-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .profile-section[_ngcontent-%COMP%]   .profile-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:5px 0}.profile-section[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:20px;color:#333;margin-top:15px;font-weight:700}.profile-section[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-weight:400;font-size:16px}.profile-section[_ngcontent-%COMP%]   .profile-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#555}.buttons-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;align-items:center}button[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;font-size:16px;padding:10px 20px;border:none;border-radius:5px;cursor:pointer;transition:background-color .3s ease;margin-top:20px}button[_ngcontent-%COMP%]:hover{background-color:#45a049}button[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 5px 2px #48914299}button[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}']});let n=s;return n})();export{ot as PerfilesComponent};
