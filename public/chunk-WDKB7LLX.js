import{a as R}from"./chunk-4QML42IX.js";import{a as $}from"./chunk-JUZHZSBE.js";import{d as L,h as W,m as j,n as B,o as G,q as U}from"./chunk-7YVO6NQX.js";import{Q as N}from"./chunk-YYGECID7.js";import{Eb as s,Fb as b,Hb as S,Jb as C,Kb as v,Lb as w,Nb as E,Ob as T,Pa as d,Pb as P,Rb as k,Sb as F,ba as y,db as h,fa as O,fb as p,jc as D,kb as n,kc as z,lb as r,lc as I,oc as A,pa as f,pb as _,qa as x,rc as V,sb as M,ub as g}from"./chunk-HTI5VKZI.js";import{e as J,g as u}from"./chunk-5G567QLT.js";var m=J(R());var Y=a=>({empty:a}),q=()=>({standalone:!0});function K(a,c){if(a&1){let o=_();n(0,"tr")(1,"td"),s(2),r(),n(3,"td"),s(4),r(),n(5,"td")(6,"select",11),w("ngModelChange",function(t){let i=f(o).$implicit;return v(i.duracion,t)||(i.duracion=t),x(t)}),n(7,"option",12),s(8,"15 minutos"),r(),n(9,"option",13),s(10,"30 minutos"),r(),n(11,"option",14),s(12,"45 minutos"),r(),n(13,"option",15),s(14,"60 minutos"),r()()(),n(15,"td")(16,"button",16),s(17,"Guardar "),r()()()}if(a&2){let o=c.$implicit,e=g();d(2),b(o.especialidad),d(2),b(o.duracion),d(2),C("ngModel",o.duracion),d(10),p("appCaptcha",e.onCaptchaonDuracionChange(o))("captchaTitle","Por favor, resuelve este captcha antes de continuar:")}}function Q(a,c){a&1&&(n(0,"tr")(1,"td",17),s(2,"No hay especialidades disponibles"),r()())}function X(a,c){if(a&1&&(n(0,"option",26),s(1),r()),a&2){let o=c.$implicit;p("value",o),d(),b(o)}}function Z(a,c){if(a&1&&(n(0,"option",26),s(1),r()),a&2){let o=c.$implicit;p("value",o),d(),b(o)}}function ee(a,c){if(a&1){let o=_();n(0,"li")(1,"div",28)(2,"p",29),s(3),r(),n(4,"button",30),M("click",function(){let t=f(o).index,i=g(2).$implicit,l=g();return x(l.removeHorario(i,t))}),s(5,"Eliminar"),r()()()}if(a&2){let o=c.$implicit;d(3),S("",o.startTime," - ",o.endTime,"")}}function te(a,c){if(a&1&&(n(0,"div")(1,"p",27),s(2,"Horarios:"),r(),n(3,"ul"),h(4,ee,6,2,"li",5),r()()),a&2){let o=g().$implicit,e=g();d(4),p("ngForOf",e.addedHorarios[o])}}function ie(a,c){if(a&1){let o=_();n(0,"div",18)(1,"div",19)(2,"span"),s(3),k(4,"titlecase"),r()(),n(5,"div",20)(6,"label",21),s(7,"Inicio:"),r(),n(8,"select",22),w("ngModelChange",function(t){let i=f(o).$implicit,l=g();return v(l.newHorario[i].startTime,t)||(l.newHorario[i].startTime=t),x(t)}),h(9,X,2,2,"option",23),r(),n(10,"label",24),s(11,"Fin:"),r(),n(12,"select",22),w("ngModelChange",function(t){let i=f(o).$implicit,l=g();return v(l.newHorario[i].endTime,t)||(l.newHorario[i].endTime=t),x(t)}),h(13,Z,2,2,"option",23),r(),n(14,"button",25),M("click",function(){let t=f(o).$implicit,i=g();return x(i.addHorarioForDay2(t))}),s(15,"A\xF1adir Horario"),r(),h(16,te,5,1,"div",6),r()()}if(a&2){let o=c.$implicit,e=g();d(3),b(F(4,8,o)),d(5),C("ngModel",e.newHorario[o].startTime),p("ngModelOptions",T(10,q)),d(),p("ngForOf",e.getAvailableTimeSlots(o)),d(3),C("ngModel",e.newHorario[o].endTime),p("ngModelOptions",T(11,q)),d(),p("ngForOf",e.getAvailableTimeSlots(o)),d(3),p("ngIf",e.addedHorarios[o]&&e.addedHorarios[o].length>0)}}var me=(()=>{let c=class c{getAvailableTimeSlots(e){return e==="sabado"?["08:00","09:00","10:00","11:00","12:00","13:00","14:00"]:this.availableTimeSlots}constructor(){this.horarios=[],this.uid="",this.title="MyClinic",this.headerLinks=[],this.newHorario={},this.addedHorarios={},this.availableDays=["lunes","martes","miercoles","jueves","viernes","sabado"],this.especialidadesConDuracion=[],this.captchaRequired=!1,this.availableTimeSlots=["08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00"],this.isLoggedIn=!1,this.firebaseSvc=y(N),this.availableDays.forEach(e=>{this.newHorario[e]={startTime:"",endTime:""}})}ngOnInit(){return u(this,null,function*(){this.getUidFromLocalStorage(),this.loadHorarios(),this.obtenerEspecialidades(),this.availableDays.forEach(e=>{this.newHorario[e]={startTime:"",endTime:""},this.addedHorarios[e]=[]})})}signOut(){return u(this,null,function*(){console.log("Intentando cerrar sesi\xF3n...");try{yield this.firebaseSvc.signOut(),console.log("Sesi\xF3n cerrada exitosamente"),this.isLoggedIn=!1}catch(e){console.error("Error al cerrar sesi\xF3n:",e)}})}getMonthName(e){return["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][e.getMonth()]}getUidFromLocalStorage(){let e=JSON.parse(localStorage.getItem("user")||"{}");e&&e.uid?this.uid=e.uid:console.error("UID no encontrado en localStorage")}loadHorarios(){return u(this,null,function*(){if(this.uid){let e=m.default.fire({title:"Cargando horarios...",text:"Por favor espera mientras se cargan los horarios.",icon:"info",showConfirmButton:!1,didOpen:()=>{m.default.showLoading()}});try{let t=yield this.firebaseSvc.getEspecialistaHorarios(this.uid);typeof t=="object"?this.availableDays.forEach(i=>{let l=t[i];Array.isArray(l)&&l.length>0&&(this.newHorario[i]=l.map(H=>({startTime:H.startTime||"",endTime:H.endTime||""})),this.addHorarioForDay(i))}):console.error("Estructura de horarios inesperada")}catch(t){console.error("Error al cargar los horarios",t),m.default.fire({title:"Error",text:"Hubo un problema al cargar los horarios.",icon:"error"})}finally{m.default.close()}}else console.error("No se puede cargar los horarios porque no hay UID")})}removeHorario(e,t){this.addedHorarios[e].splice(t,1)}submitHorarios(){return u(this,null,function*(){try{yield this.firebaseSvc.saveEspecialistaHorario(this.uid,this.addedHorarios),this.addedHorarios={},this.horarios=[]}catch(e){console.error("Error al guardar los horarios:",e)}yield this.loadHorarios()})}addHorarioForDay(e){Array.isArray(this.newHorario[e])&&this.newHorario[e].length>0&&(this.addedHorarios[e]||(this.addedHorarios[e]=[]),this.newHorario[e].forEach(t=>{t.startTime&&t.endTime&&this.addedHorarios[e].push({startTime:t.startTime,endTime:t.endTime})}))}addHorarioForDay2(e){if(this.newHorario[e]&&this.newHorario[e].startTime&&this.newHorario[e].endTime){if(this.isStartTimeGreaterThanEndTime(this.newHorario[e].startTime,this.newHorario[e].endTime)){m.default.fire({icon:"error",title:"\xA1Error!",text:"La hora de inicio debe ser menor que la hora de fin."});return}if(this.addedHorarios[e]||(this.addedHorarios[e]=[]),this.addedHorarios[e].some(l=>this.newHorario[e].startTime<l.endTime&&this.newHorario[e].endTime>l.startTime)){m.default.fire({icon:"error",title:"\xA1Error!",text:"El horario se solapa con otro horario existente."});return}let i=this.addedHorarios[e].slice(-1)[0];i&&i.endTime===this.newHorario[e].startTime?i.endTime=this.newHorario[e].endTime:this.addedHorarios[e].push({startTime:this.newHorario[e].startTime,endTime:this.newHorario[e].endTime}),this.newHorario[e]={startTime:"",endTime:""}}}isStartTimeGreaterThanEndTime(e,t){let i=this.timeToMinutes(e),l=this.timeToMinutes(t);return i>=l}timeToMinutes(e){let[t,i]=e.split(":").map(Number);return t*60+i}obtenerEspecialidades(){return u(this,null,function*(){this.especialidadesConDuracion=yield this.firebaseSvc.getEspecialidadesConDuracion(this.uid)})}onDuracionChange(e){return u(this,null,function*(){let t=m.default.fire({title:"Cargando...",text:"Actualizando la duraci\xF3n...",icon:"info",showConfirmButton:!1,willOpen:()=>{m.default.showLoading()}});try{yield this.firebaseSvc.actualizarDuracionEspecialidad(this.uid,e),yield this.obtenerEspecialidades(),m.default.close()}catch(i){console.error("Error al cambiar la duraci\xF3n de la especialidad:",i),m.default.update({title:"Error",text:"Hubo un problema al cambiar la duraci\xF3n de la especialidad.",icon:"error",showConfirmButton:!0})}})}onCaptchaSubmitHorario(){return()=>this.submitHorarios()}onCaptchaonDuracionChange(e){return()=>this.onDuracionChange(e)}};c.\u0275fac=function(t){return new(t||c)},c.\u0275cmp=O({type:c,selectors:[["app-mis-horarios"]],standalone:!0,features:[E],decls:24,vars:8,consts:[[1,"horarios-container"],[2,"width","100%","display","flex","justify-content","center"],[2,"font-size","30px","padding-top","20px"],[2,"width","100%","display","flex","justify-content","center","margin-bottom","30px"],[3,"ngClass"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"days-grid"],["class","day-card",4,"ngFor","ngForOf"],[1,"save-container"],[1,"save-btn",2,"font-size","16px",3,"appCaptcha","captchaTitle"],[3,"ngModelChange","ngModel"],["value","15"],["value","30"],["value","45"],["value","60"],[3,"appCaptcha","captchaTitle"],["colspan","4",1,"empty"],[1,"day-card"],[1,"day-header"],[1,"day-body"],["for","startTime"],[3,"ngModelChange","ngModel","ngModelOptions"],[3,"value",4,"ngFor","ngForOf"],["for","endTime"],[1,"add-btn",3,"click"],[3,"value"],[2,"padding-top","20px","font-size","20px"],[2,"width","100%","display","flex","justify-content","space-between","padding-top","15px"],[2,"font-size","15px"],[1,"remove-btn",2,"position","relative","top","-5px",3,"click"]],template:function(t,i){t&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),s(3,"Mis Horarios"),r()(),n(4,"div",3)(5,"table",4)(6,"thead")(7,"tr")(8,"th"),s(9,"Especialidad"),r(),n(10,"th"),s(11,"Duraci\xF3n (minutos)"),r(),n(12,"th"),s(13,"Seleccionar Duraci\xF3n"),r(),n(14,"th"),s(15,"Acci\xF3n"),r()()(),n(16,"tbody"),h(17,K,18,5,"tr",5)(18,Q,3,0,"tr",6),r()()(),n(19,"div",7),h(20,ie,17,12,"div",8),r(),n(21,"div",9)(22,"button",10),s(23," Guardar Todos "),r()()()),t&2&&(d(5),p("ngClass",P(6,Y,i.especialidadesConDuracion.length===0)),d(12),p("ngForOf",i.especialidadesConDuracion),d(),p("ngIf",i.especialidadesConDuracion.length===0),d(2),p("ngForOf",i.availableDays),d(2),p("appCaptcha",i.onCaptchaSubmitHorario())("captchaTitle","Por favor, resuelve este captcha antes de continuar:"))},dependencies:[z,I,U,B,G,j,L,W,V,D,A,$],styles:['@charset "UTF-8";body[_ngcontent-%COMP%]{font-family:Arial,sans-serif;background-color:#f9f9f9;margin:0;padding:0}.horarios-container[_ngcontent-%COMP%]{width:80%;margin:30px auto;background-color:#fff;padding:20px;border-radius:8px;box-shadow:0 4px 8px #0000001a}.section-title[_ngcontent-%COMP%]{font-size:2rem;color:#333;margin-bottom:20px;text-align:center}.days-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:20px}.day-card[_ngcontent-%COMP%]{background-color:#f4f4f4;padding:15px;border-radius:8px;box-shadow:0 2px 6px #0000001a;transition:transform .3s ease}.day-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.day-header[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;color:#2c3e50;margin-bottom:15px}.day-body[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:1rem;color:#7f8c8d;display:block;margin:10px 0 5px}select[_ngcontent-%COMP%]{width:100%;padding:8px;margin-bottom:10px;border-radius:4px;border:1px solid #ccc}.add-button[_ngcontent-%COMP%]{width:100%;padding:10px;background-color:#3498db;color:#fff;font-size:1.1rem;border:none;border-radius:4px;cursor:pointer;transition:background-color .3s ease}.add-button[_ngcontent-%COMP%]:hover{background-color:#2980b9}.added-title[_ngcontent-%COMP%]{font-size:1.1rem;margin-bottom:10px;color:#34495e}.horarios-list[_ngcontent-%COMP%]{list-style-type:none;padding:0}.horario-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;background-color:#ecf0f1;padding:10px;border-radius:4px;margin-bottom:5px;align-items:center}.remove-button[_ngcontent-%COMP%]{background-color:#e74c3c;color:#fff;padding:5px;font-size:.9rem;border:none;border-radius:4px;cursor:pointer;transition:background-color .3s ease}.remove-button[_ngcontent-%COMP%]:hover{background-color:#c0392b}.save-container[_ngcontent-%COMP%]{margin-top:20px;text-align:center}.save-button[_ngcontent-%COMP%]{padding:12px 20px;background-color:#2ecc71;color:#fff;font-size:1.2rem;border:none;border-radius:5px;cursor:pointer;transition:background-color .3s ease}.save-button[_ngcontent-%COMP%]:hover{background-color:#27ae60}button[_ngcontent-%COMP%]{font-family:Arial,sans-serif;font-size:1rem;border:none;border-radius:8px;cursor:pointer;padding:10px 20px;transition:all .3s ease;outline:none}.add-btn[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;box-shadow:0 4px 8px #3498db33}.add-btn[_ngcontent-%COMP%]:hover{background-color:#2980b9;box-shadow:0 6px 12px #3498db4d}.remove-btn[_ngcontent-%COMP%]{background-color:#e74c3c;color:#fff;box-shadow:0 4px 8px #e74c3c33}.remove-btn[_ngcontent-%COMP%]:hover{background-color:#c0392b;box-shadow:0 6px 12px #e74c3c4d}.save-btn[_ngcontent-%COMP%]{background-color:#2ecc71;color:#fff;box-shadow:0 4px 8px #2ecc7133}.save-btn[_ngcontent-%COMP%]:hover{background-color:#27ae60;box-shadow:0 6px 12px #2ecc714d}table[_ngcontent-%COMP%]{width:80%;margin:20px auto;border-collapse:separate;border-spacing:0;border-radius:10px;box-shadow:0 4px 6px #0000001a;background:#fff;overflow:hidden}th[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4caf50,#2e8b57);color:#fff;padding:15px 20px;text-align:left;font-size:16px;font-weight:600;text-transform:uppercase;border-bottom:3px solid #ddd;letter-spacing:1px}td[_ngcontent-%COMP%]{padding:15px 20px;text-align:left;font-size:16px;color:#555;border-bottom:1px solid #ddd;background-color:#fafafa;transition:background-color .3s ease}tr[_ngcontent-%COMP%]:nth-child(2n)   td[_ngcontent-%COMP%]{background-color:#f9f9f9}tr[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background-color:#f1f1f1}tr.empty[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#999;font-style:italic;text-align:center;background-color:#f4f4f4;padding:20px}table[_ngcontent-%COMP%]{border-radius:10px;overflow:hidden;border:1px solid #ddd;width:960px}table[_ngcontent-%COMP%]{box-shadow:0 4px 10px #0000001a}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{transition:all .3s ease}button[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;border:none;padding:10px 20px;border-radius:5px;cursor:pointer;font-size:14px;transition:background-color .3s ease}button[_ngcontent-%COMP%]:hover{background-color:#45a049}']});let a=c;return a})();export{me as a};
