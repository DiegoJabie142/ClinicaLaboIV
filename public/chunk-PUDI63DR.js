import{a as J}from"./chunk-4QML42IX.js";import{h as $}from"./chunk-5PP5VR5I.js";import"./chunk-7YVO6NQX.js";import{Q as z}from"./chunk-YYGECID7.js";import{Eb as o,Gb as h,Hb as k,Ib as N,Na as M,Nb as j,Pa as s,ba as w,db as v,fa as S,fb as d,kb as l,kc as H,lb as n,lc as T,mb as C,pa as I,pb as D,qa as E,rc as U,sb as F,ub as _}from"./chunk-HTI5VKZI.js";import{a as y,b as O,c as P,e as A,g as x}from"./chunk-5G567QLT.js";var m=A(J());function W(a,r){if(a&1){let e=D();l(0,"div")(1,"button",12),F("click",function(){let i=I(e).$implicit,c=_(3);return E(c.verHistoriaClinica(i))}),o(2),n()()}if(a&2){let e=r.$implicit;s(2),N(" Historia clinica del: ",e.fecha," ",e.horaInicio,"-",e.horaFin," ")}}function Y(a,r){if(a&1&&(l(0,"div",6)(1,"div",7),C(2,"img",8),l(3,"div",9)(4,"h3"),o(5),n(),l(6,"p")(7,"strong"),o(8,"Edad:"),n(),o(9),n(),l(10,"p")(11,"strong"),o(12,"DNI:"),n(),o(13),n(),l(14,"p")(15,"strong"),o(16,"Email:"),n(),o(17),n(),l(18,"p")(19,"strong"),o(20,"Obra Social:"),n(),o(21),n()()(),l(22,"div",10),v(23,W,3,3,"div",11),n()()),a&2){let e=r.$implicit,t=_(2);s(2),d("src",e.profilePic,M),s(3),k("",e.name," ",e.lastName,""),s(4),h(" ",e.age,""),s(4),h(" ",e.dni,""),s(4),h(" ",e.email,""),s(4),h(" ",e.socialWork,""),s(2),d("ngForOf",t.historiaClinica[e.uid])}}function q(a,r){if(a&1&&(l(0,"div",4),v(1,Y,24,8,"div",5),n()),a&2){let e=_();s(),d("ngForOf",e.pacientesDatos)}}function G(a,r){a&1&&(l(0,"div",13)(1,"h1"),o(2,"No tienes pacientes todav\xEDa."),n()())}var et=(()=>{let r=class r{constructor(){this.uid="",this.pacientesIds=[],this.pacientesDatos=[],this.firebaseSvc=w(z),this.historiaClinica=[]}ngOnInit(){return x(this,null,function*(){this.getUidFromLocalStorage(),this.pacientesIds=yield this.firebaseSvc.obtenerPacientesUnicos(this.uid),yield this.cargarPacientesDatos(),this.historiaClinica=yield this.cargarHistoriasClinicas(this.pacientesIds)})}cargarPacientesDatos(){return x(this,null,function*(){for(let t of this.pacientesIds){let i=yield this.firebaseSvc.getPatientData(t);this.pacientesDatos.push(i)}})}getUidFromLocalStorage(){let t=JSON.parse(localStorage.getItem("user")||"{}");t&&t.uid?this.uid=t.uid:console.error("UID no encontrado en localStorage")}cargarHistoriasClinicas(t){return x(this,null,function*(){m.default.fire({title:"Cargando historias cl\xEDnicas...",text:"Por favor, espera mientras se cargan las historias cl\xEDnicas.",allowOutsideClick:!1,didOpen:()=>{m.default.showLoading()}});let i={};for(let c of t){let p=yield this.firebaseSvc.getHistoriaClinicaConEspecialista(c,this.uid);p&&p.length>0?(p=p.map(f=>{let[g,b,u]=f.fecha.split("-"),[L,V]=f.horaInicio.split(":"),B=new Date(Number(u),Number(b)-1,Number(g),Number(L),Number(V));return O(y({},f),{fechaObj:B})}),p.sort((f,g)=>g.fechaObj.getTime()-f.fechaObj.getTime()),p=p.slice(0,3),p=p.map(b=>{var u=b,{fechaObj:f}=u,g=P(u,["fechaObj"]);return g}),i[c]=p):i[c]=[]}return m.default.close(),i})}capitalize(t){return t.charAt(0).toUpperCase()+t.slice(1)}verHistoriaClinica(t){if(!t||Object.keys(t).length===0){m.default.fire({icon:"info",title:"Historia Cl\xEDnica",text:"No hay historia cl\xEDnica disponible para este paciente.",confirmButtonColor:"#0078D4"});return}let i='<ul style="text-align: left;">';for(let c in t)t.hasOwnProperty(c)&&(i+=`<li style="margin-bottom: 15px;">
          <strong>${this.capitalize(c)}:</strong> ${t[c]}<br>
        </li>`);i+="</ul>",m.default.fire({title:"Historia Cl\xEDnica",html:i,width:"600px",confirmButtonColor:"#0078D4"})}};r.\u0275fac=function(i){return new(i||r)},r.\u0275cmp=S({type:r,selectors:[["app-pacientes"]],standalone:!0,features:[j],decls:5,vars:3,consts:[[3,"title"],[2,"width","100%","display","flex","justify-content","center","margin-top","40px"],["class","cards-container",4,"ngIf"],["style","width: 100%; display: flex; justify-content: center; margin-top: 30px;",4,"ngIf"],[1,"cards-container"],["class","patient-card",4,"ngFor","ngForOf"],[1,"patient-card"],[1,"card-header"],["alt","Foto de perfil",1,"profile-pic",3,"src"],[1,"patient-info"],[1,"card-actions"],[4,"ngFor","ngForOf"],[1,"action-button",2,"margin-bottom","15px",3,"click"],[2,"width","100%","display","flex","justify-content","center","margin-top","30px"]],template:function(i,c){i&1&&(C(0,"app-header",0),l(1,"h1",1),o(2,"Tus Pacientes"),n(),v(3,q,2,1,"div",2)(4,G,3,0,"div",3)),i&2&&(d("title","MyClinic"),s(3),d("ngIf",c.pacientesDatos.length>0),s(),d("ngIf",c.pacientesDatos.length==0))},dependencies:[$,H,T,U],styles:['@charset "UTF-8";.cards-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;gap:20px;padding:20px}.patient-card[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px;box-shadow:0 4px 8px #0000001a;overflow:hidden;transition:transform .3s ease-in-out;width:400px}.patient-card[_ngcontent-%COMP%]:hover{transform:translateY(-10px)}.card-header[_ngcontent-%COMP%]{display:flex;padding:20px;border-bottom:1px solid #f0f0f0}.profile-pic[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;object-fit:cover;margin-right:20px}.patient-info[_ngcontent-%COMP%]{flex-grow:1}.patient-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.2rem;margin:0;color:#333}.patient-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9rem;color:#555;margin:5px 0}.card-actions[_ngcontent-%COMP%]{padding:20px;text-align:center;background-color:#f9f9f9;border-top:1px solid #f0f0f0;height:100%}.action-button[_ngcontent-%COMP%]{padding:10px 20px;font-size:1rem;color:#fff;background-color:#0078d4;border:none;border-radius:5px;cursor:pointer;transition:background-color .3s}.action-button[_ngcontent-%COMP%]:hover{background-color:#005bb5}']});let a=r;return a})();export{et as PacientesComponent};
