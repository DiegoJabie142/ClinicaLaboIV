import{a as Y}from"./chunk-6QYUKPQV.js";import{a as W}from"./chunk-IKOEVS5N.js";import{a as X}from"./chunk-PR2O7PN4.js";import{d as V,e as m,f as G,g as $,i as g,k as j,m as B,n as Z,r as H,s as J,t as K,z as Q}from"./chunk-JAPQ2JVT.js";import{C as R,f as A,v as D,x as z}from"./chunk-LWEM5HZJ.js";import{Ab as f,Ca as O,Jb as p,Kb as k,Sb as q,Va as o,Wa as I,a as w,g as x,ia as y,jb as d,lb as s,ma as P,nb as M,oc as L,pb as S,pc as N,qb as a,rb as r,sb as b,tb as v,ub as C,va as U,vb as F,wa as T,yb as h}from"./chunk-JWOBJSOL.js";function ie(e,l){e&1&&b(0,"app-header",28),e&2&&s("title","Registro")("back",!0)("whereToBack","/sign-up/select")}function ne(e,l){e&1&&(a(0,"div",30),p(1,"El nombre es requerido"),r())}function oe(e,l){e&1&&(a(0,"div",30),p(1,"El nombre debe tener 5 o m\xE1s car\xE1cteres"),r())}function re(e,l){if(e&1&&(v(0,8),d(1,ne,2,0,"div",29)(2,oe,2,0,"div",29),C()),e&2){let i=f();o(),s("ngIf",i.form.controls.name.errors==null?null:i.form.controls.name.errors.required),o(),s("ngIf",!(i.form.controls.name.errors!=null&&i.form.controls.name.errors.required))}}function ae(e,l){e&1&&(a(0,"div",30),p(1,"El apellido es requerido"),r())}function le(e,l){e&1&&(a(0,"div",30),p(1,"El apellido debe tener 5 o m\xE1s car\xE1cteres"),r())}function se(e,l){if(e&1&&(v(0,8),d(1,ae,2,0,"div",29)(2,le,2,0,"div",29),C()),e&2){let i=f();o(),s("ngIf",i.form.controls.lastName.errors==null?null:i.form.controls.lastName.errors.required),o(),s("ngIf",!(i.form.controls.lastName.errors!=null&&i.form.controls.lastName.errors.required))}}function ce(e,l){e&1&&(a(0,"div",30),p(1,"El dni es requerido"),r())}function pe(e,l){e&1&&(a(0,"div",30),p(1,"El dni debe tener entre 6 y 8 car\xE1cteres"),r())}function me(e,l){if(e&1&&(v(0,8),d(1,ce,2,0,"div",29)(2,pe,2,0,"div",29),C()),e&2){let i=f();o(),s("ngIf",i.form.controls.dni.errors==null?null:i.form.controls.dni.errors.required),o(),s("ngIf",!(i.form.controls.dni.errors!=null&&i.form.controls.dni.errors.required))}}function de(e,l){e&1&&(a(0,"div",30),p(1,"La edad es requerida"),r())}function ue(e,l){e&1&&(a(0,"div",30),p(1,"La edad debe ser entre 25 y 100"),r())}function fe(e,l){if(e&1&&(v(0,8),d(1,de,2,0,"div",29)(2,ue,2,0,"div",29),C()),e&2){let i=f();o(),s("ngIf",i.form.controls.age.errors==null?null:i.form.controls.age.errors.required),o(),s("ngIf",!(i.form.controls.age.errors!=null&&i.form.controls.age.errors.required))}}function ge(e,l){e&1&&(a(0,"div",30),p(1,"El correo es requerido"),r())}function _e(e,l){e&1&&(a(0,"div",30),p(1,"Ingrese un formato correcto"),r())}function Se(e,l){if(e&1&&(v(0,8),d(1,ge,2,0,"div",29)(2,_e,2,0,"div",29),C()),e&2){let i=f();o(),s("ngIf",i.form.controls.email.errors==null?null:i.form.controls.email.errors.required),o(),s("ngIf",i.form.controls.email.errors==null?null:i.form.controls.email.errors.email)}}function be(e,l){e&1&&(a(0,"div",30),p(1,"La contrase\xF1a es requerida"),r())}function ve(e,l){e&1&&(a(0,"div",30),p(1,"Debe tener 6 car\xE1cteres o m\xE1s"),r())}function Ce(e,l){if(e&1&&(v(0,8),d(1,be,2,0,"div",29)(2,ve,2,0,"div",29),C()),e&2){let i=f();o(),s("ngIf",i.form.controls.password.errors==null?null:i.form.controls.password.errors.required),o(),s("ngIf",i.form.controls.password.errors==null?null:i.form.controls.password.errors.email)}}function he(e,l){if(e&1){let i=F();a(0,"div",31)(1,"label",32)(2,"input",33),h("change",function(){let c=U(i).$implicit,t=f();return T(t.onCheckboxChange(c.nombre))}),r(),a(3,"span",34),p(4),r()()()}if(e&2){let i=l.$implicit;o(4),k(i.nombre)}}function xe(e,l){e&1&&(a(0,"small",37),p(1,"El nombre es obligatorio"),r())}function ye(e,l){e&1&&(a(0,"small",37),p(1,"El nombre debe tener al menos 3 caracteres"),r())}function Ee(e,l){if(e&1&&(a(0,"div",35),d(1,xe,2,0,"small",36)(2,ye,2,0,"small",36),r()),e&2){let i=f();o(),s("ngIf",i.specialtyForm.controls.nombre.errors==null?null:i.specialtyForm.controls.nombre.errors.required),o(),s("ngIf",i.specialtyForm.controls.nombre.errors==null?null:i.specialtyForm.controls.nombre.errors.minlength)}}function we(e,l){e&1&&(a(0,"div",30),p(1,"La imagen es requerida"),r())}function Pe(e,l){if(e&1&&(v(0,8),d(1,we,2,0,"div",29),C()),e&2){let i=f();o(),s("ngIf",i.form.controls.profilePic.errors==null?null:i.form.controls.profilePic.errors.required)}}var $e=(()=>{let l=class l{constructor(n){this.router=n,this.header=!0,this.color="blue",this.esAdmin=!1,this.specialistUploaded=new O,this.fb=y(H),this.specialties=[],this.specialtiesDefault=[],this.form=this.fb.group({uid:new g(""),name:new g("",[m.required,m.minLength(5),m.pattern("^[a-zA-Z]+$")]),lastName:new g("",[m.required,m.minLength(5),m.pattern("^[a-zA-Z]+$")]),dni:new g("",[m.required,m.minLength(6),m.maxLength(8)]),specialities:new g([],[m.required]),email:new g("",[m.required,m.email]),password:new g("",[m.required,m.minLength(6)]),profilePic:new g(null,[m.required]),age:new g("",[m.required,m.min(25),m.max(100)])}),this.firebaseSvc=y(R),this.utilSvc=y(z),this.specialtyForm=this.fb.group({nombre:["",[m.required,m.minLength(5)]],descripcion:[""]})}ngOnInit(){return x(this,null,function*(){this.specialties=yield this.firebaseSvc.getSpecialties(),this.specialtiesDefault=yield this.firebaseSvc.getSpecialties()})}onCheckboxChange(n){let c=this.form.get("specialities")?.value??[];if(c.includes(n)){let t=c.filter(u=>u!==n);this.form.get("specialities")?.setValue(t)}else c.push(n),this.form.get("specialities")?.setValue([...c])}get formControls(){return this.form.controls}onFileSelected(n,c){n.size>2097152?(console.log("El archivo es demasiado grande. El tama\xF1o m\xE1ximo permitido es 2 MB."),this.formControls[c].setValue(null)):this.formControls[c].setValue(n)}onSubmit(){return x(this,null,function*(){if(this.form.valid){let n=this.form.value,c=n.profilePic;if(c){let t=[this.firebaseSvc.uploadImage(c,`profilePics/${n.name}_${n.dni}_1`)];Promise.all(t).then(([u])=>{if(u){let _={uid:n.uid,name:n.name,lastName:n.lastName,dni:n.dni,specialities:n.specialities,email:n.email,age:n.age,profilePic:u,activated:!1};n.email&&n.password?this.firebaseSvc.signUp(n.email,n.password).then(E=>{let ee=E.user;_.uid=ee.uid,this.firebaseSvc.saveUserDataAsSpecialist(_).then(()=>{this.syncSpecialties(),console.log("Especialista registrado con \xE9xito"),this.specialistUploaded.emit(!0),this.form.reset(),this.esAdmin==!1&&this.router.navigate(["/home"])}).catch(te=>{console.error("Error al guardar los datos del especialista: ",te)})}).catch(E=>{console.error("Error al registrar el usuario: ",E)}):console.log("Faltan email o contrase\xF1a para registrar al especialista")}else console.error("No se pudieron obtener las URLs de las im\xE1genes")}).catch(u=>{console.error("Error al subir las im\xE1genes: ",u)})}else console.log("Las im\xE1genes no se han seleccionado correctamente")}else console.log("Formulario no v\xE1lido")})}allowOnlyLetters(n){/^[a-zA-Z ]+$/.test(n.key)||n.preventDefault()}addNewSpecialty(){return x(this,null,function*(){if(this.specialtyForm.valid){let n=this.specialtyForm.value,c=n.nombre?.trim();if(!c){console.log("El nombre de la especialidad no puede estar vac\xEDo.");return}if(this.specialties.some(u=>u.nombre?.toLowerCase()===c.toLowerCase())){console.log("La especialidad ya existe en la lista.");return}this.specialties.push(w({nombre:c},n)),console.log("Especialidad a\xF1adida a la lista exitosamente"),this.specialtyForm.reset()}else console.log("Formulario no v\xE1lido")})}onFileRemoved(){this.form.get("profilePic")?.setValue(null)}syncSpecialties(){return x(this,null,function*(){try{let n=this.specialties.filter(c=>!this.specialtiesDefault.some(t=>t.nombre?.toLowerCase()===c.nombre?.toLowerCase()));if(n.length>0){console.log(`Subiendo ${n.length} nuevas especialidades...`);for(let c of n)yield this.firebaseSvc.addSpecialty(c),console.log(`Especialidad a\xF1adida: ${c.nombre}`);this.specialtiesDefault=yield this.firebaseSvc.getSpecialties(),console.log("Sincronizaci\xF3n completada.")}else console.log("No hay nuevas especialidades para subir.")}catch(n){console.error("Error durante la sincronizaci\xF3n de especialidades:",n)}})}};l.\u0275fac=function(c){return new(c||l)(I(A))},l.\u0275cmp=P({type:l,selectors:[["app-sign-up-specialist"]],inputs:{header:"header",color:"color",esAdmin:"esAdmin"},outputs:{specialistUploaded:"specialistUploaded"},standalone:!0,features:[q],decls:43,vars:24,consts:[[3,"title","back","whereToBack",4,"ngIf"],[1,"container"],[1,"d-flex-center","widht-100"],[3,"titulo","color"],[1,"d-flex-center","width-500"],[1,"auth-form",3,"ngSubmit","formGroup"],[1,"margin-input"],["label","Nombre","type","text",3,"keypress","control"],[1,"validators-container"],["label","Apellido","type","text",3,"keypress","control"],["label","DNI","type","number",3,"control"],["label","EDAD","type","number",3,"control"],["label","Correo","type","email",3,"control"],["label","Contrase\xF1a","type","password",3,"control"],[1,"specialties-container"],[1,"title"],[1,"specialties-list"],["class","specialty-item",4,"ngFor","ngForOf"],[1,"specialty-form",3,"ngSubmit","formGroup"],[1,"form-group"],["for","nombre",1,"form-label"],["id","nombre","formControlName","nombre","type","text","placeholder","Nombre de la especialidad",1,"form-input"],["class","error-messages",4,"ngIf"],["type","submit",1,"submit-btn",3,"disabled"],[1,"widht-100","d-flex-center"],["label","Selecciona tu imagen",3,"fileSelected","fileRemoved"],[1,"button-login","submit-btn-register"],["mat-flat-button","","color","warn","type","submit",3,"disabled"],[3,"title","back","whereToBack"],["class","validators",4,"ngIf"],[1,"validators"],[1,"specialty-item"],[1,"specialty-label"],["type","checkbox",1,"specialty-checkbox",3,"change"],[1,"specialty-name"],[1,"error-messages"],["class","error-text",4,"ngIf"],[1,"error-text"]],template:function(c,t){c&1&&(d(0,ie,1,3,"app-header",0),a(1,"div",1)(2,"div",2),b(3,"app-logo",3),r(),a(4,"div",4)(5,"form",5),h("ngSubmit",function(){return t.onSubmit()}),a(6,"div",6)(7,"app-custom-input",7),h("keypress",function(_){return t.allowOnlyLetters(_)}),r(),d(8,re,3,2,"ng-container",8),r(),a(9,"div",6)(10,"app-custom-input",9),h("keypress",function(_){return t.allowOnlyLetters(_)}),r(),d(11,se,3,2,"ng-container",8),r(),a(12,"div",6),b(13,"app-custom-input",10),d(14,me,3,2,"ng-container",8),r(),a(15,"div",6),b(16,"app-custom-input",11),d(17,fe,3,2,"ng-container",8),r(),a(18,"div",6),b(19,"app-custom-input",12),d(20,Se,3,2,"ng-container",8),r(),a(21,"div",6),b(22,"app-custom-input",13),d(23,Ce,3,2,"ng-container",8),r(),a(24,"div",14)(25,"div",15),p(26,"ESPECIALIDADES"),r(),a(27,"div",16),d(28,he,5,1,"div",17),r()(),a(29,"form",18),h("ngSubmit",function(){return t.addNewSpecialty()}),a(30,"div",19)(31,"label",20),p(32,"AGREGAR ESPECIALIDAD"),r(),b(33,"input",21),d(34,Ee,3,2,"div",22),r(),a(35,"button",23),p(36,"Agregar Especialidad"),r()(),a(37,"div",24)(38,"app-picture-input",25),h("fileSelected",function(_){return t.onFileSelected(_,"profilePic")})("fileRemoved",function(){return t.onFileRemoved()}),r(),d(39,Pe,2,1,"ng-container",8),r(),a(40,"div",26)(41,"button",27),p(42,"REGISTRARSE"),r()()()()()),c&2&&(s("ngIf",t.header),o(),M("body",t.header),o(2),s("titulo","Registro de Especialista")("color",t.color),o(2),s("formGroup",t.form),o(2),s("control",t.form.controls.name),o(),S(8,t.form.controls.name.errors&&t.form.controls.name.touched?8:-1),o(2),s("control",t.form.controls.lastName),o(),S(11,t.form.controls.lastName.errors&&t.form.controls.lastName.touched?11:-1),o(2),s("control",t.form.controls.dni),o(),S(14,t.form.controls.dni.errors&&t.form.controls.dni.touched?14:-1),o(2),s("control",t.form.controls.age),o(),S(17,t.form.controls.age.errors&&t.form.controls.age.touched?17:-1),o(2),s("control",t.form.controls.email),o(),S(20,t.form.controls.email.errors&&t.form.controls.email.touched?20:-1),o(2),s("control",t.form.controls.password),o(),S(23,t.form.controls.password.errors&&t.form.controls.password.touched?23:-1),o(5),s("ngForOf",t.specialties),o(),s("formGroup",t.specialtyForm),o(5),s("ngIf",t.specialtyForm.controls.nombre.invalid&&t.specialtyForm.controls.nombre.touched),o(),s("disabled",t.specialtyForm.invalid),o(4),S(39,t.form.controls.profilePic.errors&&t.form.controls.profilePic.touched?39:-1),o(2),s("disabled",t.form.invalid))},dependencies:[Q,W,D,K,j,V,G,$,B,Z,J,N,Y,L,X],styles:['@charset "UTF-8";.d-flex[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:100%;flex-wrap:wrap}.body[_ngcontent-%COMP%]{height:800px;margin-top:20px;background-position-y:-50px}body[_ngcontent-%COMP%]{position:relative;margin:0;font-family:Arial,sans-serif}.body[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:10px 0 0;background:url("./media/background-patient-HLLCCCEI.jpg");background-repeat:no-repeat;background-position-x:center;background-size:1875px;opacity:.2;z-index:-1}.d-flex-space-between[_ngcontent-%COMP%]{display:flex;align-content:space-between;justify-content:space-between}.margin-input[_ngcontent-%COMP%]{margin-top:40px}.button-login[_ngcontent-%COMP%]{padding:22px;margin-top:40px}.validators[_ngcontent-%COMP%]{font-size:15px;text-align:center;color:red}.width-500[_ngcontent-%COMP%], .auth-form[_ngcontent-%COMP%]{width:100%;display:flex;flex-wrap:wrap;justify-content:center}.margin-input[_ngcontent-%COMP%]{margin-right:40px;width:30%}.widht-100[_ngcontent-%COMP%]{width:100%}.specialty-form[_ngcontent-%COMP%]{max-width:500px;margin:0 auto;padding:20px;background-color:#f9f9f9;border-radius:8px;box-shadow:0 4px 8px #0000001a;font-family:Arial,sans-serif;font-size:18px;height:200px}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-weight:700;color:#333}.form-input[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ccc;border-radius:4px;font-size:16px;background-color:#fff;transition:border-color .3s ease;margin-top:10px}.form-input[_ngcontent-%COMP%]:focus{border-color:#4a90e2;outline:none}.error-messages[_ngcontent-%COMP%]{margin-top:8px;color:#d9534f;font-size:12px}.error-text[_ngcontent-%COMP%]{display:block}.submit-btn[_ngcontent-%COMP%]{padding:10px 20px;background-color:#4a90e2;color:#fff;border:none;border-radius:4px;font-size:15px;cursor:pointer;transition:background-color .3s ease}.submit-btn[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.submit-btn[_ngcontent-%COMP%]:hover{background-color:#357abd}.specialties-container[_ngcontent-%COMP%]{max-width:800px;margin:20px auto;padding:15px;background-color:#f9f9f9;border-radius:8px;box-shadow:0 4px 8px #0000001a;font-family:Arial,sans-serif}.title[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:#333;margin-bottom:10px}.specialties-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:15px}.specialty-item[_ngcontent-%COMP%]{flex:1 1 calc(33.333% - 10px);min-width:200px;box-sizing:border-box}.specialty-label[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:14px;color:#333;cursor:pointer;padding:5px}.specialty-checkbox[_ngcontent-%COMP%]{margin-right:10px}.specialty-name[_ngcontent-%COMP%]{font-size:14px;color:#333;white-space:nowrap}.submit-btn-register[_ngcontent-%COMP%]{cursor:not-allowed}.submit-btn-register[_ngcontent-%COMP%]:disabled{cursor:not-allowed}']});let e=l;return e})();export{$e as a};
